!function(e,t){for(var r in t)e[r]=t[r]}(this,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);const n=r(1);var o;n&&n.__esModule&&n.default&&new n.default((o=self,{onConnect(e){o.addEventListener("message",()=>e(),{once:!0})},onError(e){o.addEventListener("error",t=>{t.error?e(t.error):t.message&&e(Object.assign(new Error(t.message),{colno:t.colno,error:t.error,filename:t.filename,lineno:t.lineno,message:t.message}))})},onMessage(e){o.addEventListener("message",t=>{e(t.data)})},sendMessage(e){o.postMessage(e)},close(){"terminate"in o?o.terminate():"close"in o&&o.close()}}))},function(e,t,r){"use strict";var n,o;function a(e){return e.data.sampleRate?e.data.sampleRate:2e4}r.r(t),function(e){e.ENCODE="ENCODE",e.DECODE="DECODE",e.DESTROY_ENCODER="DESTROY_ENCODER",e.DESTROY_DECODER="DESTROY_ENCODER"}(n||(n={})),function(e){e.ENCODE="ENCODE_OUTPUT",e.DECODE="DECODE_OUTPUT"}(o||(o={})),self.LIBOPUS_WASM_URL="libopus.wasm",importScripts("libopus.wasm.js");const s={},i={};function d(e,t,r,n){t.working=!0,setTimeout((function o(){t.lastWorkTime=Date.now();let a=r(t);a?(a=a instanceof Uint8Array?Uint8Array.from(a):Float32Array.from(a),postMessage(n(a,e),[a.buffer]),setTimeout(o,0)):t.working=!1}),0)}function c(e,t){var r;null===(r=e[t])||void 0===r||r.destroy(),delete e[t]}onmessage=function(e){if(e.data.topic===n.ENCODE){const r=a(e),n=s[e.data.streamId]=s[e.data.streamId]||{working:!1,encoder:new libopus.Encoder(1,r,24e3,20,!0),lastWorkTime:Date.now(),destroy:function(){this.encoder.destroy()}},i=(t=e.data.samples,Int16Array.from(t,e=>{let t=Math.floor(32767*e);return t=Math.min(32767,t),t=Math.max(-32768,t),t}));n.encoder.input(i),n.working||d(e.data.streamId,n,e=>e.encoder.output(),(e,t)=>({topic:o.ENCODE,streamId:t,encoded:e}))}var t;if(e.data.topic===n.DECODE){const t=a(e),r=i[e.data.streamId]=i[e.data.streamId]||{working:!1,decoder:new libopus.Decoder(1,t),lastWorkTime:Date.now(),destroy:function(){this.decoder.destroy()}};r.decoder.input(e.data.encoded),r.working||d(e.data.streamId,r,e=>e.decoder.output(),(e,t)=>{return{topic:o.DECODE,streamId:t,samples:(r=e,Float32Array.from(r,e=>{let t=e>=0?e/32767:e/32768;return Math.fround(t)}))};var r})}if(e.data.topic===n.DESTROY_DECODER){const{streamId:t}=e.data;c(i,t)}if(e.data.topic===n.DESTROY_ENCODER){const{streamId:t}=e.data;c(s,t)}};setTimeout((function e(){const t=Date.now();function r(e){Object.keys(e).forEach(r=>{const n=e[r];!n.working&&t-n.lastWorkTime>6e4&&c(e,r)})}r(s),r(i),setTimeout(e,2e3)}),0)}]));