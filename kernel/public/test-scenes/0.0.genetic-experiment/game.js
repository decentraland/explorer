!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=24)}({0:function(t,e,i){"use strict";let n=0;function o(...t){"undefined"!=typeof dcl?dcl.log(...t):console.log("DEBUG:",...t)}function s(t,e){"undefined"!=typeof dcl?dcl.error(t,e):console.error("ERROR:",t,e)}function r(t){if(n++,0===t.length)throw new Error("newId(type: string): type cannot be empty");return t+n.toString(36)}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){let e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function d(t,e){const i=[];for(let n=0;n<t;++n)i.push(e());return i}const l="__event_name__",h=[];function p(t){if(!(l in t)||"string"!=typeof t[l])throw new Error("The EventConstructor is not registered");return t[l]}class c{constructor(){this.listeners={}}addListener(t,e,i){if(!t||"function"!=typeof t)throw new Error("Invalid EventConstructor");const n=p(t);let o=this.listeners[n];o||(o=this.listeners[n]=[]);for(let t=0;t<o.length;t++){if(o[t].listener===e)throw new Error("The provided listener is already registered")}return o.push({listener:e,fn:i}),this}removeListener(t,e){if(!e||"function"!=typeof e)throw new Error("Invalid EventConstructor");const i=p(e);let n=this.listeners[i];if(!n)return!1;for(let e=0;e<n.length;e++){if(n[e].listener===t)return n.splice(e,1),!0}return!1}fireEvent(t){const e=p(t.constructor);let i=this.listeners[e];if(i)for(let e=0;e<i.length;e++)try{const n=i[e];n.fn.call(n.listener,t)}catch(t){s(t)}return this}}function u(){const t=r("EV");if(-1!==h.indexOf(t))throw new Error(`The event name ${t} is already taken`);return h.push(t),e=>(e[l]=t,e)}var y=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},m=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let f=class{constructor(t,e,i){this.entity=t,this.componentName=e,this.component=i}};f=y([u(),m("design:paramtypes",[Object,String,Object])],f);let g=class{constructor(t,e,i){this.entity=t,this.componentName=e,this.classId=i}};g=y([u(),m("design:paramtypes",[Object,String,Object])],g);let w=class{constructor(t,e){this.entity=t,this.parent=e}};var b;w=y([u(),m("design:paramtypes",[Object,Object])],w),function(t){t[t.PERCENT=0]="PERCENT",t[t.PIXELS=1]="PIXELS"}(b||(b={}));class v{constructor(t){if(this.type=b.PIXELS,"string"==typeof t){let e=t;e.indexOf("px")>-1?this.type=b.PIXELS:e.indexOf("%")>-1&&(this.type=b.PERCENT),this.value=parseFloat(e)}else this.value=t}toString(){let t=this.value.toString();return this.type===b.PERCENT?t+="%":t+="px",t}}var x=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},R=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const T="__name__symbol_",C="__classId__symbol_",E="__component__id_";let A=class{constructor(t,e,i){this.componentId=t,this.componentName=e,this.classId=i}};A=x([u(),R("design:paramtypes",[String,String,Number])],A);let _=class{constructor(t){this.componentId=t}};_=x([u(),R("design:paramtypes",[String])],_);let z=class{constructor(t,e){this.componentId=t,this.component=e}};function P(t,e){return function(i){if(i.isComponent)throw new TypeError(`You cannot extend a component. Trying to extend ${i.originalClassName} with: ${t}`);const n=i,o=function(){const i=Array.prototype.slice.call(arguments),o=new n(...i);return Object.defineProperty(o,T,{enumerable:!1,writable:!1,configurable:!1,value:t}),void 0!==e&&Object.defineProperty(o,C,{enumerable:!1,writable:!1,configurable:!1,value:e}),o};return void 0!==e&&(o[C]=e),o[T]=t,o.isComponent=!0,o.originalClassName=t,(o.prototype=i.prototype).constructor=i,o}}function S(t,e){return function(i){if(i.isComponent)throw new TypeError(`You cannot extend a component. Trying to extend ${i.originalClassName} with: ${t}`);if("number"!=typeof e||isNaN(e))throw new Error(`classId: ${e} is an invalid integer`);const n=i,o=function(){if(!S.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");const i=Array.prototype.slice.call(arguments),o=new n(...i),s=r("C");return Object.defineProperty(o,T,{enumerable:!1,writable:!1,configurable:!1,value:t}),Object.defineProperty(o,E,{enumerable:!1,writable:!1,configurable:!1,value:s}),void 0!==e&&Object.defineProperty(o,C,{enumerable:!1,writable:!1,configurable:!1,value:e}),S.engine&&S.engine.registerComponent(o),o};return void 0!==e&&(o[C]=e),o[T]=t,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=t,(o.prototype=i.prototype).constructor=i,o}}function O(t){if(!t)throw new TypeError(t+" is not a component.");if(t[T])return t[T];throw new TypeError(t+" is not a registered component.")}function I(t){if(!t)throw new TypeError(t+" is not a component.");if(t[C])return t[C];if(!t[T])throw new TypeError(t+" is not a registered component.");return null}function F(t){if(!t)throw new TypeError(t+" is not a component.");if(t[E])return t[E];throw new TypeError(t+" is not a registered disposable component.")}z=x([u(),R("design:paramtypes",[String,Object])],z),function(t){t.engine=null}(S||(S={}));class N{constructor(){this.dirty=!1,this.data={},this.subscriptions=[]}static component(t,e){if(delete t[e]){const i=e+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(t,i)),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[i]},set:function(t){const n=this[i];if(this.data[e]=t?F(t):null,this[i]=t,t!==n){this.dirty=!0;for(let i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})}}static field(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e]},set:function(t){const i=this.data[e];if(this.data[e]=t,t!==i){this.dirty=!0;for(let n=0;n<this.subscriptions.length;n++)this.subscriptions[n](e,t,i)}},enumerable:!0})}static uiValue(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e].toString()},set:function(t){const i=this.data[e],n=new v(t);if(this.data[e]=n,n!==i){this.dirty=!0;for(let t=0;t<this.subscriptions.length;t++)this.subscriptions[t](e,n,i)}},enumerable:!0})}static readonly(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){if(e in this.data==!1)throw new Error(`The field ${e} is uninitialized`);return this.data[e]},set:function(t){if(e in this.data)throw new Error(`The field ${e} is readonly`);this.data[e]=t,this.dirty=!0},enumerable:!0,configurable:!1})}onChange(t){return this.subscriptions.push(t),this}toJSON(){return this.data}}function M(t){return E in t}class L{constructor(...t){if(this.entities=[],this.active=!1,this._requiresNames=[],!t)throw new Error("ComponentGroup: Could not load the requires list");if(!(t instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return t.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(let e=0;e<t.length;e++){const i=t[e];let n=null;if(!i)throw new Error(`ComponentGroup: the required component at location ${e} is invalid`);try{n=O(i)}catch(t){throw new Error(`ComponentGroup: the required component at location ${e} is not registered as a @Component. Remember to provide the class of the component, not the name`)}if(this._requiresNames.some(t=>t===n))throw new Error(`ComponentGroup: the required component list has a repeated name ${n}`);this._requiresNames.push(n)}}hasEntity(t){return!!t.isAddedToEngine()&&-1!==this.entities.indexOf(t)}addEntity(t){if(!t.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(t)&&this.entities.push(t)}removeEntity(t){const e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)}componentRemoved(t,e){-1!==this._requiresNames.indexOf(e)&&this.removeEntity(t)}meetsRequirements(t){for(let e=0;e<this._requiresNames.length;e++){if(!(this._requiresNames[e]in t.components))return!1}return!0}}class U{constructor(t){this.name=t,this.children={},this.eventManager=null,this.alive=!1,this.uuid=r("E"),this.components={},this.engine=null,this._parent=null}addComponentOrReplace(t){if("function"==typeof t)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof t)throw new Error(`You passed a ${typeof t}, an instance of component is expected`);const e=O(t);if(this.components[e]){if(this.components[e]===t)return t;this.removeComponent(this.components[e],!1)}return this.addComponent(t)}hasComponent(t){const e=typeof t;if("string"!==e&&"object"!==e&&"function"!==e)throw new Error("Entity#has(component): component is not a class, name or instance");if(null==t)return!1;const i="string"===e?t:O(t),n=this.components[i];return!!n&&("object"===e?n===t:"function"!==e||n instanceof t)}getComponent(t){const e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#get(component): component is not a class or name");const i="string"===e?t:O(t),n=this.components[i];if(!n)throw new Error(`Can not get component "${i}" from entity "${this.identifier}"`);if("function"===e){if(n instanceof t)return n;throw new Error(`Can not get component "${i}" from entity "${this.identifier}" (by instance)`)}return n}getComponentOrNull(t){const e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#getOrNull(component): component is not a class or name");const i="string"===e?t:O(t),n=this.components[i];return n?"function"===e?n instanceof t?n:null:n:null}getComponentOrCreate(t){if("function"!=typeof t)throw new Error("Entity#getOrCreate(component): component is not a class");let e=this.getComponentOrNull(t);return e||(O(e=new t),this.addComponentOrReplace(e)),e}addComponent(t){if("object"!=typeof t)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");const e=O(t),i=I(t);if(this.components[e])throw new Error(`A component of type "${e}" is already present in entity "${this.identifier}"`);this.components[e]=t,this.eventManager&&this.eventManager.fireEvent(new g(this,e,i));const n=t;return"function"==typeof n.addedToEntity&&n.addedToEntity(this),t}removeComponent(t,e=!0){const i=typeof t;if("string"!==i&&"function"!==i&&"object"!==i)throw new Error("Entity#remove(component): component is not a class, class or name");const n="string"===i?t:O(t),s=this.components[n];if(s){if("function"===i)return s instanceof t?(delete this.components[n],void(s&&(e&&this.eventManager&&this.eventManager.fireEvent(new f(this,n,s)),"function"==typeof s.removedFromEntity&&s.removedFromEntity(this)))):void o(`Entity Warning: Trying to remove wrong (by constructor) component "${n}" from entity "${this.identifier}"`);delete this.components[n],s&&(e&&this.eventManager&&this.eventManager.fireEvent(new f(this,n,s)),"function"==typeof s.removedFromEntity&&s.removedFromEntity(this))}else o(`Entity Warning: Trying to remove inexisting component "${n}" from entity "${this.identifier}"`)}isAddedToEngine(){return!(!this.engine||!(this.uuid in this.engine.entities||this.engine.rootEntity===this))}setParent(t){let e=!t&&this.engine?this.engine.rootEntity:t,i=this.getParent();if(e===this)throw new Error(`Failed to set parent for entity "${this.identifier}": An entity can't set itself as a its own parent`);if(e===i)return this;const n=this.getCircularAncestor(e);if(n)throw new Error(`Failed to set parent for entity "${this.identifier}": Circular parent references are not allowed (See entity "${n}")`);return i&&delete i.children[this.uuid],null!==e&&"0"!==e.uuid&&(!e.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),e.isAddedToEngine()&&!this.isAddedToEngine()&&e.engine.addEntity(this)),this._parent=e||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new w(this,e)),this}getParent(){return this._parent}get identifier(){return this.name||this.uuid}getCircularAncestor(t){const e=this.engine?this.engine.rootEntity:null;let i=t;for(;i&&i!==e;){const t=i.getParent();if(t===this)return i.uuid;i=t}return null}registerAsChild(){const t=this.getParent();this.uuid&&t&&(t.children[this.uuid]=this)}}Promise.resolve().then.bind(Promise.resolve());var j=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},B=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let H=class{constructor(t,e){this.uuid=t,this.payload=e}};H=j([u(),B("design:paramtypes",[String,Object])],H);let D=class{constructor(t){this.payload=t}};D=j([u(),B("design:paramtypes",[Object])],D);let k=class{constructor(t){this.payload=t}};k=j([u(),B("design:paramtypes",[Object])],k);const G="0";class W{constructor(t){this.dcl=t,this.cachedComponents={}}activate(t){this.engine=t,t.eventManager.addListener(g,this,this.componentAdded),t.eventManager.addListener(f,this,this.componentRemoved),t.eventManager.addListener(A,this,this.disposableComponentCreated),t.eventManager.addListener(_,this,this.disposableComponentRemoved),t.eventManager.addListener(z,this,this.disposableComponentUpdated),t.eventManager.addListener(w,this,this.parentChanged);const e=t.rootEntity.uuid;this.dcl.addEntity(e),this.dcl.onUpdate(e=>{t.update(e),this.presentEntities()}),this.dcl.onEvent(e=>{const i=e.data;switch(e.type){case"uuidEvent":t.eventManager.fireEvent(new H(i.uuid,i.payload));break;case"raycastResponse":"HitFirst"===i.queryType?t.eventManager.fireEvent(new D(i)):"HitAll"===i.queryType&&t.eventManager.fireEvent(new D(i));break;case"pointerEvent":t.eventManager.fireEvent(new k(i.payload))}})}onAddEntity(t){if(t&&t.isAddedToEngine()){const e=t.uuid,i=t.getParent();this.dcl.addEntity(e),i&&this.dcl.setParent(e,i.uuid),this.cachedComponents[e]={};for(let i in t.components){const n=t.components[i],o=I(n);if(null!==o)if(M(n))this.dcl.attachEntityComponent(t.uuid,i,F(n));else{const t=JSON.stringify(n);this.dcl.updateEntityComponent(e,i,o,t),this.cachedComponents[e][i]=t}}}}onRemoveEntity(t){if(t.isAddedToEngine()){const e=t.uuid;this.dcl.removeEntity(e),delete this.cachedComponents[e]}}presentEntities(){for(let t in this.engine.entities){const e=this.engine.entities[t],i=e.uuid;for(let t in e.components){const n=e.components[t],o=I(n);if(null!==o&&!M(n)){const s=JSON.stringify(n);this.cachedComponents[i][t]!==s&&(this.dcl.updateEntityComponent(e.uuid,t,o,s),this.cachedComponents[i][t]=s)}}}for(let t in this.engine.disposableComponents){const e=this.engine.disposableComponents[t];e instanceof N&&e.dirty&&(this.dcl.componentUpdated(t,JSON.stringify(e)),e.dirty=!1)}}componentAdded(t){if(t.entity.isAddedToEngine()){const e=t.entity.components[t.componentName];if(M(e))this.dcl.attachEntityComponent(t.entity.uuid,t.componentName,F(e));else if(null!==t.classId){const i=JSON.stringify(e);this.dcl.updateEntityComponent(t.entity.uuid,t.componentName,t.classId,i),this.cachedComponents[t.entity.uuid][t.componentName]=i}}}componentRemoved(t){t.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(t.entity.uuid,t.componentName),delete this.cachedComponents[t.entity.uuid][t.componentName])}disposableComponentCreated(t){this.dcl.componentCreated(t.componentId,t.componentName,t.classId)}disposableComponentRemoved(t){this.dcl.componentDisposed(t.componentId)}disposableComponentUpdated(t){this.dcl.componentUpdated(t.componentId,JSON.stringify(t.component))}parentChanged(t){this.dcl.setParent(t.entity.uuid,t.parent?t.parent.uuid:G)}}var q,V;!function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(q||(q={})),function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD",t[t.BONE=2]="BONE"}(V||(V={}));const Y=1/2.2,X=2.2,$=1e-6,Z=Math.PI/180,K=360/(2*Math.PI);class J{static WithinEpsilon(t,e,i=1401298e-51){let n=t-e;return-i<=n&&n<=i}static ToHex(t){let e=t.toString(16);return t<=15?("0"+e).toUpperCase():e.toUpperCase()}static Sign(t){const e=+t;return 0===e||isNaN(e)?e:e>0?1:-1}static Clamp(t,e=0,i=1){return Math.min(i,Math.max(e,t))}static Log2(t){return Math.log(t)*Math.LOG2E}static Repeat(t,e){return t-Math.floor(t/e)*e}static Normalize(t,e,i){return(t-e)/(i-e)}static Denormalize(t,e,i){return t*(i-e)+e}static DeltaAngle(t,e){let i=J.Repeat(e-t,360);return i>180&&(i-=360),i}static PingPong(t,e){let i=J.Repeat(t,2*e);return e-Math.abs(i-e)}static SmoothStep(t,e,i){let n=J.Clamp(i);return e*(n=-2*n*n*n+3*n*n)+t*(1-n)}static MoveTowards(t,e,i){let n=0;return n=Math.abs(e-t)<=i?e:t+J.Sign(e-t)*i}static MoveTowardsAngle(t,e,i){let n=J.DeltaAngle(t,e),o=0;return o=-i<n&&n<i?e:J.MoveTowards(t,t+n,i)}static Lerp(t,e,i){return t+(e-t)*i}static LerpAngle(t,e,i){let n=J.Repeat(e-t,360);return n>180&&(n-=360),t+n*J.Clamp(i)}static InverseLerp(t,e,i){let n=0;return n=t!==e?J.Clamp((i-t)/(e-t)):0}static Hermite(t,e,i,n,o){let s=o*o,r=o*s;return t*(2*r-3*s+1)+i*(-2*r+3*s)+e*(r-2*s+o)+n*(r-s)}static RandomRange(t,e){return t===e?t:Math.random()*(e-t)+t}static RangeToPercent(t,e,i){return(t-e)/(i-e)}static PercentToRange(t,e,i){return(i-e)*t+e}static NormalizeRadians(t){return t-J.TwoPi*Math.floor((t+Math.PI)/J.TwoPi)}}J.TwoPi=2*Math.PI;class Q{constructor(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}static Add(t,e){return new Q(t.x,t.y,t.z,t.w).addInPlace(e)}static FromArray(t,e=0){return new Q(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]}static FromFloatArrayToRef(t,e,i){Q.FromArrayToRef(t,e,i)}static FromFloatsToRef(t,e,i,n,o){o.x=t,o.y=e,o.z=i,o.w=n}static Zero(){return new Q(0,0,0,0)}static One(){return new Q(1,1,1,1)}static Normalize(t){let e=Q.Zero();return Q.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){e.copyFrom(t),e.normalize()}static Minimize(t,e){let i=new Q(t.x,t.y,t.z,t.w);return i.minimizeInPlace(e),i}static Maximize(t,e){let i=new Q(t.x,t.y,t.z,t.w);return i.maximizeInPlace(e),i}static Distance(t,e){return Math.sqrt(Q.DistanceSquared(t,e))}static DistanceSquared(t,e){let i=t.x-e.x,n=t.y-e.y,o=t.z-e.z,s=t.w-e.w;return i*i+n*n+o*o+s*s}static Center(t,e){let i=Q.Add(t,e);return i.scaleInPlace(.5),i}static TransformNormal(t,e){let i=Q.Zero();return Q.TransformNormalToRef(t,e,i),i}static TransformNormalToRef(t,e,i){const n=e.m;let o=t.x*n[0]+t.y*n[4]+t.z*n[8],s=t.x*n[1]+t.y*n[5]+t.z*n[9],r=t.x*n[2]+t.y*n[6]+t.z*n[10];i.x=o,i.y=s,i.z=r,i.w=t.w}static TransformNormalFromFloatsToRef(t,e,i,n,o,s){const r=o.m;s.x=t*r[0]+e*r[4]+i*r[8],s.y=t*r[1]+e*r[5]+i*r[9],s.z=t*r[2]+e*r[6]+i*r[10],s.w=n}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)}asArray(){let t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}add(t){return new Q(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subtract(t){return new Q(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this}subtractFromFloats(t,e,i,n){return new Q(this.x-t,this.y-e,this.z-i,this.w-n)}subtractFromFloatsToRef(t,e,i,n,o){return o.x=this.x-t,o.y=this.y-e,o.z=this.z-i,o.w=this.w-n,this}negate(){return new Q(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scale(t){return new Q(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}equalsWithEpsilon(t,e=$){return t&&J.WithinEpsilon(this.x,t.x,e)&&J.WithinEpsilon(this.y,t.y,e)&&J.WithinEpsilon(this.z,t.z,e)&&J.WithinEpsilon(this.w,t.w,e)}equalsToFloats(t,e,i,n){return this.x===t&&this.y===e&&this.z===i&&this.w===n}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiply(t){return new Q(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this}multiplyByFloats(t,e,i,n){return new Q(this.x*t,this.y*e,this.z*i,this.w*n)}divide(t){return new Q(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}maximizeInPlace(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}floor(){return new Q(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new Q(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){let t=this.length();return 0===t?this:this.scaleInPlace(1/t)}toVector3(){return new it(this.x,this.y,this.z)}clone(){return new Q(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}setAll(t){return this.x=this.y=this.z=this.w=t,this}}class tt{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return tt._identityReadOnly}static FromArray(t,e=0){let i=new tt;return tt.FromArrayToRef(t,e,i),i}static FromArrayToRef(t,e,i){for(let n=0;n<16;n++)i._m[n]=t[n+e];i._markAsUpdated()}static FromFloatArrayToRefScaled(t,e,i,n){for(let o=0;o<16;o++)n._m[o]=t[o+e]*i;n._markAsUpdated()}static FromValuesToRef(t,e,i,n,o,s,r,a,d,l,h,p,c,u,y,m,f){const g=f._m;g[0]=t,g[1]=e,g[2]=i,g[3]=n,g[4]=o,g[5]=s,g[6]=r,g[7]=a,g[8]=d,g[9]=l,g[10]=h,g[11]=p,g[12]=c,g[13]=u,g[14]=y,g[15]=m,f._markAsUpdated()}static FromValues(t,e,i,n,o,s,r,a,d,l,h,p,c,u,y,m){let f=new tt;const g=f._m;return g[0]=t,g[1]=e,g[2]=i,g[3]=n,g[4]=o,g[5]=s,g[6]=r,g[7]=a,g[8]=d,g[9]=l,g[10]=h,g[11]=p,g[12]=c,g[13]=u,g[14]=y,g[15]=m,f._markAsUpdated(),f}static Compose(t,e,i){let n=new tt;return tt.ComposeToRef(t,e,i,n),n}static ComposeToRef(t,e,i,n){tt.ScalingToRef(t.x,t.y,t.z,nt.Matrix[1]),e.toRotationMatrix(nt.Matrix[0]),nt.Matrix[1].multiplyToRef(nt.Matrix[0],n),n.setTranslation(i)}static Identity(){const t=tt.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t}static IdentityToRef(t){tt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0)}static Zero(){const t=tt.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t}static RotationX(t){let e=new tt;return tt.RotationXToRef(t,e),e}static Invert(t){let e=new tt;return t.invertToRef(e),e}static RotationXToRef(t,e){let i=Math.sin(t),n=Math.cos(t);tt.FromValuesToRef(1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationY(t){let e=new tt;return tt.RotationYToRef(t,e),e}static RotationYToRef(t,e){let i=Math.sin(t),n=Math.cos(t);tt.FromValuesToRef(n,0,-i,0,0,1,0,0,i,0,n,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationZ(t){let e=new tt;return tt.RotationZToRef(t,e),e}static RotationZToRef(t,e){let i=Math.sin(t),n=Math.cos(t);tt.FromValuesToRef(n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationAxis(t,e){let i=new tt;return tt.RotationAxisToRef(t,e,i),i}static RotationAxisToRef(t,e,i){let n=Math.sin(-e),o=Math.cos(-e),s=1-o;t.normalize();const r=i._m;r[0]=t.x*t.x*s+o,r[1]=t.x*t.y*s-t.z*n,r[2]=t.x*t.z*s+t.y*n,r[3]=0,r[4]=t.y*t.x*s+t.z*n,r[5]=t.y*t.y*s+o,r[6]=t.y*t.z*s-t.x*n,r[7]=0,r[8]=t.z*t.x*s-t.y*n,r[9]=t.z*t.y*s+t.x*n,r[10]=t.z*t.z*s+o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,i._markAsUpdated()}static RotationYawPitchRoll(t,e,i){let n=new tt;return tt.RotationYawPitchRollToRef(t,e,i,n),n}static RotationYawPitchRollToRef(t,e,i,n){et.RotationYawPitchRollToRef(t,e,i,nt.Quaternion[0]),nt.Quaternion[0].toRotationMatrix(n)}static Scaling(t,e,i){let n=new tt;return tt.ScalingToRef(t,e,i,n),n}static ScalingToRef(t,e,i,n){tt.FromValuesToRef(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1,n),n._updateIdentityStatus(1===t&&1===e&&1===i)}static Translation(t,e,i){let n=new tt;return tt.TranslationToRef(t,e,i,n),n}static TranslationToRef(t,e,i,n){tt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1,n),n._updateIdentityStatus(0===t&&0===e&&0===i)}static Lerp(t,e,i){let n=new tt;return tt.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){for(let o=0;o<16;o++)n._m[o]=t._m[o]*(1-i)+e._m[o]*i;n._markAsUpdated()}static DecomposeLerp(t,e,i){let n=new tt;return tt.DecomposeLerpToRef(t,e,i,n),n}static DecomposeLerpToRef(t,e,i,n){let o=nt.Vector3[0],s=nt.Quaternion[0],r=nt.Vector3[1];t.decompose(o,s,r);let a=nt.Vector3[2],d=nt.Quaternion[1],l=nt.Vector3[3];e.decompose(a,d,l);let h=nt.Vector3[4];it.LerpToRef(o,a,i,h);let p=nt.Quaternion[2];et.SlerpToRef(s,d,i,p);let c=nt.Vector3[5];it.LerpToRef(r,l,i,c),tt.ComposeToRef(h,p,c,n)}static LookAtLH(t,e,i){let n=new tt;return tt.LookAtLHToRef(t,e,i,n),n}static LookAtLHToRef(t,e,i,n){const o=nt.Vector3[0],s=nt.Vector3[1],r=nt.Vector3[2];e.subtractToRef(t,r),r.normalize(),it.CrossToRef(i,r,o);const a=o.lengthSquared();0===a?o.x=1:o.normalizeFromLength(Math.sqrt(a)),it.CrossToRef(r,o,s),s.normalize();let d=-it.Dot(o,t),l=-it.Dot(s,t),h=-it.Dot(r,t);tt.FromValuesToRef(o.x,s.x,r.x,0,o.y,s.y,r.y,0,o.z,s.z,r.z,0,d,l,h,1,n)}static LookAtRH(t,e,i){let n=new tt;return tt.LookAtRHToRef(t,e,i,n),n}static LookAtRHToRef(t,e,i,n){const o=nt.Vector3[0],s=nt.Vector3[1],r=nt.Vector3[2];t.subtractToRef(e,r),r.normalize(),it.CrossToRef(i,r,o);const a=o.lengthSquared();0===a?o.x=1:o.normalizeFromLength(Math.sqrt(a)),it.CrossToRef(r,o,s),s.normalize();let d=-it.Dot(o,t),l=-it.Dot(s,t),h=-it.Dot(r,t);tt.FromValuesToRef(o.x,s.x,r.x,0,o.y,s.y,r.y,0,o.z,s.z,r.z,0,d,l,h,1,n)}static OrthoLH(t,e,i,n){let o=new tt;return tt.OrthoLHToRef(t,e,i,n,o),o}static OrthoLHToRef(t,e,i,n,o){let s=2/t,r=2/e,a=2/(n-i),d=-(n+i)/(n-i);tt.FromValuesToRef(s,0,0,0,0,r,0,0,0,0,a,0,0,0,d,1,o),o._updateIdentityStatus(1===s&&1===r&&1===a&&0===d)}static OrthoOffCenterLH(t,e,i,n,o,s){let r=new tt;return tt.OrthoOffCenterLHToRef(t,e,i,n,o,s,r),r}static OrthoOffCenterLHToRef(t,e,i,n,o,s,r){let a=2/(e-t),d=2/(n-i),l=2/(s-o),h=-(s+o)/(s-o),p=(t+e)/(t-e),c=(n+i)/(i-n);tt.FromValuesToRef(a,0,0,0,0,d,0,0,0,0,l,0,p,c,h,1,r),r._markAsUpdated()}static OrthoOffCenterRH(t,e,i,n,o,s){let r=new tt;return tt.OrthoOffCenterRHToRef(t,e,i,n,o,s,r),r}static OrthoOffCenterRHToRef(t,e,i,n,o,s,r){tt.OrthoOffCenterLHToRef(t,e,i,n,o,s,r),r._m[10]*=-1}static PerspectiveLH(t,e,i,n){let o=new tt,s=2*i/t,r=2*i/e,a=(n+i)/(n-i),d=-2*n*i/(n-i);return tt.FromValuesToRef(s,0,0,0,0,r,0,0,0,0,a,1,0,0,d,0,o),o._updateIdentityStatus(!1),o}static PerspectiveFovLH(t,e,i,n){let o=new tt;return tt.PerspectiveFovLHToRef(t,e,i,n,o),o}static PerspectiveFovLHToRef(t,e,i,n,o,s=!0){let r=i,a=n,d=1/Math.tan(.5*t),l=s?d/e:d,h=s?d:d*e,p=(a+r)/(a-r),c=-2*a*r/(a-r);tt.FromValuesToRef(l,0,0,0,0,h,0,0,0,0,p,1,0,0,c,0,o),o._updateIdentityStatus(!1)}static PerspectiveFovRH(t,e,i,n){let o=new tt;return tt.PerspectiveFovRHToRef(t,e,i,n,o),o}static PerspectiveFovRHToRef(t,e,i,n,o,s=!0){let r=i,a=n,d=1/Math.tan(.5*t),l=s?d/e:d,h=s?d:d*e,p=-(a+r)/(a-r),c=-2*a*r/(a-r);tt.FromValuesToRef(l,0,0,0,0,h,0,0,0,0,p,-1,0,0,c,0,o),o._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(t,e,i,n,o=!1){let s=o?-1:1,r=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),d=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),h=2/(d+l),p=2/(r+a);const c=n._m;c[0]=h,c[1]=c[2]=c[3]=c[4]=0,c[5]=p,c[6]=c[7]=0,c[8]=(d-l)*h*.5,c[9]=-(r-a)*p*.5,c[10]=-i/(e-i),c[11]=1*s,c[12]=c[13]=c[15]=0,c[14]=-2*i*e/(i-e),n._markAsUpdated()}static GetAsMatrix2x2(t){return[t._m[0],t._m[1],t._m[4],t._m[5]]}static GetAsMatrix3x3(t){return[t._m[0],t._m[1],t._m[2],t._m[4],t._m[5],t._m[6],t._m[8],t._m[9],t._m[10]]}static Transpose(t){let e=new tt;return tt.TransposeToRef(t,e),e}static TransposeToRef(t,e){const i=e._m,n=t._m;i[0]=n[0],i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=n[1],i[5]=n[5],i[6]=n[9],i[7]=n[13],i[8]=n[2],i[9]=n[6],i[10]=n[10],i[11]=n[14],i[12]=n[3],i[13]=n[7],i[14]=n[11],i[15]=n[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)}static Reflection(t){let e=new tt;return tt.ReflectionToRef(t,e),e}static ReflectionToRef(t,e){t.normalize();let i=t.normal.x,n=t.normal.y,o=t.normal.z,s=-2*i,r=-2*n,a=-2*o;tt.FromValuesToRef(s*i+1,r*i,a*i,0,s*n,r*n+1,a*n,0,s*o,r*o,a*o+1,0,s*t.d,r*t.d,a*t.d,1,e)}static FromXYZAxesToRef(t,e,i,n){tt.FromValuesToRef(t.x,t.y,t.z,0,e.x,e.y,e.z,0,i.x,i.y,i.z,0,0,0,0,1,n)}static FromQuaternionToRef(t,e){let i=t.x*t.x,n=t.y*t.y,o=t.z*t.z,s=t.x*t.y,r=t.z*t.w,a=t.z*t.x,d=t.y*t.w,l=t.y*t.z,h=t.x*t.w;e._m[0]=1-2*(n+o),e._m[1]=2*(s+r),e._m[2]=2*(a-d),e._m[3]=0,e._m[4]=2*(s-r),e._m[5]=1-2*(o+i),e._m[6]=2*(l+h),e._m[7]=0,e._m[8]=2*(a+d),e._m[9]=2*(l-h),e._m[10]=1-2*(n+i),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()}_markAsUpdated(){this.updateFlag=tt._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]?this._isIdentity3x2=!1:0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const t=this._m,e=t[0],i=t[1],n=t[2],o=t[3],s=t[4],r=t[5],a=t[6],d=t[7],l=t[8],h=t[9],p=t[10],c=t[11],u=t[12],y=t[13],m=t[14],f=t[15],g=p*f-m*c,w=h*f-y*c,b=h*m-y*p,v=l*f-u*c,x=l*m-p*u,R=l*y-u*h;return e*+(r*g-a*w+d*b)+i*-(s*g-a*v+d*x)+n*+(s*w-r*v+d*R)+o*-(s*b-r*x+a*R)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return tt.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(t){let e=new tt;return this.addToRef(t,e),e}addToRef(t,e){for(let i=0;i<16;i++)e._m[i]=this._m[i]+t._m[i];return e._markAsUpdated(),this}addToSelf(t){for(let e=0;e<16;e++)this._m[e]+=t._m[e];return this._markAsUpdated(),this}invertToRef(t){if(!0===this._isIdentity)return tt.IdentityToRef(t),this;const e=this._m,i=e[0],n=e[1],o=e[2],s=e[3],r=e[4],a=e[5],d=e[6],l=e[7],h=e[8],p=e[9],c=e[10],u=e[11],y=e[12],m=e[13],f=e[14],g=e[15],w=c*g-f*u,b=p*g-m*u,v=p*f-m*c,x=h*g-y*u,R=h*f-c*y,T=h*m-y*p,C=+(a*w-d*b+l*v),E=-(r*w-d*x+l*R),A=+(r*b-a*x+l*T),_=-(r*v-a*R+d*T),z=i*C+n*E+o*A+s*_;if(0===z)return t.copyFrom(this),this;const P=1/z,S=d*g-f*l,O=a*g-m*l,I=a*f-m*d,F=r*g-y*l,N=r*f-y*d,M=r*m-y*a,L=d*u-c*l,U=a*u-p*l,j=a*c-p*d,B=r*u-h*l,H=r*c-h*d,D=r*p-h*a,k=-(n*w-o*b+s*v),G=+(i*w-o*x+s*R),W=-(i*b-n*x+s*T),q=+(i*v-n*R+o*T),V=+(n*S-o*O+s*I),Y=-(i*S-o*F+s*N),X=+(i*O-n*F+s*M),$=-(i*I-n*N+o*M),Z=-(n*L-o*U+s*j),K=+(i*L-o*B+s*H),J=-(i*U-n*B+s*D),Q=+(i*j-n*H+o*D);return tt.FromValuesToRef(C*P,k*P,V*P,Z*P,E*P,G*P,Y*P,K*P,A*P,W*P,X*P,J*P,_*P,q*P,$*P,Q*P,t),this}addAtIndex(t,e){return this._m[t]+=e,this._markAsUpdated(),this}multiplyAtIndex(t,e){return this._m[t]*=e,this._markAsUpdated(),this}setTranslationFromFloats(t,e,i){return this._m[12]=t,this._m[13]=e,this._m[14]=i,this._markAsUpdated(),this}setTranslation(t){return this.setTranslationFromFloats(t.x,t.y,t.z)}getTranslation(){return new it(this._m[12],this._m[13],this._m[14])}getTranslationToRef(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this}removeRotationAndScaling(){const t=this.m;return tt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),this}multiply(t){let e=new tt;return this.multiplyToRef(t,e),e}copyFrom(t){t.copyToArray(this._m);const e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this}copyToArray(t,e=0){for(let i=0;i<16;i++)t[e+i]=this._m[i];return this}multiplyToRef(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)}multiplyToArray(t,e,i){const n=this._m,o=t.m;let s=n[0],r=n[1],a=n[2],d=n[3],l=n[4],h=n[5],p=n[6],c=n[7],u=n[8],y=n[9],m=n[10],f=n[11],g=n[12],w=n[13],b=n[14],v=n[15],x=o[0],R=o[1],T=o[2],C=o[3],E=o[4],A=o[5],_=o[6],z=o[7],P=o[8],S=o[9],O=o[10],I=o[11],F=o[12],N=o[13],M=o[14],L=o[15];return e[i]=s*x+r*E+a*P+d*F,e[i+1]=s*R+r*A+a*S+d*N,e[i+2]=s*T+r*_+a*O+d*M,e[i+3]=s*C+r*z+a*I+d*L,e[i+4]=l*x+h*E+p*P+c*F,e[i+5]=l*R+h*A+p*S+c*N,e[i+6]=l*T+h*_+p*O+c*M,e[i+7]=l*C+h*z+p*I+c*L,e[i+8]=u*x+y*E+m*P+f*F,e[i+9]=u*R+y*A+m*S+f*N,e[i+10]=u*T+y*_+m*O+f*M,e[i+11]=u*C+y*z+m*I+f*L,e[i+12]=g*x+w*E+b*P+v*F,e[i+13]=g*R+w*A+b*S+v*N,e[i+14]=g*T+w*_+b*O+v*M,e[i+15]=g*C+w*z+b*I+v*L,this}equals(t){const e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;const i=this.m,n=e.m;return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]}clone(){const t=new tt;return t.copyFrom(this),t}getClassName(){return"Matrix"}getHashCode(){let t=this._m[0]||0;for(let e=1;e<16;e++)t=397*t^(this._m[e]||0);return t}decompose(t,e,i){if(this._isIdentity)return i&&i.setAll(0),t&&t.setAll(1),e&&e.copyFromFloats(0,0,0,1),!0;const n=this._m;i&&i.copyFromFloats(n[12],n[13],n[14]);const o=t||nt.Vector3[0];if(o.x=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),o.y=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),o.z=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),this.determinant()<=0&&(o.y*=-1),0===o.x||0===o.y||0===o.z)return e&&e.copyFromFloats(0,0,0,1),!1;if(e){const t=1/o.x,i=1/o.y,s=1/o.z;tt.FromValuesToRef(n[0]*t,n[1]*t,n[2]*t,0,n[4]*i,n[5]*i,n[6]*i,0,n[8]*s,n[9]*s,n[10]*s,0,0,0,0,1,nt.Matrix[0]),et.FromRotationMatrixToRef(nt.Matrix[0],e)}return!0}getRow(t){if(t<0||t>3)return null;let e=4*t;return new Q(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])}setRow(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)}transpose(){return tt.Transpose(this)}transposeToRef(t){return tt.TransposeToRef(this,t),this}setRowFromFloats(t,e,i,n,o){if(t<0||t>3)return this;let s=4*t;return this._m[s+0]=e,this._m[s+1]=i,this._m[s+2]=n,this._m[s+3]=o,this._markAsUpdated(),this}scale(t){let e=new tt;return this.scaleToRef(t,e),e}scaleToRef(t,e){for(let i=0;i<16;i++)e._m[i]=this._m[i]*t;return e._markAsUpdated(),this}scaleAndAddToRef(t,e){for(let i=0;i<16;i++)e._m[i]+=this._m[i]*t;return e._markAsUpdated(),this}toNormalMatrix(t){const e=nt.Matrix[0];this.invertToRef(e),e.transposeToRef(t);let i=t._m;tt.FromValuesToRef(i[0],i[1],i[2],0,i[4],i[5],i[6],0,i[8],i[9],i[10],0,0,0,0,1,t)}getRotationMatrix(){let t=new tt;return this.getRotationMatrixToRef(t),t}getRotationMatrixToRef(t){const e=nt.Vector3[0];if(!this.decompose(e))return tt.IdentityToRef(t),this;const i=this._m,n=1/e.x,o=1/e.y,s=1/e.z;return tt.FromValuesToRef(i[0]*n,i[1]*n,i[2]*n,0,i[4]*o,i[5]*o,i[6]*o,0,i[8]*s,i[9]*s,i[10]*s,0,0,0,0,1,t),this}toggleModelMatrixHandInPlace(){const t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){let t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(t,e=!1,i=!1,n=!0){this.updateFlag=tt._updateFlagSeed++,this._isIdentity=t,this._isIdentity3x2=t||i,this._isIdentityDirty=!this._isIdentity&&e,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n}}tt._updateFlagSeed=0,tt._identityReadOnly=tt.Identity();class et{constructor(t=0,e=0,i=0,n=1){this.x=t,this.y=e,this.z=i,this.w=n}static FromRotationMatrix(t){let e=new et;return et.FromRotationMatrixToRef(t,e),e}static FromRotationMatrixToRef(t,e){let i,n=t.m,o=n[0],s=n[4],r=n[8],a=n[1],d=n[5],l=n[9],h=n[2],p=n[6],c=n[10],u=o+d+c;u>0?(i=.5/Math.sqrt(u+1),e.w=.25/i,e.x=(p-l)*i,e.y=(r-h)*i,e.z=(a-s)*i):o>d&&o>c?(i=2*Math.sqrt(1+o-d-c),e.w=(p-l)/i,e.x=.25*i,e.y=(s+a)/i,e.z=(r+h)/i):d>c?(i=2*Math.sqrt(1+d-o-c),e.w=(r-h)/i,e.x=(s+a)/i,e.y=.25*i,e.z=(l+p)/i):(i=2*Math.sqrt(1+c-o-d),e.w=(a-s)/i,e.x=(r+h)/i,e.y=(l+p)/i,e.z=.25*i)}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static AreClose(t,e){return et.Dot(t,e)>=0}static Zero(){return new et(0,0,0,0)}static Inverse(t){return new et(-t.x,-t.y,-t.z,t.w)}static IsIdentity(t){return t&&0===t.x&&0===t.y&&0===t.z&&1===t.w}static RotationAxis(t,e){const i=e*Z;return et.RotationAxisToRef(t,i,new et)}static RotationAxisToRef(t,e,i){const n=e*Z;let o=Math.sin(n/2);return t.normalize(),i.w=Math.cos(n/2),i.x=t.x*o,i.y=t.y*o,i.z=t.z*o,i}static FromArray(t,e=0){return new et(t[e],t[e+1],t[e+2],t[e+3])}static FromEulerAnglesRef(t,e,i,n){return et.RotationYawPitchRollToRef(e*Z,t*Z,i*Z,n)}static RotationYawPitchRoll(t,e,i){let n=new et;return et.RotationYawPitchRollToRef(t,e,i,n),n}static RotationYawPitchRollToRef(t,e,i,n){let o=.5*i,s=.5*e,r=.5*t,a=Math.cos(s),d=Math.cos(r),l=Math.cos(o),h=Math.sin(s),p=Math.sin(r),c=Math.sin(o);n.x=h*d*l+a*p*c,n.y=a*p*l-h*d*c,n.z=a*d*c+h*p*l,n.w=a*d*l-h*p*c}static RotationAlphaBetaGamma(t,e,i){let n=new et;return et.RotationAlphaBetaGammaToRef(t,e,i,n),n}static RotationAlphaBetaGammaToRef(t,e,i,n){let o=.5*(i+t),s=.5*(i-t),r=.5*e;n.x=Math.cos(s)*Math.sin(r),n.y=Math.sin(s)*Math.sin(r),n.z=Math.sin(o)*Math.cos(r),n.w=Math.cos(o)*Math.cos(r)}static RotationQuaternionFromAxis(t,e,i){let n=new et(0,0,0,0);return et.RotationQuaternionFromAxisToRef(t,e,i,n),n}static RotationQuaternionFromAxisToRef(t,e,i,n){let o=nt.Matrix[0];tt.FromXYZAxesToRef(t.normalize(),e.normalize(),i.normalize(),o),et.FromRotationMatrixToRef(o,n)}static Slerp(t,e,i){let n=et.Identity;return et.SlerpToRef(t,e,i,n),n}static SlerpToRef(t,e,i,n){let o,s,r=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w,a=!1;if(r<0&&(a=!0,r=-r),r>.999999)s=1-i,o=a?-i:i;else{let t=Math.acos(r),e=1/Math.sin(t);s=Math.sin((1-i)*t)*e,o=a?-Math.sin(i*t)*e:Math.sin(i*t)*e}n.x=s*t.x+o*e.x,n.y=s*t.y+o*e.y,n.z=s*t.z+o*e.z,n.w=s*t.w+o*e.w}static Hermite(t,e,i,n,o){let s=o*o,r=o*s,a=2*r-3*s+1,d=-2*r+3*s,l=r-2*s+o,h=r-s,p=t.x*a+i.x*d+e.x*l+n.x*h,c=t.y*a+i.y*d+e.y*l+n.y*h,u=t.z*a+i.z*d+e.z*l+n.z*h,y=t.w*a+i.w*d+e.w*l+n.w*h;return new et(p,c,u,y)}static get Identity(){return new et(0,0,0,1)}static Angle(t,e){const i=et.Dot(t,e);return 2*Math.acos(Math.min(Math.abs(i),1))*K}static Euler(t,e,i){return et.RotationYawPitchRoll(e*Z,t*Z,i*Z)}static LookRotation(t,e=nt.staticUp){const i=it.Normalize(t),n=it.Normalize(it.Cross(e,i)),o=it.Cross(i,n);let s=n.x,r=n.y,a=n.z,d=o.x,l=o.y,h=o.z,p=i.x,c=i.y,u=i.z;const y=s+l+u;let m=new et;if(y>0){let t=Math.sqrt(y+1);return m.w=.5*t,t=.5/t,m.x=(h-c)*t,m.y=(p-a)*t,m.z=(r-d)*t,m}if(s>=l&&s>=u){let t=Math.sqrt(1+s-l-u),e=.5/t;return m.x=.5*t,m.y=(r+d)*e,m.z=(a+p)*e,m.w=(h-c)*e,m}if(l>u){let t=Math.sqrt(1+l-s-u),e=.5/t;return m.x=(d+r)*e,m.y=.5*t,m.z=(c+h)*e,m.w=(p-a)*e,m}let f=Math.sqrt(1+u-s-l),g=.5/f;return m.x=(p+a)*g,m.y=(c+h)*g,m.z=.5*f,m.w=(r-d)*g,m}static RotateTowards(t,e,i){const n=et.Angle(t,e);if(0===n)return e;const o=Math.min(1,i/n);return et.Slerp(t,e,o)}static FromToRotation(t,e){const i=new et;let n=t.normalize(),o=e.normalize(),s=it.Dot(n,o);if(s>-1+$){let t=Math.sqrt(2*(1+s)),e=1/t,r=it.Cross(n,o).scaleInPlace(e);i.set(r.x,r.y,r.z,.5*t)}else{if(s>1-$)return new et(0,0,0,1);{let t=it.Cross(it.Right(),n);t.lengthSquared()<$&&(t=it.Cross(it.Forward(),n)),i.set(t.x,t.y,t.z,0)}}return i.normalize()}get normalized(){return this.normalize()}setFromToRotation(t,e,i=nt.staticUp){nt.tmpMatrix=tt.Zero(),tt.LookAtLHToRef(t,e,i,nt.tmpMatrix),nt.tmpMatrix.invert(),et.FromRotationMatrixToRef(nt.tmpMatrix,this)}set eulerAngles(t){this.setEuler(t.x,t.y,t.z)}get eulerAngles(){const t=new it,e=new tt;this.toRotationMatrix(e);const i=tt.GetAsMatrix3x3(e);return t.y=K*Math.asin(Math.max(-1,Math.min(1,i[6]))),Math.abs(i[6])<.99999?(t.x=K*Math.atan2(-i[7],i[8]),t.z=K*Math.atan2(-i[3],i[0])):(t.x=K*Math.atan2(i[5],i[4]),t.z=0),t}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)}asArray(){return[this.x,this.y,this.z,this.w]}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}clone(){return new et(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}setEuler(t,e,i){return et.RotationYawPitchRollToRef(e*Z,t*Z,i*Z,this),this}add(t){return new et(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return new et(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}scale(t){return new et(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}multiply(t){let e=new et(0,0,0,1);return this.multiplyToRef(t,e),e}multiplyToRef(t,e){let i=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,n=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,o=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,s=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return e.copyFromFloats(i,n,o,s),this}multiplyInPlace(t){return this.multiplyToRef(t,this),this}conjugateToRef(t){return t.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new et(-this.x,-this.y,-this.z,this.w)}normalize(){let t=1/this.length;return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}angleAxis(t,e){if(0===e.lengthSquared())return et.Identity;const i=et.Identity;let n=t*Z;n*=.5;let o=e.normalize();return o=e.scaleInPlace(Math.sin(n)),i.x=o.x,i.y=o.y,i.z=o.z,i.w=Math.cos(n),i.normalize()}toRotationMatrix(t){return tt.FromQuaternionToRef(this,t),this}fromRotationMatrix(t){return et.FromRotationMatrixToRef(t,this),this}}class it{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}get isNonUniform(){let t=Math.abs(this.x),e=Math.abs(this.y);if(t!==e)return!0;let i=Math.abs(this.z);return t!==i||e!==i}static Add(t,e){return new it(t.x,t.y,t.z).addInPlace(e)}static GetClipFactor(t,e,i,n){let o=it.Dot(t,i)-n;return o/(o-(it.Dot(e,i)-n))}static GetAngleBetweenVectors(t,e,i){const n=t.normalizeToRef(nt.Vector3[1]),o=e.normalizeToRef(nt.Vector3[2]),s=it.Dot(n,o),r=nt.Vector3[3];return it.CrossToRef(n,o,r),it.Dot(r,i)>0?Math.acos(s):-Math.acos(s)}static FromArray(t,e=0){return new it(t[e],t[e+1],t[e+2])}static FromFloatArray(t,e){return it.FromArray(t,e)}static FromArrayToRef(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2]}static FromFloatArrayToRef(t,e,i){return it.FromArrayToRef(t,e,i)}static FromFloatsToRef(t,e,i,n){n.copyFromFloats(t,e,i)}static Zero(){return new it(0,0,0)}static One(){return new it(1,1,1)}static Up(){return new it(0,1,0)}static Down(){return new it(0,-1,0)}static Forward(){return new it(0,0,1)}static Backward(){return new it(0,0,-1)}static Right(){return new it(1,0,0)}static Left(){return new it(-1,0,0)}static TransformCoordinates(t,e){let i=it.Zero();return it.TransformCoordinatesToRef(t,e,i),i}static TransformCoordinatesToRef(t,e,i){return it.TransformCoordinatesFromFloatsToRef(t.x,t.y,t.z,e,i)}static TransformCoordinatesFromFloatsToRef(t,e,i,n,o){const s=n.m;let r=t*s[0]+e*s[4]+i*s[8]+s[12],a=t*s[1]+e*s[5]+i*s[9]+s[13],d=t*s[2]+e*s[6]+i*s[10]+s[14],l=1/(t*s[3]+e*s[7]+i*s[11]+s[15]);o.x=r*l,o.y=a*l,o.z=d*l}static TransformNormal(t,e){let i=it.Zero();return it.TransformNormalToRef(t,e,i),i}static TransformNormalToRef(t,e,i){this.TransformNormalFromFloatsToRef(t.x,t.y,t.z,e,i)}static TransformNormalFromFloatsToRef(t,e,i,n,o){const s=n.m;o.x=t*s[0]+e*s[4]+i*s[8],o.y=t*s[1]+e*s[5]+i*s[9],o.z=t*s[2]+e*s[6]+i*s[10]}static CatmullRom(t,e,i,n,o){let s=o*o,r=o*s,a=.5*(2*e.x+(-t.x+i.x)*o+(2*t.x-5*e.x+4*i.x-n.x)*s+(-t.x+3*e.x-3*i.x+n.x)*r),d=.5*(2*e.y+(-t.y+i.y)*o+(2*t.y-5*e.y+4*i.y-n.y)*s+(-t.y+3*e.y-3*i.y+n.y)*r),l=.5*(2*e.z+(-t.z+i.z)*o+(2*t.z-5*e.z+4*i.z-n.z)*s+(-t.z+3*e.z-3*i.z+n.z)*r);return new it(a,d,l)}static Clamp(t,e,i){const n=new it;return it.ClampToRef(t,e,i,n),n}static ClampToRef(t,e,i,n){let o=t.x;o=(o=o>i.x?i.x:o)<e.x?e.x:o;let s=t.y;s=(s=s>i.y?i.y:s)<e.y?e.y:s;let r=t.z;r=(r=r>i.z?i.z:r)<e.z?e.z:r,n.copyFromFloats(o,s,r)}static Hermite(t,e,i,n,o){let s=o*o,r=o*s,a=2*r-3*s+1,d=-2*r+3*s,l=r-2*s+o,h=r-s,p=t.x*a+i.x*d+e.x*l+n.x*h,c=t.y*a+i.y*d+e.y*l+n.y*h,u=t.z*a+i.z*d+e.z*l+n.z*h;return new it(p,c,u)}static Lerp(t,e,i){let n=new it(0,0,0);return it.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.x=t.x+(e.x-t.x)*i,n.y=t.y+(e.y-t.y)*i,n.z=t.z+(e.z-t.z)*i}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static Cross(t,e){let i=it.Zero();return it.CrossToRef(t,e,i),i}static CrossToRef(t,e,i){const n=t.y*e.z-t.z*e.y,o=t.z*e.x-t.x*e.z,s=t.x*e.y-t.y*e.x;i.copyFromFloats(n,o,s)}static Normalize(t){let e=it.Zero();return it.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){t.normalizeToRef(e)}static Minimize(t,e){let i=new it(t.x,t.y,t.z);return i.minimizeInPlace(e),i}static Maximize(t,e){let i=new it(t.x,t.y,t.z);return i.maximizeInPlace(e),i}static Distance(t,e){return Math.sqrt(it.DistanceSquared(t,e))}static DistanceSquared(t,e){let i=t.x-e.x,n=t.y-e.y,o=t.z-e.z;return i*i+n*n+o*o}static Center(t,e){let i=it.Add(t,e);return i.scaleInPlace(.5),i}static RotationFromAxis(t,e,i){let n=it.Zero();return it.RotationFromAxisToRef(t,e,i,n),n}static RotationFromAxisToRef(t,e,i,n){let o=nt.Quaternion[0];et.RotationQuaternionFromAxisToRef(t,e,i,o),n.copyFrom(o.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let t=this.x||0;return t=397*(t=397*t^(this.y||0))^(this.z||0)}asArray(){let t=[];return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,this}toQuaternion(){return et.Identity.setEuler(this.y,this.x,this.z)}addInPlace(t){return this.addInPlaceFromFloats(t.x,t.y,t.z)}addInPlaceFromFloats(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this}add(t){return new it(this.x+t.x,this.y+t.y,this.z+t.z)}addToRef(t,e){return e.copyFromFloats(this.x+t.x,this.y+t.y,this.z+t.z)}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subtract(t){return new it(this.x-t.x,this.y-t.y,this.z-t.z)}subtractToRef(t,e){return this.subtractFromFloatsToRef(t.x,t.y,t.z,e)}subtractFromFloats(t,e,i){return new it(this.x-t,this.y-e,this.z-i)}subtractFromFloatsToRef(t,e,i,n){return n.copyFromFloats(this.x-t,this.y-e,this.z-i)}applyMatrix4(t){this.applyMatrix4ToRef(t,this)}applyMatrix4ToRef(t,e){const{x:i,y:n,z:o}=this,{m:s}=t,r=1/(s[3]*i+s[7]*n+s[11]*o+s[15]);return e.x=(s[0]*i+s[4]*n+s[8]*o+s[12])*r,e.y=(s[1]*i+s[5]*n+s[9]*o+s[13])*r,e.z=(s[2]*i+s[6]*n+s[10]*o+s[14])*r,e}rotate(t){return this.rotateToRef(t,this)}rotateToRef(t,e){const{x:i,y:n,z:o}=this,{x:s,y:r,z:a,w:d}=t,l=d*i+r*o-a*n,h=d*n+a*i-s*o,p=d*o+s*n-r*i,c=-s*i-r*n-a*o;return e.x=l*d+c*-s+h*-a-p*-r,e.y=h*d+c*-r+p*-s-l*-a,e.z=p*d+c*-a+l*-r-h*-s,e}negate(){return new it(-this.x,-this.y,-this.z)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this}scale(t){return new it(this.x*t,this.y*t,this.z*t)}scaleToRef(t,e){return e.copyFromFloats(this.x*t,this.y*t,this.z*t)}scaleAndAddToRef(t,e){return e.addInPlaceFromFloats(this.x*t,this.y*t,this.z*t)}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z}equalsWithEpsilon(t,e=$){return t&&J.WithinEpsilon(this.x,t.x,e)&&J.WithinEpsilon(this.y,t.y,e)&&J.WithinEpsilon(this.z,t.z,e)}equalsToFloats(t,e,i){return this.x===t&&this.y===e&&this.z===i}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiply(t){return this.multiplyByFloats(t.x,t.y,t.z)}multiplyToRef(t,e){return e.copyFromFloats(this.x*t.x,this.y*t.y,this.z*t.z)}multiplyByFloats(t,e,i){return new it(this.x*t,this.y*e,this.z*i)}divide(t){return new it(this.x/t.x,this.y/t.y,this.z/t.z)}divideToRef(t,e){return e.copyFromFloats(this.x/t.x,this.y/t.y,this.z/t.z)}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.x,t.y,t.z)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.x,t.y,t.z)}minimizeInPlaceFromFloats(t,e,i){return t<this.x&&(this.x=t),e<this.y&&(this.y=e),i<this.z&&(this.z=i),this}maximizeInPlaceFromFloats(t,e,i){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),i>this.z&&(this.z=i),this}floor(){return new it(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new it(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){const t=new it(0,0,0);return this.normalizeToRef(t),t}normalizeToRef(t){let e=this.length();return 0===e||1===e?t.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/e,t)}clone(){return new it(this.x,this.y,this.z)}copyFrom(t){return this.copyFromFloats(t.x,t.y,t.z)}copyFromFloats(t,e,i){return this.x=t,this.y=e,this.z=i,this}set(t,e,i){return this.copyFromFloats(t,e,i)}setAll(t){return this.x=this.y=this.z=t,this}}const nt={Vector3:d(6,it.Zero),Matrix:d(2,tt.Identity),Quaternion:d(3,et.Zero),staticUp:it.Up(),tmpMatrix:tt.Zero()};class ot{}ot.X=new it(1,0,0),ot.Y=new it(0,1,0),ot.Z=new it(0,0,1);class st{constructor(t=0,e=0,i=0,n=1){this.r=t,this.g=e,this.b=i,this.a=n}static FromHexString(t){if("#"!==t.substring(0,1)||9!==t.length)return new st(0,0,0,0);let e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16),o=parseInt(t.substring(7,9),16);return st.FromInts(e,i,n,o)}static Lerp(t,e,i){let n=new st(0,0,0,0);return st.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.r=t.r+(e.r-t.r)*i,n.g=t.g+(e.g-t.g)*i,n.b=t.b+(e.b-t.b)*i,n.a=t.a+(e.a-t.a)*i}static Red(){return new st(1,0,0,1)}static Green(){return new st(0,1,0,1)}static Blue(){return new st(0,0,1,1)}static Black(){return new st(0,0,0,1)}static White(){return new st(1,1,1,1)}static Purple(){return new st(.5,0,.5,1)}static Magenta(){return new st(1,0,1,1)}static Yellow(){return new st(1,1,0,1)}static Gray(){return new st(.5,.5,.5,1)}static Teal(){return new st(0,1,1,1)}static Clear(){return new st(0,0,0,0)}static FromColor3(t,e=1){return new st(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new st(t[e],t[e+1],t[e+2],t[e+3])}static FromInts(t,e,i,n){return new st(t/255,e/255,i/255,n/255)}static CheckColors4(t,e){if(t.length===3*e){let e=[];for(let i=0;i<t.length;i+=3){let n=i/3*4;e[n]=t[i],e[n+1]=t[i+1],e[n+2]=t[i+2],e[n+3]=1}return e}return t}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}asArray(){let t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}add(t){return new st(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new st(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this}scale(t){return new st(this.r*t,this.g*t,this.b*t,this.a*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this}clampToRef(t=0,e=1,i){return i.r=J.Clamp(this.r,t,e),i.g=J.Clamp(this.g,t,e),i.b=J.Clamp(this.b,t,e),i.a=J.Clamp(this.a,t,e),this}multiply(t){return new st(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=this.r||0;return t=397*(t=397*(t=397*t^(this.g||0))^(this.b||0))^(this.a||0)}clone(){return new st(this.r,this.g,this.b,this.a)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}toHexString(){let t=255*this.r|0,e=255*this.g|0,i=255*this.b|0,n=255*this.a|0;return"#"+J.ToHex(t)+J.ToHex(e)+J.ToHex(i)+J.ToHex(n)}toLinearSpace(){let t=new st;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,X),t.g=Math.pow(this.g,X),t.b=Math.pow(this.b,X),t.a=this.a,this}toGammaSpace(){let t=new st;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,Y),t.g=Math.pow(this.g,Y),t.b=Math.pow(this.b,Y),t.a=this.a,this}}class rt{constructor(t=0,e=0,i=0){this.r=t,this.g=e,this.b=i}static FromHexString(t){if("#"!==t.substring(0,1)||7!==t.length)return new rt(0,0,0);let e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16);return rt.FromInts(e,i,n)}static FromArray(t,e=0){return new rt(t[e],t[e+1],t[e+2])}static FromInts(t,e,i){return new rt(t/255,e/255,i/255)}static Lerp(t,e,i){let n=new rt(0,0,0);return rt.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.r=t.r+(e.r-t.r)*i,n.g=t.g+(e.g-t.g)*i,n.b=t.b+(e.b-t.b)*i}static Red(){return new rt(1,0,0)}static Green(){return new rt(0,1,0)}static Blue(){return new rt(0,0,1)}static Black(){return new rt(0,0,0)}static White(){return new rt(1,1,1)}static Purple(){return new rt(.5,0,.5)}static Magenta(){return new rt(1,0,1)}static Yellow(){return new rt(1,1,0)}static Gray(){return new rt(.5,.5,.5)}static Teal(){return new rt(0,1,1)}static Random(){return new rt(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=this.r||0;return t=397*(t=397*t^(this.g||0))^(this.b||0)}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}toColor4(t=1){return new st(this.r,this.g,this.b,t)}asArray(){let t=new Array;return this.toArray(t,0),t}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(t){return new rt(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,i){return this.r===t&&this.g===e&&this.b===i}scale(t){return new rt(this.r*t,this.g*t,this.b*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this}clampToRef(t=0,e=1,i){return i.r=J.Clamp(this.r,t,e),i.g=J.Clamp(this.g,t,e),i.b=J.Clamp(this.b,t,e),this}add(t){return new rt(this.r+t.r,this.g+t.g,this.b+t.b)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this}subtract(t){return new rt(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this}clone(){return new rt(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,i){return this.r=t,this.g=e,this.b=i,this}set(t,e,i){return this.copyFromFloats(t,e,i)}toHexString(){let t=255*this.r|0,e=255*this.g|0,i=255*this.b|0;return"#"+J.ToHex(t)+J.ToHex(e)+J.ToHex(i)}toLinearSpace(){let t=new rt;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,X),t.g=Math.pow(this.g,X),t.b=Math.pow(this.b,X),this}toGammaSpace(){let t=new rt;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,Y),t.g=Math.pow(this.g,Y),t.b=Math.pow(this.b,Y),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}var at=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},dt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const lt={looping:!0,speed:1,weight:1};class ht extends N{constructor(t,e=lt){super(),this.isAnimationClip=!0,this.looping=lt.looping,this.weight=lt.weight,this.playing=!1,this.shouldReset=!1,this.speed=lt.speed,this.name=r("AnimClip"),this.clip=t,this.setParams(Object.assign({},e))}setParams(t){return this.looping=void 0!==t.looping?t.looping:this.looping,this.speed=t.speed||this.speed,this}toJSON(){const t=JSON.parse(JSON.stringify(super.toJSON()));return this.shouldReset&&(this.shouldReset=!1),t}play(){this.playing=!0}pause(){this.playing=!1}reset(){this.shouldReset=!0}stop(){this.reset(),this.pause()}}at([N.readonly,dt("design:type",String)],ht.prototype,"clip",void 0),at([N.field,dt("design:type",Boolean)],ht.prototype,"looping",void 0),at([N.field,dt("design:type",Number)],ht.prototype,"weight",void 0),at([N.field,dt("design:type",Boolean)],ht.prototype,"playing",void 0),at([N.field,dt("design:type",Boolean)],ht.prototype,"shouldReset",void 0),at([N.field,dt("design:type",Number)],ht.prototype,"speed",void 0),at([N.readonly,dt("design:type",String)],ht.prototype,"name",void 0);var pt,ct=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},ut=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t[t.TRANSFORM=1]="TRANSFORM",t[t.UUID_CALLBACK=8]="UUID_CALLBACK",t[t.BOX_SHAPE=16]="BOX_SHAPE",t[t.SPHERE_SHAPE=17]="SPHERE_SHAPE",t[t.PLANE_SHAPE=18]="PLANE_SHAPE",t[t.CONE_SHAPE=19]="CONE_SHAPE",t[t.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",t[t.TEXT_SHAPE=21]="TEXT_SHAPE",t[t.NFT_SHAPE=22]="NFT_SHAPE",t[t.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",t[t.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",t[t.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",t[t.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",t[t.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",t[t.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",t[t.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",t[t.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",t[t.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",t[t.BILLBOARD=32]="BILLBOARD",t[t.ANIMATION=33]="ANIMATION",t[t.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",t[t.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",t[t.GLTF_SHAPE=54]="GLTF_SHAPE",t[t.OBJ_SHAPE=55]="OBJ_SHAPE",t[t.AVATAR_SHAPE=56]="AVATAR_SHAPE",t[t.BASIC_MATERIAL=64]="BASIC_MATERIAL",t[t.PBR_MATERIAL=65]="PBR_MATERIAL",t[t.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",t[t.SOUND=67]="SOUND",t[t.TEXTURE=68]="TEXTURE",t[t.AUDIO_CLIP=200]="AUDIO_CLIP",t[t.AUDIO_SOURCE=201]="AUDIO_SOURCE",t[t.GIZMOS=203]="GIZMOS"}(pt||(pt={}));let yt=class extends N{constructor(t={}){super(),this.position=t.position||it.Zero(),this.rotation=t.rotation||et.Identity,this.scale=t.scale||new it(1,1,1)}get eulerAngles(){return this.rotation.eulerAngles}lookAt(t,e=nt.staticUp){const i=new tt;return tt.LookAtLHToRef(this.position,t,e,i),i.invert(),et.FromRotationMatrixToRef(i,this.rotation),this}rotate(t,e){return this.rotation.multiplyInPlace(this.rotation.angleAxis(e,t)),this}translate(t){return this.position.addInPlace(t),this}};ct([N.field,ut("design:type",it)],yt.prototype,"position",void 0),ct([N.field,ut("design:type",et)],yt.prototype,"rotation",void 0),ct([N.field,ut("design:type",it)],yt.prototype,"scale",void 0),yt=ct([P("engine.transform",pt.TRANSFORM),ut("design:paramtypes",[Object])],yt);let mt=class extends N{constructor(t=!0,e=!0,i=!0){super(),this.x=!0,this.y=!0,this.z=!0,this.x=t,this.y=e,this.z=i}};ct([N.field,ut("design:type",Boolean)],mt.prototype,"x",void 0),ct([N.field,ut("design:type",Boolean)],mt.prototype,"y",void 0),ct([N.field,ut("design:type",Boolean)],mt.prototype,"z",void 0),mt=ct([P("engine.billboard",pt.BILLBOARD),ut("design:paramtypes",[Boolean,Boolean,Boolean])],mt);class ft extends N{constructor(){super(...arguments),this.withCollisions=!0,this.visible=!0}}ct([N.field,ut("design:type",Boolean)],ft.prototype,"withCollisions",void 0),ct([N.field,ut("design:type",Boolean)],ft.prototype,"visible",void 0);let gt=class extends ft{};gt=ct([S("engine.shape",pt.BOX_SHAPE)],gt);let wt=class extends ft{};wt=ct([S("engine.shape",pt.SPHERE_SHAPE)],wt);let bt=class extends ft{};ct([N.field,ut("design:type",Number)],bt.prototype,"segments",void 0),ct([N.field,ut("design:type",Number)],bt.prototype,"arc",void 0),bt=ct([S("engine.shape",pt.CIRCLE_SHAPE)],bt);let vt=class extends ft{constructor(){super(...arguments),this.width=1,this.height=1}};ct([N.field,ut("design:type",Number)],vt.prototype,"width",void 0),ct([N.field,ut("design:type",Number)],vt.prototype,"height",void 0),ct([N.field,ut("design:type",Array)],vt.prototype,"uvs",void 0),vt=ct([S("engine.shape",pt.PLANE_SHAPE)],vt);let xt=class extends ft{constructor(){super(...arguments),this.radiusTop=0,this.radiusBottom=1,this.segmentsHeight=1,this.segmentsRadial=36,this.openEnded=!1,this.radius=null,this.arc=360}};ct([N.field,ut("design:type",Number)],xt.prototype,"radiusTop",void 0),ct([N.field,ut("design:type",Number)],xt.prototype,"radiusBottom",void 0),ct([N.field,ut("design:type",Number)],xt.prototype,"segmentsHeight",void 0),ct([N.field,ut("design:type",Number)],xt.prototype,"segmentsRadial",void 0),ct([N.field,ut("design:type",Boolean)],xt.prototype,"openEnded",void 0),ct([N.field,ut("design:type",Object)],xt.prototype,"radius",void 0),ct([N.field,ut("design:type",Number)],xt.prototype,"arc",void 0),xt=ct([S("engine.shape",pt.CONE_SHAPE)],xt);let Rt=class extends ft{constructor(){super(...arguments),this.radiusTop=0,this.radiusBottom=1,this.segmentsHeight=1,this.segmentsRadial=36,this.openEnded=!1,this.radius=null,this.arc=360}};ct([N.field,ut("design:type",Number)],Rt.prototype,"radiusTop",void 0),ct([N.field,ut("design:type",Number)],Rt.prototype,"radiusBottom",void 0),ct([N.field,ut("design:type",Number)],Rt.prototype,"segmentsHeight",void 0),ct([N.field,ut("design:type",Number)],Rt.prototype,"segmentsRadial",void 0),ct([N.field,ut("design:type",Boolean)],Rt.prototype,"openEnded",void 0),ct([N.field,ut("design:type",Object)],Rt.prototype,"radius",void 0),ct([N.field,ut("design:type",Number)],Rt.prototype,"arc",void 0),Rt=ct([S("engine.shape",pt.CYLINDER_SHAPE)],Rt);let Tt=class extends ft{constructor(t){super(),this.src=t}};ct([ft.readonly,ut("design:type",String)],Tt.prototype,"src",void 0),Tt=ct([S("engine.shape",pt.GLTF_SHAPE),ut("design:paramtypes",[String])],Tt);let Ct=class extends ft{constructor(t,e=new rt(.6404918,.611472,.8584906)){super(),this.src=t,this.color=e}};ct([ft.readonly,ut("design:type",String)],Ct.prototype,"src",void 0),ct([N.field,ut("design:type",rt)],Ct.prototype,"color",void 0),Ct=ct([S("engine.shape",pt.NFT_SHAPE),ut("design:paramtypes",[String,rt])],Ct);let Et=class extends N{constructor(t,e){if(super(),this.src=t,e)for(let t in e){this[t]=e[t]}}};ct([N.readonly,ut("design:type",String)],Et.prototype,"src",void 0),ct([N.readonly,ut("design:type",Number)],Et.prototype,"samplingMode",void 0),ct([N.readonly,ut("design:type",Number)],Et.prototype,"wrap",void 0),ct([N.readonly,ut("design:type",Boolean)],Et.prototype,"hasAlpha",void 0),Et=ct([S("engine.texture",pt.TEXTURE),ut("design:paramtypes",[String,Object])],Et);let At=class extends ft{constructor(){super(...arguments),this.states=[]}addClip(t){return this.states.push(t),t.onChange(()=>{this.dirty=!0}),this}getClip(t){for(let e=0;e<this.states.length;e++){const i=this.states[e];if(i.clip===t)return i}const e=new ht(t);return this.addClip(e),e}};ct([N.readonly,ut("design:type",Array)],At.prototype,"states",void 0),At=ct([P("engine.animator",pt.ANIMATION)],At);let _t=class extends ft{constructor(t){super(),this.src=t}};ct([N.readonly,ut("design:type",String)],_t.prototype,"src",void 0),_t=ct([S("engine.shape",pt.OBJ_SHAPE),ut("design:paramtypes",[String])],_t);let zt=class extends ft{constructor(t){super(),this.outlineWidth=0,this.outlineColor=new rt(1,1,1),this.color=new rt(1,1,1),this.fontSize=10,this.fontWeight="normal",this.opacity=1,this.value="",this.lineSpacing="0px",this.lineCount=0,this.resizeToFit=!1,this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=new rt(1,1,1),this.zIndex=0,this.hTextAlign="center",this.vTextAlign="center",this.width=1,this.height=1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.isPickable=!1,this.billboard=!1,t&&(this.value=t)}};var Pt;ct([N.field,ut("design:type",Number)],zt.prototype,"outlineWidth",void 0),ct([N.field,ut("design:type",rt)],zt.prototype,"outlineColor",void 0),ct([N.field,ut("design:type",rt)],zt.prototype,"color",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"fontSize",void 0),ct([N.field,ut("design:type",String)],zt.prototype,"fontWeight",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"opacity",void 0),ct([N.field,ut("design:type",String)],zt.prototype,"value",void 0),ct([N.field,ut("design:type",String)],zt.prototype,"lineSpacing",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"lineCount",void 0),ct([N.field,ut("design:type",Boolean)],zt.prototype,"resizeToFit",void 0),ct([N.field,ut("design:type",Boolean)],zt.prototype,"textWrapping",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"shadowBlur",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"shadowOffsetX",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"shadowOffsetY",void 0),ct([N.field,ut("design:type",rt)],zt.prototype,"shadowColor",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"zIndex",void 0),ct([N.field,ut("design:type",String)],zt.prototype,"hTextAlign",void 0),ct([N.field,ut("design:type",String)],zt.prototype,"vTextAlign",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"width",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"height",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"paddingTop",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"paddingRight",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"paddingBottom",void 0),ct([N.field,ut("design:type",Number)],zt.prototype,"paddingLeft",void 0),ct([N.field,ut("design:type",Boolean)],zt.prototype,"isPickable",void 0),ct([N.field,ut("design:type",Boolean)],zt.prototype,"billboard",void 0),zt=ct([P("engine.text",pt.TEXT_SHAPE),ut("design:paramtypes",[String])],zt),function(t){t[t.OPAQUE=0]="OPAQUE",t[t.ALPHA_TEST=1]="ALPHA_TEST",t[t.ALPHA_BLEND=2]="ALPHA_BLEND",t[t.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",t[t.AUTO=4]="AUTO"}(Pt||(Pt={}));let St=class extends N{constructor(){super(...arguments),this.alphaTest=.5,this.transparencyMode=Pt.AUTO}};ct([N.field,ut("design:type",Number)],St.prototype,"alphaTest",void 0),ct([N.field,ut("design:type",Object)],St.prototype,"albedoColor",void 0),ct([N.field,ut("design:type",rt)],St.prototype,"emissiveColor",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"metallic",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"roughness",void 0),ct([N.field,ut("design:type",rt)],St.prototype,"ambientColor",void 0),ct([N.field,ut("design:type",rt)],St.prototype,"reflectionColor",void 0),ct([N.field,ut("design:type",rt)],St.prototype,"reflectivityColor",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"directIntensity",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"microSurface",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"emissiveIntensity",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"environmentIntensity",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"specularIntensity",void 0),ct([N.component,ut("design:type",Et)],St.prototype,"albedoTexture",void 0),ct([N.component,ut("design:type",Et)],St.prototype,"alphaTexture",void 0),ct([N.component,ut("design:type",Et)],St.prototype,"emissiveTexture",void 0),ct([N.component,ut("design:type",Et)],St.prototype,"bumpTexture",void 0),ct([N.component,ut("design:type",Et)],St.prototype,"refractionTexture",void 0),ct([N.field,ut("design:type",Boolean)],St.prototype,"disableLighting",void 0),ct([N.field,ut("design:type",Number)],St.prototype,"transparencyMode",void 0),St=ct([S("engine.material",pt.PBR_MATERIAL)],St);let Ot=class extends N{constructor(){super(...arguments),this.alphaTest=.5}};ct([N.component,ut("design:type",Et)],Ot.prototype,"texture",void 0),ct([N.field,ut("design:type",Number)],Ot.prototype,"alphaTest",void 0),Ot=ct([S("engine.material",pt.BASIC_MATERIAL)],Ot);class It extends N{constructor(t){if(super(),this.uuid=r("UUID"),!(t&&"apply"in t&&"call"in t))throw new Error("Callback is not a function");this.callback=t}static uuidEvent(t,e){if(delete t[e]){const i=e+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(t,i)),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[i]},set:function(t){const n=this[i];if(t){if(!(t instanceof It))throw new Error("value is not an OnUUIDEvent");this.data[e]=t.uuid}else this.data[e]=null;if(this[i]=t,t!==n){this.dirty=!0;for(let i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})}}toJSON(){return{uuid:this.uuid,type:this.type}}}ct([N.field,ut("design:type",Function)],It.prototype,"callback",void 0);let Ft=class extends It{constructor(){super(...arguments),this.type="onPointerLock"}};ct([N.readonly,ut("design:type",String)],Ft.prototype,"type",void 0),Ft=ct([P("engine.onPointerLock",pt.UUID_CALLBACK)],Ft);let Nt=class extends It{constructor(){super(...arguments),this.type="onAnimationEnd"}};var Mt;ct([N.readonly,ut("design:type",String)],Nt.prototype,"type",void 0),Nt=ct([P("engine.onAnimationEnd",pt.UUID_CALLBACK)],Nt),function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP"}(Mt||(Mt={}));var Lt,Ut=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};!function(t){t.POINTER="POINTER",t.PRIMARY="PRIMARY",t.SECONDARY="SECONDARY"}(Lt||(Lt={}));class jt{constructor(t){if(this.callback=t,!(t&&"apply"in t&&"call"in t))throw new Error("Callback is not a function");kt.ensureInstance()}}let Bt=class extends jt{};Bt=Ut([P("pointerDown")],Bt);let Ht=class extends jt{};Ht=Ut([P("pointerUp")],Ht);class Dt{constructor(t,e){this.fn=t,this.useRaycast=e}}class kt{constructor(){this.subscriptions={[Lt.POINTER]:{BUTTON_DOWN:[],BUTTON_UP:[]},[Lt.PRIMARY]:{BUTTON_DOWN:[],BUTTON_UP:[]},[Lt.SECONDARY]:{BUTTON_DOWN:[],BUTTON_UP:[]}},this.internalState={[Lt.POINTER]:{BUTTON_DOWN:!1},[Lt.PRIMARY]:{BUTTON_DOWN:!1},[Lt.SECONDARY]:{BUTTON_DOWN:!1}}}static get instance(){return kt.ensureInstance(),kt._instance}static ensureInstance(){kt._instance||(kt._instance=new kt)}isButtonPressed(t){return this.internalState[t]}subscribe(t,e,i,n){return this.subscriptions[e][t].push(new Dt(n,i)),()=>this.unsubscribe(t,e,n)}unsubscribe(t,e,i){const n=this.getSubscriptionId(t,e,i);return n>-1&&this.subscriptions[e][t].splice(n,1)}handlePointerEvent(t){const e=this.getPointerById(t.buttonId);let i=Object.assign(Object.assign({},t),{button:e,direction:(new it).copyFrom(t.direction),origin:(new it).copyFrom(t.origin),hit:void 0});const n=t.hit?Object.assign(Object.assign({},t.hit),{hitPoint:(new it).copyFrom(t.hit.hitPoint),normal:(new it).copyFrom(t.hit.normal),worldNormal:(new it).copyFrom(t.hit.worldNormal)}):void 0;if(t.type===Mt.DOWN){this.internalState[e].BUTTON_DOWN=!0;for(let t=0;t<this.subscriptions[e].BUTTON_DOWN.length;t++){let o=this.subscriptions[e].BUTTON_DOWN[t];o.useRaycast?i.hit=n:i.hit=void 0,o.fn(i)}if(n&&n.entityId&&S.engine){const t=S.engine.entities[n.entityId],e=t&&t.getComponentOrNull(Bt);e&&(i.hit=n,e.callback(i))}}else{this.internalState[e].BUTTON_DOWN=!1;for(let t=0;t<this.subscriptions[e].BUTTON_UP.length;t++){let o=this.subscriptions[e].BUTTON_UP[t];o.useRaycast?i.hit=n:i.hit=void 0,o.fn(i)}if(n&&n.entityId&&S.engine){const t=S.engine.entities[n.entityId],e=t&&t.getComponentOrNull(Ht);e&&(i.hit=n,e.callback(i))}}}getSubscriptionId(t,e,i){for(let n=0;n<this.subscriptions[e][t].length;n++)if(this.subscriptions[e][t][n].fn===i)return n;return-1}getPointerById(t){return 0===t?Lt.POINTER:1===t?Lt.PRIMARY:Lt.SECONDARY}}class Gt{constructor(){this.position=new it,this.rotation=new et,this.feetPosition=new it,this.worldPosition=new it,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.onEvent(t=>{switch(t.type){case"positionChanged":this.positionChanged(t.data);break;case"rotationChanged":this.rotationChanged(t.data)}})),Object.defineProperty(this.position,"x",{get:()=>this.lastEventPosition.x}),Object.defineProperty(this.position,"y",{get:()=>this.lastEventPosition.y}),Object.defineProperty(this.position,"z",{get:()=>this.lastEventPosition.z}),Object.defineProperty(this.worldPosition,"x",{get:()=>this.lastEventWorldPosition.x}),Object.defineProperty(this.worldPosition,"y",{get:()=>this.lastEventWorldPosition.y}),Object.defineProperty(this.worldPosition,"z",{get:()=>this.lastEventWorldPosition.z}),Object.defineProperty(this.feetPosition,"x",{get:()=>this.lastEventPosition.x}),Object.defineProperty(this.feetPosition,"y",{get:()=>this.lastEventPosition.y-this.playerHeight}),Object.defineProperty(this.feetPosition,"z",{get:()=>this.lastEventPosition.z}),Object.defineProperty(this.rotation,"x",{get:()=>this.lastEventRotation.x}),Object.defineProperty(this.rotation,"y",{get:()=>this.lastEventRotation.y}),Object.defineProperty(this.rotation,"z",{get:()=>this.lastEventRotation.z}),Object.defineProperty(this.rotation,"w",{get:()=>this.lastEventRotation.w})}static get instance(){return Gt._instance||(Gt._instance=new Gt),Gt._instance}get playerHeight(){return this._playerHeight}positionChanged(t){this.lastEventPosition=t.position,this.lastEventWorldPosition=t.cameraPosition,this._playerHeight=t.playerHeight}rotationChanged(t){this.lastEventRotation=t.quaternion}}class Wt{constructor(){this.queries={}}static get instance(){return Wt.ensureInstance(),Wt._instance}static ensureInstance(){Wt._instance||(Wt._instance=new Wt)}getRayFromCamera(t){let e=Gt.instance.rotation,i=tt.Identity();e.toRotationMatrix(i);let n=it.TransformCoordinates(it.Forward(),i);return{origin:Gt.instance.position,direction:n,distance:t}}getRayFromPositions(t,e){const i=e.subtract(t),n=i.length();return{origin:t,direction:i.normalize(),distance:n}}hitFirst(t,e){const i=a();this.queries[i]=e,dcl&&dcl.query("raycast",{queryId:i,queryType:"HitFirst",ray:t})}hitAll(t,e){const i=a();this.queries[i]=e,dcl&&dcl.query("raycast",{queryId:i,queryType:"HitAll",ray:t})}hitFirstAvatar(t,e){o("not implemented yet")}hitAllAvatars(t,e){o("not implemented yet")}handleRaycastHitFirstResponse(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]}handleRaycastHitAllResponse(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]}}const qt=new class{activate(t){t.eventManager.addListener(D,this,t=>{"HitFirst"===t.payload.queryType?Wt.instance.handleRaycastHitFirstResponse(t):"HitAll"===t.payload.queryType&&Wt.instance.handleRaycastHitAllResponse(t)}),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")}deactivate(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")}};const Vt=new class{activate(t){t.eventManager.addListener(k,this,t=>{kt.instance.handlePointerEvent(t.payload)}),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("pointerEvent"))}deactivate(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("pointerEvent"))}};const Yt=new class{constructor(){this.handlerMap={}}activate(t){t.eventManager.addListener(H,this,this.handleEvent),t.eventManager.addListener(g,this,this.componentAdded),t.eventManager.addListener(f,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")}deactivate(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")}onAddEntity(t){for(let e in t.components){const i=t.components[e];i instanceof It&&(this.handlerMap[i.uuid]=i)}}onRemoveEntity(t){for(let e in t.components){const i=t.components[e];i instanceof It&&delete this.handlerMap[i.uuid]}}componentAdded(t){if(t.entity.isAddedToEngine()){const e=t.entity.components[t.componentName];e instanceof It&&(this.handlerMap[e.uuid]=e)}}componentRemoved(t){t.entity.isAddedToEngine()&&t.component instanceof It&&delete this.handlerMap[t.component.uuid]}handleEvent(t){if(t.uuid in this.handlerMap){const e=this.handlerMap[t.uuid];e&&e.callback&&"call"in e.callback&&e.callback(t.payload)}}};var Xt=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},$t=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Zt=class extends N{constructor(t){super(),this.loop=!1,this.volume=1,this.url=t}};Xt([N.readonly,$t("design:type",String)],Zt.prototype,"url",void 0),Xt([N.field,$t("design:type",Boolean)],Zt.prototype,"loop",void 0),Xt([N.field,$t("design:type",String)],Zt.prototype,"loadingCompleteEventId",void 0),Xt([N.field,$t("design:type",Number)],Zt.prototype,"volume",void 0),Zt=Xt([S("engine.AudioClip",pt.AUDIO_CLIP),$t("design:paramtypes",[String])],Zt);let Kt=class extends N{constructor(t){if(super(),this.audioClip=t,this.loop=!1,this.volume=1,this.playing=!1,this.pitch=1,!(t instanceof Zt))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");this.audioClipId=F(t)}playOnce(){return this.playing=!0,this.dirty=!0,this.data.nonce=Math.random(),this}};Xt([N.readonly,$t("design:type",String)],Kt.prototype,"audioClipId",void 0),Xt([N.field,$t("design:type",Boolean)],Kt.prototype,"loop",void 0),Xt([N.field,$t("design:type",Number)],Kt.prototype,"volume",void 0),Xt([N.field,$t("design:type",Boolean)],Kt.prototype,"playing",void 0),Xt([N.field,$t("design:type",Number)],Kt.prototype,"pitch",void 0),Kt=Xt([P("engine.AudioSource",pt.AUDIO_SOURCE),$t("design:paramtypes",[Zt])],Kt);var Jt,Qt=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},te=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t.MOVE="MOVE",t.ROTATE="ROTATE",t.SCALE="SCALE",t.NONE="NONE"}(Jt||(Jt={}));let ee=class extends It{constructor(){super(...arguments),this.type="gizmoEvent"}};Qt([N.readonly,te("design:type",String)],ee.prototype,"type",void 0),ee=Qt([P("engine.gizmoEvent",pt.UUID_CALLBACK)],ee);let ie=class extends N{constructor(){super(...arguments),this.position=!0,this.rotation=!0,this.scale=!0,this.cycle=!0,this.localReference=!1}};Qt([N.field,te("design:type",Boolean)],ie.prototype,"position",void 0),Qt([N.field,te("design:type",Boolean)],ie.prototype,"rotation",void 0),Qt([N.field,te("design:type",Boolean)],ie.prototype,"scale",void 0),Qt([N.field,te("design:type",Boolean)],ie.prototype,"cycle",void 0),Qt([N.field,te("design:type",String)],ie.prototype,"selectedGizmo",void 0),Qt([N.field,te("design:type",Boolean)],ie.prototype,"localReference",void 0),ie=Qt([P("engine.gizmos",pt.GIZMOS)],ie);var ne=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},oe=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class se extends N{constructor(t){super(),this.name=null,this.visible=!0,this.opacity=1,this.hAlign="center",this.vAlign="center",this.width="100px",this.height="50px",this.positionX="0px",this.positionY="0px",this.isPointerBlocker=!0,t&&(this._parent=t,this.data.parentComponent=F(t))}get parent(){return this._parent}get parentComponent(){return this.data.parentComponent}}ne([N.field,oe("design:type",Object)],se.prototype,"name",void 0),ne([N.field,oe("design:type",Boolean)],se.prototype,"visible",void 0),ne([N.field,oe("design:type",Number)],se.prototype,"opacity",void 0),ne([N.field,oe("design:type",String)],se.prototype,"hAlign",void 0),ne([N.field,oe("design:type",String)],se.prototype,"vAlign",void 0),ne([N.uiValue,oe("design:type",Object)],se.prototype,"width",void 0),ne([N.uiValue,oe("design:type",Object)],se.prototype,"height",void 0),ne([N.uiValue,oe("design:type",Object)],se.prototype,"positionX",void 0),ne([N.uiValue,oe("design:type",Object)],se.prototype,"positionY",void 0),ne([N.field,oe("design:type",Boolean)],se.prototype,"isPointerBlocker",void 0);let re=class extends se{constructor(){super(null)}};re=ne([S("engine.shape",pt.UI_FULLSCREEN_SHAPE),oe("design:paramtypes",[])],re);let ae=class extends se{constructor(){super(null)}};ae=ne([S("engine.shape",pt.UI_WORLD_SPACE_SHAPE),oe("design:paramtypes",[])],ae);let de=class extends se{constructor(){super(null)}};de=ne([S("engine.shape",pt.UI_SCREEN_SPACE_SHAPE),oe("design:paramtypes",[])],de);let le=class extends se{constructor(){super(...arguments),this.adaptWidth=!1,this.adaptHeight=!1,this.thickness=0,this.color=st.Clear(),this.alignmentUsesSize=!0}};var he;ne([N.field,oe("design:type",Boolean)],le.prototype,"adaptWidth",void 0),ne([N.field,oe("design:type",Boolean)],le.prototype,"adaptHeight",void 0),ne([N.field,oe("design:type",Number)],le.prototype,"thickness",void 0),ne([N.field,oe("design:type",st)],le.prototype,"color",void 0),ne([N.field,oe("design:type",Boolean)],le.prototype,"alignmentUsesSize",void 0),le=ne([S("engine.shape",pt.UI_CONTAINER_RECT)],le),function(t){t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL"}(he||(he={}));let pe=class extends se{constructor(){super(...arguments),this.adaptWidth=!0,this.adaptHeight=!0,this.color=st.Clear(),this.stackOrientation=he.VERTICAL,this.spacing=0}};ne([N.field,oe("design:type",Boolean)],pe.prototype,"adaptWidth",void 0),ne([N.field,oe("design:type",Boolean)],pe.prototype,"adaptHeight",void 0),ne([N.field,oe("design:type",st)],pe.prototype,"color",void 0),ne([N.field,oe("design:type",Number)],pe.prototype,"stackOrientation",void 0),ne([N.field,oe("design:type",Number)],pe.prototype,"spacing",void 0),pe=ne([S("engine.shape",pt.UI_CONTAINER_STACK)],pe);let ce=class extends se{constructor(){super(...arguments),this.fontSize=10,this.fontWeight="normal",this.thickness=0,this.cornerRadius=0,this.color=st.White(),this.background=st.White(),this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=st.Black(),this.text="button"}};ne([N.field,oe("design:type",Number)],ce.prototype,"fontSize",void 0),ne([N.field,oe("design:type",String)],ce.prototype,"fontWeight",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"thickness",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"cornerRadius",void 0),ne([N.field,oe("design:type",st)],ce.prototype,"color",void 0),ne([N.field,oe("design:type",st)],ce.prototype,"background",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"paddingTop",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"paddingRight",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"paddingBottom",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"paddingLeft",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"shadowBlur",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"shadowOffsetX",void 0),ne([N.field,oe("design:type",Number)],ce.prototype,"shadowOffsetY",void 0),ne([N.field,oe("design:type",st)],ce.prototype,"shadowColor",void 0),ne([N.field,oe("design:type",String)],ce.prototype,"text",void 0),ce=ne([S("engine.shape",pt.UI_BUTTON_SHAPE)],ce);let ue=class extends se{constructor(){super(...arguments),this.outlineWidth=0,this.outlineColor=st.White(),this.color=st.White(),this.fontSize=10,this.fontAutoSize=!1,this.fontWeight="normal",this.value="",this.lineSpacing=0,this.lineCount=0,this.adaptWidth=!1,this.adaptHeight=!1,this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=st.Black(),this.hTextAlign="left",this.vTextAlign="bottom",this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0}};ne([N.field,oe("design:type",Number)],ue.prototype,"outlineWidth",void 0),ne([N.field,oe("design:type",st)],ue.prototype,"outlineColor",void 0),ne([N.field,oe("design:type",st)],ue.prototype,"color",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"fontSize",void 0),ne([N.field,oe("design:type",Boolean)],ue.prototype,"fontAutoSize",void 0),ne([N.field,oe("design:type",String)],ue.prototype,"fontWeight",void 0),ne([N.field,oe("design:type",String)],ue.prototype,"value",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"lineSpacing",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"lineCount",void 0),ne([N.field,oe("design:type",Boolean)],ue.prototype,"adaptWidth",void 0),ne([N.field,oe("design:type",Boolean)],ue.prototype,"adaptHeight",void 0),ne([N.field,oe("design:type",Boolean)],ue.prototype,"textWrapping",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"shadowBlur",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"shadowOffsetX",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"shadowOffsetY",void 0),ne([N.field,oe("design:type",st)],ue.prototype,"shadowColor",void 0),ne([N.field,oe("design:type",String)],ue.prototype,"hTextAlign",void 0),ne([N.field,oe("design:type",String)],ue.prototype,"vTextAlign",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"paddingTop",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"paddingRight",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"paddingBottom",void 0),ne([N.field,oe("design:type",Number)],ue.prototype,"paddingLeft",void 0),ue=ne([S("engine.shape",pt.UI_TEXT_SHAPE)],ue);let ye=class extends se{constructor(){super(...arguments),this.outlineWidth=0,this.outlineColor=st.Black(),this.color=st.Clear(),this.thickness=1,this.fontSize=10,this.fontWeight="normal",this.value="",this.placeholderColor=st.White(),this.placeholder="",this.margin=10,this.maxWidth=100,this.hTextAlign="left",this.vTextAlign="bottom",this.autoStretchWidth=!0,this.background=st.Black(),this.focusedBackground=st.Black(),this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=st.White(),this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.onTextSubmit=null,this.onChanged=null,this.onFocus=null,this.onBlur=null}};ne([N.field,oe("design:type",Number)],ye.prototype,"outlineWidth",void 0),ne([N.field,oe("design:type",st)],ye.prototype,"outlineColor",void 0),ne([N.field,oe("design:type",st)],ye.prototype,"color",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"thickness",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"fontSize",void 0),ne([N.field,oe("design:type",String)],ye.prototype,"fontWeight",void 0),ne([N.field,oe("design:type",String)],ye.prototype,"value",void 0),ne([N.field,oe("design:type",st)],ye.prototype,"placeholderColor",void 0),ne([N.field,oe("design:type",String)],ye.prototype,"placeholder",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"margin",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"maxWidth",void 0),ne([N.field,oe("design:type",String)],ye.prototype,"hTextAlign",void 0),ne([N.field,oe("design:type",String)],ye.prototype,"vTextAlign",void 0),ne([N.field,oe("design:type",Boolean)],ye.prototype,"autoStretchWidth",void 0),ne([N.field,oe("design:type",st)],ye.prototype,"background",void 0),ne([N.field,oe("design:type",st)],ye.prototype,"focusedBackground",void 0),ne([N.field,oe("design:type",Boolean)],ye.prototype,"textWrapping",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"shadowBlur",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"shadowOffsetX",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"shadowOffsetY",void 0),ne([N.field,oe("design:type",st)],ye.prototype,"shadowColor",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"paddingTop",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"paddingRight",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"paddingBottom",void 0),ne([N.field,oe("design:type",Number)],ye.prototype,"paddingLeft",void 0),ne([It.uuidEvent,oe("design:type",Object)],ye.prototype,"onTextSubmit",void 0),ne([It.uuidEvent,oe("design:type",Object)],ye.prototype,"onChanged",void 0),ne([It.uuidEvent,oe("design:type",Object)],ye.prototype,"onFocus",void 0),ne([It.uuidEvent,oe("design:type",Object)],ye.prototype,"onBlur",void 0),ye=ne([S("engine.shape",pt.UI_INPUT_TEXT_SHAPE)],ye);let me=class extends se{constructor(t,e){super(t),this.sourceLeft=0,this.sourceTop=0,this.sourceWidth=1,this.sourceHeight=1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.sizeInPixels=!0,this.onClick=null,this.source=e}};ne([N.field,oe("design:type",Number)],me.prototype,"sourceLeft",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"sourceTop",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"sourceWidth",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"sourceHeight",void 0),ne([N.component,oe("design:type",Et)],me.prototype,"source",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"paddingTop",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"paddingRight",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"paddingBottom",void 0),ne([N.field,oe("design:type",Number)],me.prototype,"paddingLeft",void 0),ne([N.field,oe("design:type",Boolean)],me.prototype,"sizeInPixels",void 0),ne([It.uuidEvent,oe("design:type",Object)],me.prototype,"onClick",void 0),me=ne([S("engine.shape",pt.UI_IMAGE_SHAPE),oe("design:paramtypes",[se,Et])],me);let fe=class extends se{constructor(){super(...arguments),this.valueX=0,this.valueY=0,this.borderColor=st.White(),this.backgroundColor=st.Clear(),this.isHorizontal=!1,this.isVertical=!1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.onChanged=null}};ne([N.field,oe("design:type",Number)],fe.prototype,"valueX",void 0),ne([N.field,oe("design:type",Number)],fe.prototype,"valueY",void 0),ne([N.field,oe("design:type",st)],fe.prototype,"borderColor",void 0),ne([N.field,oe("design:type",st)],fe.prototype,"backgroundColor",void 0),ne([N.field,oe("design:type",Boolean)],fe.prototype,"isHorizontal",void 0),ne([N.field,oe("design:type",Boolean)],fe.prototype,"isVertical",void 0),ne([N.field,oe("design:type",Number)],fe.prototype,"paddingTop",void 0),ne([N.field,oe("design:type",Number)],fe.prototype,"paddingRight",void 0),ne([N.field,oe("design:type",Number)],fe.prototype,"paddingBottom",void 0),ne([N.field,oe("design:type",Number)],fe.prototype,"paddingLeft",void 0),ne([It.uuidEvent,oe("design:type",Object)],fe.prototype,"onChanged",void 0),fe=ne([S("engine.shape",pt.UI_SLIDER_SHAPE)],fe);var ge,we=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},be=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ve=ge=class extends N{constructor(){super(...arguments),this.useDummyModel=!1}static Dummy(){const t=new ge;return t.useDummyModel=!0,t}};we([N.field,be("design:type",String)],ve.prototype,"id",void 0),we([N.field,be("design:type",String)],ve.prototype,"name",void 0),we([N.field,be("design:type",String)],ve.prototype,"bodyShape",void 0),we([N.field,be("design:type",Array)],ve.prototype,"wearables",void 0),we([N.field,be("design:type",Object)],ve.prototype,"skinColor",void 0),we([N.field,be("design:type",Object)],ve.prototype,"hairColor",void 0),we([N.field,be("design:type",Object)],ve.prototype,"eyeColor",void 0),we([N.field,be("design:type",Boolean)],ve.prototype,"useDummyModel",void 0),ve=ge=we([P("engine.avatarShape",pt.AVATAR_SHAPE)],ve);var xe=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},Re=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Te=class extends It{constructor(t){super(t),this.type="onFocus",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],Te.prototype,"type",void 0),Te=xe([P("engine.onFocus",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],Te);let Ce=class extends It{constructor(t){super(t),this.type="onTextSubmit",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],Ce.prototype,"type",void 0),Ce=xe([P("engine.onTextSubmit",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],Ce);let Ee=class extends It{constructor(t){super(t),this.type="onBlur",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],Ee.prototype,"type",void 0),Ee=xe([P("engine.onBlur",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],Ee);let Ae=class extends It{constructor(t){super(t),this.type="onClick",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],Ae.prototype,"type",void 0),Ae=xe([P("engine.onClick",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],Ae);let _e=class extends It{constructor(t){super(t),this.type="onEnter",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],_e.prototype,"type",void 0),_e=xe([P("engine.onEnter",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],_e);let ze=class extends It{constructor(t){super(t),this.type="onChange",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],ze.prototype,"type",void 0),ze=xe([P("engine.onChange",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],ze);let Pe=class extends It{constructor(t){super(t),this.type="pointerDown",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],Pe.prototype,"type",void 0),Pe=xe([P("engine.pointerDown",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],Pe);let Se=class extends It{constructor(t){super(t),this.type="pointerUp",Yt.handlerMap[this.uuid]=this}};xe([N.readonly,Re("design:type",String)],Se.prototype,"type",void 0),Se=xe([P("engine.pointerUp",pt.UUID_CALLBACK),Re("design:paramtypes",[Function])],Se);i.d(e,"G",(function(){return Ie})),i.d(e,"k",(function(){return P})),i.d(e,"l",(function(){return U})),i.d(e,"H",(function(){return o})),i.d(e,"A",(function(){return yt})),i.d(e,"f",(function(){return mt})),i.d(e,"g",(function(){return gt})),i.d(e,"v",(function(){return vt})),i.d(e,"m",(function(){return Tt})),i.d(e,"q",(function(){return Ct})),i.d(e,"z",(function(){return Et})),i.d(e,"c",(function(){return At})),i.d(e,"r",(function(){return _t})),i.d(e,"y",(function(){return zt})),i.d(e,"p",(function(){return St})),i.d(e,"h",(function(){return Gt})),i.d(e,"i",(function(){return rt})),i.d(e,"j",(function(){return st})),i.d(e,"w",(function(){return et})),i.d(e,"x",(function(){return J})),i.d(e,"F",(function(){return it})),i.d(e,"b",(function(){return ht})),i.d(e,"a",(function(){return Lt})),i.d(e,"o",(function(){return kt})),i.d(e,"d",(function(){return Zt})),i.d(e,"e",(function(){return Kt})),i.d(e,"t",(function(){return ee})),i.d(e,"n",(function(){return ie})),i.d(e,"B",(function(){return de})),i.d(e,"C",(function(){return le})),i.d(e,"E",(function(){return ue})),i.d(e,"D",(function(){return me})),i.d(e,"s",(function(){return Ae})),i.d(e,"u",(function(){return Pe}));const Oe=new U("scene");Oe.uuid="0";const Ie=new class{constructor(t){this.eventManager=new c,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(g,this,this.componentAddedHandler),this.eventManager.addListener(f,this,this.componentRemovedHandler),this.rootEntity=t}get entities(){return this._entities}get disposableComponents(){return this._disposableComponents}addEntity(t){const e=t.getParent();if(t.isAddedToEngine())return t;t.eventManager=this.eventManager,t.engine=this,this._entities[t.uuid]=t,this.checkRequirementsAndAdd(t),e?e.isAddedToEngine()||e===this.rootEntity||o("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+e.uuid):t.setParent(this.rootEntity),t.alive=!0;for(let e in t.children){const i=t.children[e];i&&(i.isAddedToEngine()||this.addEntity(i))}return t}removeEntity(t){const e=t.uuid;if(t.isAddedToEngine()){for(let i in t.components){const n=this._componentGroups[i];if(n)for(let e in n)n[e].removeEntity(t);delete this.entityLists[i][e]}for(let e=0;e<this.simpleSystems.length;e++){const i=this.simpleSystems[e];i.onRemoveEntity&&i.onRemoveEntity(t)}for(let e in t.children){const i=t.children[e];i&&this.removeEntity(i)}return t.alive=!1,t.eventManager=null,delete this._entities[e],!0}o("Engine: Trying to remove non existent entity from engine."),t.isAddedToEngine()?o("Engine: Entity id: "+e):o(`Engine: Entity "${t.uuid}" has not been added to any engine yet.`),o("Engine: Entity's components:");for(let e in t.components)o(e);return!1}addSystem(t,e=0){if(-1!==this.addedSystems.indexOf(t))return o("Engine: Trying to add a system that is already added. Aborting"),t;if(this.systems.length>0)for(let i=0;i<this.systems.length;i++){const n=this.systems[i],o=i===this.systems.length-1;if(n.priority>e){this.addedSystems.push(t),this.systems.splice(i,0,{system:t,priority:e});break}if(o){this.addedSystems.push(t),this.systems.splice(i+1,0,{system:t,priority:e});break}}else this.addedSystems.push(t),this.systems.splice(1,0,{system:t,priority:e});return this.registerSystem(t),t}removeSystem(t){const e=this.addedSystems.indexOf(t);if(-1!==e){t.active=!1,t.deactivate&&t.deactivate(),this.addedSystems.splice(e,1);for(let e=0;e<this.systems.length;e++){this.systems[e].system===t&&this.systems.splice(e,1)}return!0}return!1}update(t){for(let e in this.systems){const i=this.systems[e].system;if(i.active&&i.update)try{i.update(t)}catch(t){s(t)}}return this}getEntitiesWithComponent(t){const e="string"==typeof t?t:O(t);return e in this.entityLists?this.entityLists[e]:this.entityLists[e]={}}registerComponent(t){const e=F(t),i=O(t),n=I(t);this._disposableComponents[e]=t,null!==n&&(this.eventManager.fireEvent(new A(e,i,n)),this.eventManager.fireEvent(new z(e,t)))}disposeComponent(t){const e=F(t);return delete this._disposableComponents[e]&&(this.eventManager.fireEvent(new _(e)),t.onDispose&&t.onDispose(),!0)}updateComponent(t){this.eventManager.fireEvent(new z(F(t),t))}getComponentGroup(...t){const e=new L(...t);e.active=!0;const i=e.requiresNames;for(let t=0;t<i.length;t++){const n=i[t];let o=this._componentGroups[n];o||(this._componentGroups[n]=o=[]),-1===o.indexOf(e)&&o.push(e)}for(let t in this._entities)this.checkRequirements(this._entities[t],e);return e}removeComponentGroup(t){if(t.active){t.active=!1;const e=t.requiresNames;for(let i=0;i<e.length;i++){const n=e[i];let o=this._componentGroups[n];if(o){const e=o.indexOf(t);-1!==e&&o.splice(e,1)}}return!0}return!1}registerSystem(t){t.active=!0,t.activate&&t.activate(this),this.simpleSystems.push(t)}checkRequirementsAndAdd(t){if(t.isAddedToEngine()){for(let e in t.components){e in this.entityLists||(this.entityLists[e]={}),this.entityLists[e][t.uuid]=t;const i=this._componentGroups[e];if(i)for(let e in i)this.checkRequirements(t,i[e])}for(let e=0;e<this.simpleSystems.length;e++){const i=this.simpleSystems[e];i.onAddEntity&&i.onAddEntity(t)}}}checkRequirements(t,e){e.meetsRequirements(t)?e.hasEntity(t)||e.addEntity(t):e.hasEntity(t)&&e.removeEntity(t)}componentAddedHandler(t){const{entity:e,componentName:i}=t;if(!e.isAddedToEngine())return;this.entityLists[i]?this.entityLists[i][e.uuid]=e:this.entityLists[i]={[e.uuid]:e};const n=this._componentGroups[i];if(n)for(let t in n)this.checkRequirements(e,n[t])}componentRemovedHandler(t){const{entity:e,componentName:i}=t;if(!e.isAddedToEngine())return;delete this.entityLists[i][e.uuid];const n=this._componentGroups[i];if(n)for(let t in n)this.checkRequirements(e,n[t])}}(Oe);S.engine=Ie,"undefined"!=typeof dcl&&Ie.addSystem(new W(dcl),1/0),Ie.addSystem(Yt),Ie.addSystem(Vt),Ie.addSystem(qt)},24:function(t,e,i){"use strict";i.r(e);var n=i(0);let o=[.25,20,.25,.25,.25,.25,.25,.25,.25],s=15,r=.005*s,a=null;function d(t){a=t}let l=new n.F(16,.01,40),h=new n.F(48,.01,32),p=new n.F(48,.01,48),c=new n.z("images/YouWin.png"),u=new n.z("images/cold-thermometer.png"),y=new n.p;y.alphaTexture=y.albedoTexture=u;let m=new n.z("images/hot-thermometer.png"),f=new n.p;f.alphaTexture=f.albedoTexture=m;let g=new n.z("images/thermometer.png"),w=new n.p;w.alphaTexture=w.albedoTexture=g;let b=new n.z("images/Chipaicon.png"),v=new n.p;v.alphaTexture=v.albedoTexture=b;let x=new n.p;x.albedoColor=n.i.Red();let R=new n.p;R.albedoColor=n.i.Blue();let T=new n.p;T.albedoColor=n.i.Gray(),(new n.p).albedoColor=n.i.Red(),(new n.p).albedoColor=n.i.Yellow();let C,E,A=new n.p;A.albedoColor=n.i.Green();let _=!1;function z(t){_=t}var P,S=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},O=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t[t.speed=0]="speed",t[t.temperature=1]="temperature",t[t.ears=2]="ears",t[t.eyes=3]="eyes",t[t.feet=4]="feet",t[t.mouth=5]="mouth",t[t.nose=6]="nose",t[t.tail=7]="tail",t[t.wings=8]="wings",t[t.COUNT=9]="COUNT"}(P||(P={}));let I=class{constructor(t){this.genes=t}CopyFrom(t){for(var e=0;e<this.genes.length;e++){if(e==t.genes.length)return;this.genes[e]=t.genes[e]}}Mutate(){for(var t=0;t<this.genes.length;t++)Math.random()<.7&&(this.genes[t]+=(Math.random()-.5)*o[t],this.genes[t]=+this.genes[t].toFixed(2))}};I=S([Object(n.k)("genome"),O("design:paramtypes",[Array])],I);var F=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},N=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let M=new n.v,L=class{constructor(t){this.value=0,this.fullLength=1,this.entity=t,this.foregroundEntity=new n.l,this.foregroundEntity.addComponent(M),this.foregroundEntity.setParent(t),this.foregroundTransform=new n.A({scale:new n.F(1,.15,.1)}),this.foregroundEntity.addComponent(this.foregroundTransform),this.foregroundEntity.addComponentOrReplace(A)}UpdateNormalizedValue(t){this.value=Math.min(1,Math.max(0,t));let e=n.x.Lerp(0,this.fullLength,this.value);this.foregroundTransform.scale.x=e,this.foregroundTransform.position.x=-this.fullLength/2+e/2}};L=F([Object(n.k)("progressBar"),N("design:paramtypes",[Object])],L);var U=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let j=class{constructor(t,e,i){this.temperature=t,this.position=e,this.size=i,this.creatures=new Array}addCreature(t){const e=this.creatures.push(t);this.onCreaturesCountUpdated&&this.onCreaturesCountUpdated(e)}removeCreature(t){this.creatures=this.creatures.filter(e=>e!=t),this.onCreaturesCountUpdated&&this.onCreaturesCountUpdated(this.creatures.length)}};j=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r}([Object(n.k)("environment"),U("design:paramtypes",[Number,n.F,Number])],j);const B=n.G.getComponentGroup(j);var H=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},D=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let k=class{constructor(t=!1){this.grabbed=!1,this.grabbed=t}};k=H([Object(n.k)("grabableObjectComponent"),D("design:paramtypes",[Boolean])],k);let G=class{};G=H([Object(n.k)("objectGrabberComponent")],G);let W=new n.F(.5,1,0),q=new n.l;n.G.addEntity(q);const V=n.h.instance;let Y=new n.l;Y.addComponent(new n.A({position:V.position.clone(),rotation:V.rotation.clone()})),Y.addComponent(new G),n.G.addEntity(Y);n.G.getComponentGroup(k);function X(t=null){a&&((t=t||function(t){for(let e of B.entities){if(n.F.DistanceSquared(e.getComponent(n.A).position,t)<25)return e}return null}(n.h.instance.position).getComponent(j))?(a.setParent(q),a.getComponent(n.A).position=t.position,a.getComponent(k).grabbed=!1,a.getComponent(Q).SetEnvironment(t),a.getComponent(Q).TargetRandomPosition(),d(null)):Object(n.H)("not possible to drop here"))}var $,Z=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},K=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let J=new class{constructor(t=10){this.pool=[],this.max=1e3,this.pool=[],this.max=t;for(let e=0;e<t;e++)this.newEntity()}getEntity(){for(let t=0;t<this.pool.length;t++){const e=this.pool[t];if(!e.alive)return e}return this.max&&this.pool.length<this.max?this.newEntity():null}newEntity(){const t=new n.l;return t.name=(1e4*Math.random()).toString(),this.pool.push(t),t}}(10),Q=$=class{constructor(t,e){this.health=100,this.damageCounter=s,this.oldPos=n.F.Zero(),this.nextPos=n.F.Zero(),this.movementFraction=1,this.movementPauseTimer=0,this.shape=null,this.environment=null,this.entity=t,this.transform=new n.A,t.addComponent(this.transform),this.grabableObjectComponent=new k,t.addComponent(this.grabableObjectComponent);this.genome=new I([.5,20,.5,.5,.5,.5,.5,.5,.5]),t.addComponent(this.genome);let i=new n.l;i.setParent(t),this.name=function(){let t=Math.random();return t<.01?"Pumbi":t<.05?"Sasha":t<.1?"Pumpi":t<.15?"Bimbo":t<.175?"Falopon":t<.2?"Troncho":t<.25?"Mika":t<.3?"Plinky":t<.35?"Faloppy":t<.4?"Sputnik":t<.45?"Satoshi":t<.475?"Bilbo":t<.5?"Falchor":t<.55?"Pipo":t<.575?"Keanu":t<.6?"Kinky":t<.65?"Buddy":t<.675?"Ryan":t<.7?"Slimy":t<.75?"JoJo":t<.775?"OraOraOra":t<.8?"Chippy":t<.85?"Chiffy":t<.875?"Satatus":t<.9?"Chippu":t<.95?"Kurtnus":"Kax"}();let o=new n.y(this.name);o.fontSize=3,o.color=n.i.White(),o.hTextAlign="center",o.vTextAlign="center",o.billboard=!0,i.addComponent(o),i.addComponent(new n.A({position:new n.F(0,1.8,0)}));let r=new n.l;r.setParent(i),this.temperatureText=new n.y("20°"),this.temperatureText.fontSize=2.75,this.temperatureText.color=n.i.Green(),this.temperatureText.hTextAlign="center",this.temperatureText.vTextAlign="center",this.temperatureText.billboard=!0,r.addComponent(this.temperatureText),r.addComponent(new n.A({position:new n.F(0,-.3,0)}));let a=new n.l;a.setParent(i),a.addComponent(new n.A({position:new n.F(0,-.6,0),rotation:n.w.Euler(0,180,0)})),this.healthBar=new L(a),a.addComponent(this.healthBar);let d=new n.l;d.setParent(r),this.coldIconEntityTransform=new n.A({position:new n.F(.45,0,0),rotation:n.w.Euler(0,0,0),scale:new n.F(0,0,0)}),d.addComponent(this.coldIconEntityTransform),d.addComponent(new n.v),d.addComponent(y);let l=new n.l;l.setParent(r),this.hotIconEntityTransform=new n.A({position:new n.F(-.45,0,0),rotation:n.w.Euler(0,0,0),scale:new n.F(0,0,0)}),l.addComponent(this.hotIconEntityTransform),l.addComponent(new n.v),l.addComponent(f),this.SetEnvironment(e),this.UpdateScale(),n.G.addEntity(t)}TargetRandomPosition(){this.environment&&(this.oldPos=this.transform.position,this.oldPos.y=0,this.nextPos=function(t,e){let i=new n.F(Math.random()*e,0,Math.random()*e);Math.random()<.5&&(i.x*=-1);Math.random()<.5&&(i.z*=-1);return n.F.Add(t,i)}(this.environment.position,this.environment.size),this.movementFraction=0,this.transform.lookAt(this.nextPos))}SpawnChild(){if(tt.entities.length>=10)return;let t=J.getEntity();if(!t)return;let e=new $(t,this.environment?this.environment:null);t.addComponentOrReplace(e),e.transform.position=this.transform.position.clone(),e.TargetRandomPosition(),e.genome.CopyFrom(this.genome),e.Mutate(),St(t),e.movementPauseTimer=5*Math.random()}Mutate(){this.genome.Mutate(),this.UpdateTemperatureText(),this.UpdateScale(),this.UpdateTemperatureIcons()}UpdateScale(){let t=Math.abs(-1*this.genome.genes[P.speed]+1),e=n.x.Lerp(.25,2.3,t);this.transform.scale.x=e,this.transform.scale.y=e,this.transform.scale.z=e}UpdateHealthbar(){this.healthBar.UpdateNormalizedValue(this.health/100)}UpdateTemperatureText(){this.temperatureText.value=this.genome.genes[P.temperature]+"°",this.IsAtIdealTemperature()?this.temperatureText.color=n.i.Green():this.temperatureText.color=n.i.Red()}UpdateTemperatureIcons(){if(!this.environment)return this.hotIconEntityTransform.scale.set(0,0,0),void this.coldIconEntityTransform.scale.set(0,0,0);let t=this.environment.temperature+10,e=this.environment.temperature-10;Math.abs(t-this.genome.genes[P.temperature])<=8?this.hotIconEntityTransform.scale.set(.25,.25,.25):this.hotIconEntityTransform.scale.set(0,0,0),Math.abs(e-this.genome.genes[P.temperature])<=8?this.coldIconEntityTransform.scale.set(.25,.25,.25):this.coldIconEntityTransform.scale.set(0,0,0)}takeDamage(){if(this.IsAtIdealTemperature())return;let t=this.GetTemperatureDif(),e=t*t*r*this.genome.genes[P.speed];this.health-=e,this.health<0&&(this.health=0),this.UpdateHealthbar()}IsAtIdealTemperature(){return this.GetTemperatureDif()<=8}GetTemperatureDif(){return this.environment?Math.abs(this.environment.temperature-this.genome.genes[P.temperature]):0}SetEnvironment(t){t!=this.environment&&(this.environment&&this.environment.removeCreature(this),this.environment=t,this.environment&&this.environment.addCreature(this),this.UpdateTemperatureIcons())}};Q=$=Z([Object(n.k)("creature"),K("design:paramtypes",[Object,Object])],Q);const tt=n.G.getComponentGroup(Q);n.G.addSystem(new class{update(t){for(let t of tt.entities){let e=t.getComponent(Q);null!=e.environment&&(e.damageCounter-=1,e.damageCounter<0&&(e.takeDamage(),e.health<=0&&(Object(n.H)("RIP"),e.environment.removeCreature(e),et(t),n.G.removeEntity(t),E()),e.damageCounter=s))}}});function et(t){for(const e in t.components)t.removeComponent(t.components[e]);for(const e in t.children)et(t.children[e]),n.G.removeEntity(t.children[e])}n.G.addSystem(new class{constructor(){this.sinTime=0}update(t){for(let e of tt.entities){let i=e.getComponent(Q);if(i.grabableObjectComponent.grabbed)continue;if(i.movementPauseTimer>0&&(i.movementPauseTimer-=t,i.movementPauseTimer>0))continue;if(i.movementFraction>=1)continue;let o=i.genome.genes[P.speed];i.movementFraction+=o*t,i.movementFraction>1&&(i.movementFraction=1),i.transform.position=n.F.Lerp(i.oldPos,i.nextPos,i.movementFraction),this.sinTime+=t*o*4;let s=Math.abs(Math.sin(this.sinTime))*Math.abs(i.genome.genes[P.temperature]/30);i.transform.position.y=s,1==i.movementFraction&&(i.movementPauseTimer=20*Math.random(),i.transform.position.y=0,Math.random()<.7&&i.environment&&8==i.environment.size&&i.SpawnChild(),i.TargetRandomPosition())}}});let it=new n.m("models/Creature/Body.glb"),nt=new n.m("models/Creature/Winter_Lv1.glb"),ot=new n.m("models/Creature/Winter_Lv2.glb"),st=new n.m("models/Creature/Heat_Lv1.glb"),rt=new n.m("models/Creature/Heat_Lv2.glb"),at=new n.m("models/Creature/Feet_Spider.glb"),dt=new n.m("models/Creature/Feet_Big.glb"),lt=new n.m("models/Creature/Feet_Centipede.glb"),ht=new n.m("models/Creature/Ears_AcuaticFin.glb"),pt=new n.m("models/Creature/Ears_Cat.glb"),ct=new n.m("models/Creature/Ears_Bear.glb"),ut=new n.m("models/Creature/Ears_Cute.glb"),yt=new n.m("models/Creature/Ears_Bunny.glb"),mt=new n.m("models/Creature/Eyes_Cyclop.glb"),ft=new n.m("models/Creature/Eyes_Biclop.glb"),gt=new n.m("models/Creature/Eyes_Nerd.glb"),wt=new n.m("models/Creature/Eyes_Nerdor.glb"),bt=new n.m("models/Creature/Eyes_Spider.glb"),vt=new n.m("models/Creature/Mouth_Acuatic.glb"),xt=new n.m("models/Creature/Mouth_Smile.glb"),Rt=new n.m("models/Creature/Mouth_Fangs.glb"),Tt=new n.m("models/Creature/Nose_Bear.glb"),Ct=new n.m("models/Creature/Nose_Horn.glb"),Et=new n.m("models/Creature/Tail_Acuatic.glb"),At=new n.m("models/Creature/Tail_Pig.glb"),_t=new n.m("models/Creature/Wings_Acuatic.glb"),zt=new n.m("models/Creature/Wings_Bat.glb"),Pt=new n.m("models/Creature/Wings_Dragon.glb");function St(t){let e=t.getComponent(I).genes,i=e[P.temperature],o=new n.l;if(o.setParent(t),o.addComponent(it),o.addComponentOrReplace(new n.s(()=>{let t=o.getParent();t&&(t.getComponent(k).grabbed||function(t){Y.children[0]?Object(n.H)("already holding"):(Object(n.H)("grabbed object"),t.getComponent(k).grabbed=!0,t.setParent(Y),t.getComponent(n.A).position=W.clone(),t.getComponent(Q).SetEnvironment(null),d(t))}(t))})),i<-30){let e=new n.l;e.addComponent(ot),e.setParent(t)}else if(i<5){let e=new n.l;e.addComponent(nt),e.setParent(t)}else if(i<30);else if(i<70){let e=new n.l;e.addComponent(st),e.setParent(t)}else if(i>=70){let e=new n.l;e.addComponent(rt),e.setParent(t)}let s=e[P.feet],r=new n.l;r.setParent(t),s<.3?r.addComponent(lt):s<.7?r.addComponent(dt):s<=1&&r.addComponent(at);let a=e[P.ears],l=new n.l;l.setParent(t),a<.15?l.addComponent(ht):a<.3?l.addComponent(pt):a<.45?l.addComponent(ct):a<.7||(a<.85?l.addComponent(ut):a<=1&&l.addComponent(yt));let h=e[P.eyes],p=new n.l;p.setParent(t),h<.2?p.addComponent(mt):h<.4?p.addComponent(ft):h<.6?p.addComponent(gt):h<.8?p.addComponent(wt):h<=1&&p.addComponent(bt);let c=e[P.mouth],u=new n.l;u.setParent(t),c<.2?u.addComponent(vt):c<.4||(c<.6?u.addComponent(xt):c<.8&&u.addComponent(Rt));let y=e[P.nose],m=new n.l;m.setParent(t),y<.3?m.addComponent(Tt):y<.7||y<=1&&m.addComponent(Ct);let f=e[P.tail],g=new n.l;g.setParent(t),f<.3?g.addComponent(Et):f<.7||f<=1&&g.addComponent(At);let w=e[P.wings],b=new n.l;b.setParent(t),w<.2?b.addComponent(_t):w<.6||(w<.8?b.addComponent(zt):w<=1&&b.addComponent(Pt))}var Ot=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let It=class{constructor(t,e,i=2){this.xUp=0,this.xDown=0,this.xUp=t,this.xDown=e,this.pressed=!1,this.fraction=0,this.timeDownLeft=i,this.totalTimeDown=i}};It=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r}([Object(n.k)("buttonData"),Ot("design:paramtypes",[Number,Number,Number])],It);n.G.getComponentGroup(It);i.d(e,"hotEnvironment",(function(){return Mt})),i.d(e,"coldEnvironment",(function(){return Ut})),i.d(e,"neutralEnvironment",(function(){return Bt})),i.d(e,"creaturemeterText",(function(){return Xt})),i.d(e,"monitorCreaturemeterText",(function(){return te})),n.G.addSystem(new class{}),n.G.addSystem(new class{update(t){if(null==a)return;let e=Y.getComponent(n.A);e.position=V.position.clone(),e.rotation=V.rotation.clone()}});let Ft=new n.l;Ft.addComponent(new n.m("models/Environment_01.glb")),Ft.addComponent(new n.A),n.G.addEntity(Ft);let Nt=new n.l,Mt=new j(70,h,4);Nt.addComponent(Mt),Nt.addComponent(new n.v),Nt.addComponent(new n.A({position:h,scale:new n.F(8,8,8),rotation:n.w.Euler(90,0,0)})),Nt.addComponent(x),Nt.addComponent(new n.s(t=>{X(Mt),C()})),n.G.addEntity(Nt);let Lt=new n.l,Ut=new j(-30,p,4);Lt.addComponent(Ut),Lt.addComponent(new n.v),Lt.addComponent(new n.A({position:p,scale:new n.F(8,8,8),rotation:n.w.Euler(90,0,0)})),Lt.addComponent(R),Lt.addComponent(new n.s(t=>{X(Ut),C()})),n.G.addEntity(Lt);let jt=new n.l,Bt=new j(20,l,8);jt.addComponent(Bt),jt.addComponent(new n.v),jt.addComponent(new n.A({position:l,scale:new n.F(16,16,16),rotation:n.w.Euler(270,0,0)})),jt.addComponent(new n.s(t=>{X(Bt)})),n.G.addEntity(jt);let Ht=J.getEntity();if(Ht){let t=new Q(Ht,Bt);Ht.addComponent(t),t.transform.position=new n.F(24,0,24),t.TargetRandomPosition(),St(Ht),t.UpdateTemperatureText(),t.UpdateScale()}let Dt=new n.l;Dt.addComponent(new n.A({position:new n.F(26,-.5,40),scale:new n.F(2,3,6),rotation:n.w.Euler(0,0,-35)})),n.G.addEntity(Dt);let kt=new n.l;kt.addComponent(new n.A({position:new n.F(-.1,.35,-.325),scale:new n.F(.7,.5,.2),rotation:n.w.Euler(0,0,0)})),kt.addComponent(new n.m("models/Button.glb")),kt.addComponent(x),kt.addComponent(new n.s(t=>{Bt.temperature+=10,Bt.temperature>100&&(Bt.temperature=100),kt.getComponent(It).pressed=!0;let e=T.albedoColor.b,i=T.albedoColor.r;T.albedoColor=new n.i(i+.6,.5,e-.6),jt.addComponentOrReplace(T);let o=Bt.temperature.toString();qt.value=o+"°",Kt.value=o+"°";for(let t of tt.entities){let e=t.getComponent(Q);e.UpdateTemperatureText(),e.UpdateTemperatureIcons()}})),kt.addComponent(new It(14.5,14.7)),n.G.addEntity(kt),kt.setParent(Dt);let Gt=new n.l;Gt.addComponent(new n.A({position:new n.F(.3,.35,-.325),scale:new n.F(.7,.5,.2),rotation:n.w.Euler(0,0,0)})),Gt.addComponent(new n.m("models/Button.glb")),Gt.addComponent(R),Gt.addComponent(new n.s(t=>{Bt.temperature-=10,Bt.temperature<-100&&(Bt.temperature=-100),Gt.getComponent(It).pressed=!0;let e=T.albedoColor.b,i=T.albedoColor.r;T.albedoColor=new n.i(i-.6,.5,e+.6),jt.addComponentOrReplace(T);let o=Bt.temperature.toString();qt.value=o+"°",Kt.value=o+"°";for(let t of tt.entities){let e=t.getComponent(Q);e.UpdateTemperatureText(),e.UpdateTemperatureIcons()}})),Gt.addComponent(new It(14.5,14.7)),n.G.addEntity(Gt),Gt.setParent(Dt);let Wt=new n.l,qt=new n.y(Bt.temperature.toString()+"°");qt.fontSize=4,qt.hTextAlign="center",qt.vTextAlign="center",Wt.addComponent(qt),Wt.addComponent(new n.A({position:new n.F(0,.575,.15),scale:new n.F(.2,.5,.8),rotation:n.w.Euler(90,0,90)})),n.G.addEntity(Wt),Wt.setParent(Dt);let Vt=new n.l;Vt.setParent(Wt),Vt.addComponent(new n.A({position:new n.F(-1,0,0),rotation:n.w.Euler(0,0,0),scale:new n.F(.5,.5,0)})),Vt.addComponent(new n.v),Vt.addComponent(w),n.G.addEntity(Vt);let Yt=new n.l,Xt=new n.y("1/10");Xt.fontSize=4,Xt.hTextAlign="center",Xt.vTextAlign="center",Yt.addComponent(Xt),Yt.addComponent(new n.A({position:new n.F(.325,.57,.15),scale:new n.F(.2,.5,.8),rotation:n.w.Euler(90,0,90)})),n.G.addEntity(Yt),Yt.setParent(Dt);let $t=new n.l;$t.setParent(Yt),$t.addComponent(new n.A({position:new n.F(-1,0,0),scale:new n.F(.5,.5,0),rotation:n.w.Euler(0,0,180)})),$t.addComponent(new n.v),$t.addComponent(v),n.G.addEntity($t);let Zt=new n.l,Kt=new n.y(Bt.temperature.toString()+"°");Kt.fontSize=15,Kt.hTextAlign="center",Kt.vTextAlign="center",Zt.addComponent(Kt),Zt.addComponent(new n.A({position:new n.F(3.1,6.7,38.5),rotation:n.w.Euler(0,-90,0)})),n.G.addEntity(Zt);let Jt=new n.l;Jt.setParent(Zt),Jt.addComponent(new n.A({position:new n.F(-3,0,0),scale:new n.F(1.5,1.5,0)})),Jt.addComponent(new n.v),Jt.addComponent(w),n.G.addEntity(Jt);let Qt=new n.l,te=new n.y("1/10");te.fontSize=15,te.hTextAlign="center",te.vTextAlign="center",Qt.addComponent(te),Qt.addComponent(new n.A({position:new n.F(3.1,4.7,38.5),rotation:n.w.Euler(0,-90,0)})),n.G.addEntity(Qt);let ee=new n.l;ee.setParent(Qt),ee.addComponent(new n.A({position:new n.F(-3,0,0),scale:new n.F(1.5,1.5,0),rotation:n.w.Euler(0,0,180)})),ee.addComponent(new n.v),ee.addComponent(v),n.G.addEntity(ee),C=function(){if(!_&&Ut.creatures.length>=3){let t=0;for(let e of Ut.creatures)e.IsAtIdealTemperature()&&t++;if(t<3||Mt.creatures.length<3)return;for(let e of Mt.creatures)e.IsAtIdealTemperature()&&t++;if(t<6)return;z(!0);let e=new n.B,i=new n.D(e,c);i.width=512,i.height=512,i.sourceWidth=512,i.sourceHeight=512,i.hAlign="center",i.vAlign="center"}},E=function(){if(_)return;Object(n.H)("begin environments check");for(let t of B.entities)if(Object(n.H)(t.getComponent(j).creatures.length),t.getComponent(j).creatures.length>0)return;z(!0);let t=new n.B,e=new n.C(t);e.width="100%",e.height="50%",e.positionY=5,e.color=new n.j(0,0,0,.75);let i=new n.E(e);i.value="YOU LOST!\n\nREFRESH THE TAB AND GIVE IT ANOTHER SHOT!",i.color=n.j.Yellow(),i.outlineColor=n.j.Magenta(),i.fontSize=45,i.outlineWidth=.1,i.vAlign="center",i.hAlign="center",i.vTextAlign="center",i.hTextAlign="center"},Bt.onCreaturesCountUpdated=function(t){Xt&&(Xt.value=t+"/10",te.value=t+"/10")}}})}));