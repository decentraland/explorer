!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=20)}([function(t,e,i){"use strict";i.d(e,"c",(function(){return l})),i.d(e,"d",(function(){return p})),i.d(e,"e",(function(){return u})),i.d(e,"a",(function(){return y})),i.d(e,"b",(function(){return f})),i.d(e,"i",(function(){return m})),i.d(e,"g",(function(){return g})),i.d(e,"h",(function(){return b})),i.d(e,"f",(function(){return x})),i.d(e,"j",(function(){return w}));var n=i(3),s=i(5),o=i(11),r=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},a=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const d="__name__symbol_",h="__classId__symbol_",c="__component__id_";let l=class{constructor(t,e,i){this.componentId=t,this.componentName=e,this.classId=i}};l=r([Object(s.a)(),a("design:paramtypes",[String,String,Number])],l);let p=class{constructor(t){this.componentId=t}};p=r([Object(s.a)(),a("design:paramtypes",[String])],p);let u=class{constructor(t,e){this.componentId=t,this.component=e}};function y(t,e){return function(i){if(i.isComponent)throw new TypeError(`You cannot extend a component. Trying to extend ${i.originalClassName} with: ${t}`);const n=i,s=function(){const i=Array.prototype.slice.call(arguments),s=new n(...i);return Object.defineProperty(s,d,{enumerable:!1,writable:!1,configurable:!1,value:t}),void 0!==e&&Object.defineProperty(s,h,{enumerable:!1,writable:!1,configurable:!1,value:e}),s};return void 0!==e&&(s[h]=e),s[d]=t,s.isComponent=!0,s.originalClassName=t,(s.prototype=i.prototype).constructor=i,s}}function f(t,e){return function(i){if(i.isComponent)throw new TypeError(`You cannot extend a component. Trying to extend ${i.originalClassName} with: ${t}`);if("number"!=typeof e||isNaN(e))throw new Error(`classId: ${e} is an invalid integer`);const s=i,o=function(){if(!f.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");const i=Array.prototype.slice.call(arguments),o=new s(...i),r=Object(n.d)("C");return Object.defineProperty(o,d,{enumerable:!1,writable:!1,configurable:!1,value:t}),Object.defineProperty(o,c,{enumerable:!1,writable:!1,configurable:!1,value:r}),void 0!==e&&Object.defineProperty(o,h,{enumerable:!1,writable:!1,configurable:!1,value:e}),f.engine&&f.engine.registerComponent(o),o};return void 0!==e&&(o[h]=e),o[d]=t,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=t,(o.prototype=i.prototype).constructor=i,o}}function m(t){if(!t)throw new TypeError(t+" is not a component.");if(t[d])return t[d];throw new TypeError(t+" is not a registered component.")}function g(t){if(!t)throw new TypeError(t+" is not a component.");if(t[h])return t[h];if(!t[d])throw new TypeError(t+" is not a registered component.");return null}function b(t){if(!t)throw new TypeError(t+" is not a component.");if(t[c])return t[c];throw new TypeError(t+" is not a registered disposable component.")}u=r([Object(s.a)(),a("design:paramtypes",[String,Object])],u),function(t){t.engine=null}(f||(f={}));class x{constructor(){this.dirty=!1,this.data={},this.subscriptions=[]}static component(t,e){if(delete t[e]){const i=e+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(t,i)),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[i]},set:function(t){const n=this[i];if(this.data[e]=t?b(t):null,this[i]=t,t!==n){this.dirty=!0;for(let i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})}}static field(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e]},set:function(t){const i=this.data[e];if(this.data[e]=t,t!==i){this.dirty=!0;for(let n=0;n<this.subscriptions.length;n++)this.subscriptions[n](e,t,i)}},enumerable:!0})}static uiValue(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e].toString()},set:function(t){const i=this.data[e],n=new o.a(t);if(this.data[e]=n,n!==i){this.dirty=!0;for(let t=0;t<this.subscriptions.length;t++)this.subscriptions[t](e,n,i)}},enumerable:!0})}static readonly(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){if(e in this.data==!1)throw new Error(`The field ${e} is uninitialized`);return this.data[e]},set:function(t){if(e in this.data)throw new Error(`The field ${e} is readonly`);this.data[e]=t,this.dirty=!0},enumerable:!0,configurable:!1})}onChange(t){return this.subscriptions.push(t),this}toJSON(){return this.data}}function w(t){return c in t}},function(t,e,i){"use strict";var n,s;!function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(n||(n={})),function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD",t[t.BONE=2]="BONE"}(s||(s={}));const o=1/2.2,r=2.2,a=1e-6,d=Math.PI/180,h=360/(2*Math.PI);var c=i(3);class l{static WithinEpsilon(t,e,i=1401298e-51){let n=t-e;return-i<=n&&n<=i}static ToHex(t){let e=t.toString(16);return t<=15?("0"+e).toUpperCase():e.toUpperCase()}static Sign(t){const e=+t;return 0===e||isNaN(e)?e:e>0?1:-1}static Clamp(t,e=0,i=1){return Math.min(i,Math.max(e,t))}static Log2(t){return Math.log(t)*Math.LOG2E}static Repeat(t,e){return t-Math.floor(t/e)*e}static Normalize(t,e,i){return(t-e)/(i-e)}static Denormalize(t,e,i){return t*(i-e)+e}static DeltaAngle(t,e){let i=l.Repeat(e-t,360);return i>180&&(i-=360),i}static PingPong(t,e){let i=l.Repeat(t,2*e);return e-Math.abs(i-e)}static SmoothStep(t,e,i){let n=l.Clamp(i);return e*(n=-2*n*n*n+3*n*n)+t*(1-n)}static MoveTowards(t,e,i){let n=0;return n=Math.abs(e-t)<=i?e:t+l.Sign(e-t)*i}static MoveTowardsAngle(t,e,i){let n=l.DeltaAngle(t,e),s=0;return s=-i<n&&n<i?e:l.MoveTowards(t,t+n,i)}static Lerp(t,e,i){return t+(e-t)*i}static LerpAngle(t,e,i){let n=l.Repeat(e-t,360);return n>180&&(n-=360),t+n*l.Clamp(i)}static InverseLerp(t,e,i){let n=0;return n=t!==e?l.Clamp((i-t)/(e-t)):0}static Hermite(t,e,i,n,s){let o=s*s,r=s*o;return t*(2*r-3*o+1)+i*(-2*r+3*o)+e*(r-2*o+s)+n*(r-o)}static RandomRange(t,e){return t===e?t:Math.random()*(e-t)+t}static RangeToPercent(t,e,i){return(t-e)/(i-e)}static PercentToRange(t,e,i){return(i-e)*t+e}static NormalizeRadians(t){return t-l.TwoPi*Math.floor((t+Math.PI)/l.TwoPi)}}l.TwoPi=2*Math.PI;class p{constructor(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}static Add(t,e){return new p(t.x,t.y,t.z,t.w).addInPlace(e)}static FromArray(t,e=0){return new p(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]}static FromFloatArrayToRef(t,e,i){p.FromArrayToRef(t,e,i)}static FromFloatsToRef(t,e,i,n,s){s.x=t,s.y=e,s.z=i,s.w=n}static Zero(){return new p(0,0,0,0)}static One(){return new p(1,1,1,1)}static Normalize(t){let e=p.Zero();return p.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){e.copyFrom(t),e.normalize()}static Minimize(t,e){let i=new p(t.x,t.y,t.z,t.w);return i.minimizeInPlace(e),i}static Maximize(t,e){let i=new p(t.x,t.y,t.z,t.w);return i.maximizeInPlace(e),i}static Distance(t,e){return Math.sqrt(p.DistanceSquared(t,e))}static DistanceSquared(t,e){let i=t.x-e.x,n=t.y-e.y,s=t.z-e.z,o=t.w-e.w;return i*i+n*n+s*s+o*o}static Center(t,e){let i=p.Add(t,e);return i.scaleInPlace(.5),i}static TransformNormal(t,e){let i=p.Zero();return p.TransformNormalToRef(t,e,i),i}static TransformNormalToRef(t,e,i){const n=e.m;let s=t.x*n[0]+t.y*n[4]+t.z*n[8],o=t.x*n[1]+t.y*n[5]+t.z*n[9],r=t.x*n[2]+t.y*n[6]+t.z*n[10];i.x=s,i.y=o,i.z=r,i.w=t.w}static TransformNormalFromFloatsToRef(t,e,i,n,s,o){const r=s.m;o.x=t*r[0]+e*r[4]+i*r[8],o.y=t*r[1]+e*r[5]+i*r[9],o.z=t*r[2]+e*r[6]+i*r[10],o.w=n}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)}asArray(){let t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}add(t){return new p(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subtract(t){return new p(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this}subtractFromFloats(t,e,i,n){return new p(this.x-t,this.y-e,this.z-i,this.w-n)}subtractFromFloatsToRef(t,e,i,n,s){return s.x=this.x-t,s.y=this.y-e,s.z=this.z-i,s.w=this.w-n,this}negate(){return new p(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scale(t){return new p(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}equalsWithEpsilon(t,e=a){return t&&l.WithinEpsilon(this.x,t.x,e)&&l.WithinEpsilon(this.y,t.y,e)&&l.WithinEpsilon(this.z,t.z,e)&&l.WithinEpsilon(this.w,t.w,e)}equalsToFloats(t,e,i,n){return this.x===t&&this.y===e&&this.z===i&&this.w===n}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiply(t){return new p(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this}multiplyByFloats(t,e,i,n){return new p(this.x*t,this.y*e,this.z*i,this.w*n)}divide(t){return new p(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}maximizeInPlace(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}floor(){return new p(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new p(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){let t=this.length();return 0===t?this:this.scaleInPlace(1/t)}toVector3(){return new f(this.x,this.y,this.z)}clone(){return new p(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}setAll(t){return this.x=this.y=this.z=this.w=t,this}}class u{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return u._identityReadOnly}static FromArray(t,e=0){let i=new u;return u.FromArrayToRef(t,e,i),i}static FromArrayToRef(t,e,i){for(let n=0;n<16;n++)i._m[n]=t[n+e];i._markAsUpdated()}static FromFloatArrayToRefScaled(t,e,i,n){for(let s=0;s<16;s++)n._m[s]=t[s+e]*i;n._markAsUpdated()}static FromValuesToRef(t,e,i,n,s,o,r,a,d,h,c,l,p,u,y,f,m){const g=m._m;g[0]=t,g[1]=e,g[2]=i,g[3]=n,g[4]=s,g[5]=o,g[6]=r,g[7]=a,g[8]=d,g[9]=h,g[10]=c,g[11]=l,g[12]=p,g[13]=u,g[14]=y,g[15]=f,m._markAsUpdated()}static FromValues(t,e,i,n,s,o,r,a,d,h,c,l,p,y,f,m){let g=new u;const b=g._m;return b[0]=t,b[1]=e,b[2]=i,b[3]=n,b[4]=s,b[5]=o,b[6]=r,b[7]=a,b[8]=d,b[9]=h,b[10]=c,b[11]=l,b[12]=p,b[13]=y,b[14]=f,b[15]=m,g._markAsUpdated(),g}static Compose(t,e,i){let n=new u;return u.ComposeToRef(t,e,i,n),n}static ComposeToRef(t,e,i,n){u.ScalingToRef(t.x,t.y,t.z,m.Matrix[1]),e.toRotationMatrix(m.Matrix[0]),m.Matrix[1].multiplyToRef(m.Matrix[0],n),n.setTranslation(i)}static Identity(){const t=u.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t}static IdentityToRef(t){u.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0)}static Zero(){const t=u.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t}static RotationX(t){let e=new u;return u.RotationXToRef(t,e),e}static Invert(t){let e=new u;return t.invertToRef(e),e}static RotationXToRef(t,e){let i=Math.sin(t),n=Math.cos(t);u.FromValuesToRef(1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationY(t){let e=new u;return u.RotationYToRef(t,e),e}static RotationYToRef(t,e){let i=Math.sin(t),n=Math.cos(t);u.FromValuesToRef(n,0,-i,0,0,1,0,0,i,0,n,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationZ(t){let e=new u;return u.RotationZToRef(t,e),e}static RotationZToRef(t,e){let i=Math.sin(t),n=Math.cos(t);u.FromValuesToRef(n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationAxis(t,e){let i=new u;return u.RotationAxisToRef(t,e,i),i}static RotationAxisToRef(t,e,i){let n=Math.sin(-e),s=Math.cos(-e),o=1-s;t.normalize();const r=i._m;r[0]=t.x*t.x*o+s,r[1]=t.x*t.y*o-t.z*n,r[2]=t.x*t.z*o+t.y*n,r[3]=0,r[4]=t.y*t.x*o+t.z*n,r[5]=t.y*t.y*o+s,r[6]=t.y*t.z*o-t.x*n,r[7]=0,r[8]=t.z*t.x*o-t.y*n,r[9]=t.z*t.y*o+t.x*n,r[10]=t.z*t.z*o+s,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,i._markAsUpdated()}static RotationYawPitchRoll(t,e,i){let n=new u;return u.RotationYawPitchRollToRef(t,e,i,n),n}static RotationYawPitchRollToRef(t,e,i,n){y.RotationYawPitchRollToRef(t,e,i,m.Quaternion[0]),m.Quaternion[0].toRotationMatrix(n)}static Scaling(t,e,i){let n=new u;return u.ScalingToRef(t,e,i,n),n}static ScalingToRef(t,e,i,n){u.FromValuesToRef(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1,n),n._updateIdentityStatus(1===t&&1===e&&1===i)}static Translation(t,e,i){let n=new u;return u.TranslationToRef(t,e,i,n),n}static TranslationToRef(t,e,i,n){u.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1,n),n._updateIdentityStatus(0===t&&0===e&&0===i)}static Lerp(t,e,i){let n=new u;return u.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){for(let s=0;s<16;s++)n._m[s]=t._m[s]*(1-i)+e._m[s]*i;n._markAsUpdated()}static DecomposeLerp(t,e,i){let n=new u;return u.DecomposeLerpToRef(t,e,i,n),n}static DecomposeLerpToRef(t,e,i,n){let s=m.Vector3[0],o=m.Quaternion[0],r=m.Vector3[1];t.decompose(s,o,r);let a=m.Vector3[2],d=m.Quaternion[1],h=m.Vector3[3];e.decompose(a,d,h);let c=m.Vector3[4];f.LerpToRef(s,a,i,c);let l=m.Quaternion[2];y.SlerpToRef(o,d,i,l);let p=m.Vector3[5];f.LerpToRef(r,h,i,p),u.ComposeToRef(c,l,p,n)}static LookAtLH(t,e,i){let n=new u;return u.LookAtLHToRef(t,e,i,n),n}static LookAtLHToRef(t,e,i,n){const s=m.Vector3[0],o=m.Vector3[1],r=m.Vector3[2];e.subtractToRef(t,r),r.normalize(),f.CrossToRef(i,r,s);const a=s.lengthSquared();0===a?s.x=1:s.normalizeFromLength(Math.sqrt(a)),f.CrossToRef(r,s,o),o.normalize();let d=-f.Dot(s,t),h=-f.Dot(o,t),c=-f.Dot(r,t);u.FromValuesToRef(s.x,o.x,r.x,0,s.y,o.y,r.y,0,s.z,o.z,r.z,0,d,h,c,1,n)}static LookAtRH(t,e,i){let n=new u;return u.LookAtRHToRef(t,e,i,n),n}static LookAtRHToRef(t,e,i,n){const s=m.Vector3[0],o=m.Vector3[1],r=m.Vector3[2];t.subtractToRef(e,r),r.normalize(),f.CrossToRef(i,r,s);const a=s.lengthSquared();0===a?s.x=1:s.normalizeFromLength(Math.sqrt(a)),f.CrossToRef(r,s,o),o.normalize();let d=-f.Dot(s,t),h=-f.Dot(o,t),c=-f.Dot(r,t);u.FromValuesToRef(s.x,o.x,r.x,0,s.y,o.y,r.y,0,s.z,o.z,r.z,0,d,h,c,1,n)}static OrthoLH(t,e,i,n){let s=new u;return u.OrthoLHToRef(t,e,i,n,s),s}static OrthoLHToRef(t,e,i,n,s){let o=2/t,r=2/e,a=2/(n-i),d=-(n+i)/(n-i);u.FromValuesToRef(o,0,0,0,0,r,0,0,0,0,a,0,0,0,d,1,s),s._updateIdentityStatus(1===o&&1===r&&1===a&&0===d)}static OrthoOffCenterLH(t,e,i,n,s,o){let r=new u;return u.OrthoOffCenterLHToRef(t,e,i,n,s,o,r),r}static OrthoOffCenterLHToRef(t,e,i,n,s,o,r){let a=2/(e-t),d=2/(n-i),h=2/(o-s),c=-(o+s)/(o-s),l=(t+e)/(t-e),p=(n+i)/(i-n);u.FromValuesToRef(a,0,0,0,0,d,0,0,0,0,h,0,l,p,c,1,r),r._markAsUpdated()}static OrthoOffCenterRH(t,e,i,n,s,o){let r=new u;return u.OrthoOffCenterRHToRef(t,e,i,n,s,o,r),r}static OrthoOffCenterRHToRef(t,e,i,n,s,o,r){u.OrthoOffCenterLHToRef(t,e,i,n,s,o,r),r._m[10]*=-1}static PerspectiveLH(t,e,i,n){let s=new u,o=2*i/t,r=2*i/e,a=(n+i)/(n-i),d=-2*n*i/(n-i);return u.FromValuesToRef(o,0,0,0,0,r,0,0,0,0,a,1,0,0,d,0,s),s._updateIdentityStatus(!1),s}static PerspectiveFovLH(t,e,i,n){let s=new u;return u.PerspectiveFovLHToRef(t,e,i,n,s),s}static PerspectiveFovLHToRef(t,e,i,n,s,o=!0){let r=i,a=n,d=1/Math.tan(.5*t),h=o?d/e:d,c=o?d:d*e,l=(a+r)/(a-r),p=-2*a*r/(a-r);u.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,l,1,0,0,p,0,s),s._updateIdentityStatus(!1)}static PerspectiveFovRH(t,e,i,n){let s=new u;return u.PerspectiveFovRHToRef(t,e,i,n,s),s}static PerspectiveFovRHToRef(t,e,i,n,s,o=!0){let r=i,a=n,d=1/Math.tan(.5*t),h=o?d/e:d,c=o?d:d*e,l=-(a+r)/(a-r),p=-2*a*r/(a-r);u.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,l,-1,0,0,p,0,s),s._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(t,e,i,n,s=!1){let o=s?-1:1,r=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),d=Math.tan(t.leftDegrees*Math.PI/180),h=Math.tan(t.rightDegrees*Math.PI/180),c=2/(d+h),l=2/(r+a);const p=n._m;p[0]=c,p[1]=p[2]=p[3]=p[4]=0,p[5]=l,p[6]=p[7]=0,p[8]=(d-h)*c*.5,p[9]=-(r-a)*l*.5,p[10]=-i/(e-i),p[11]=1*o,p[12]=p[13]=p[15]=0,p[14]=-2*i*e/(i-e),n._markAsUpdated()}static GetAsMatrix2x2(t){return[t._m[0],t._m[1],t._m[4],t._m[5]]}static GetAsMatrix3x3(t){return[t._m[0],t._m[1],t._m[2],t._m[4],t._m[5],t._m[6],t._m[8],t._m[9],t._m[10]]}static Transpose(t){let e=new u;return u.TransposeToRef(t,e),e}static TransposeToRef(t,e){const i=e._m,n=t._m;i[0]=n[0],i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=n[1],i[5]=n[5],i[6]=n[9],i[7]=n[13],i[8]=n[2],i[9]=n[6],i[10]=n[10],i[11]=n[14],i[12]=n[3],i[13]=n[7],i[14]=n[11],i[15]=n[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)}static Reflection(t){let e=new u;return u.ReflectionToRef(t,e),e}static ReflectionToRef(t,e){t.normalize();let i=t.normal.x,n=t.normal.y,s=t.normal.z,o=-2*i,r=-2*n,a=-2*s;u.FromValuesToRef(o*i+1,r*i,a*i,0,o*n,r*n+1,a*n,0,o*s,r*s,a*s+1,0,o*t.d,r*t.d,a*t.d,1,e)}static FromXYZAxesToRef(t,e,i,n){u.FromValuesToRef(t.x,t.y,t.z,0,e.x,e.y,e.z,0,i.x,i.y,i.z,0,0,0,0,1,n)}static FromQuaternionToRef(t,e){let i=t.x*t.x,n=t.y*t.y,s=t.z*t.z,o=t.x*t.y,r=t.z*t.w,a=t.z*t.x,d=t.y*t.w,h=t.y*t.z,c=t.x*t.w;e._m[0]=1-2*(n+s),e._m[1]=2*(o+r),e._m[2]=2*(a-d),e._m[3]=0,e._m[4]=2*(o-r),e._m[5]=1-2*(s+i),e._m[6]=2*(h+c),e._m[7]=0,e._m[8]=2*(a+d),e._m[9]=2*(h-c),e._m[10]=1-2*(n+i),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()}_markAsUpdated(){this.updateFlag=u._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]?this._isIdentity3x2=!1:0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const t=this._m,e=t[0],i=t[1],n=t[2],s=t[3],o=t[4],r=t[5],a=t[6],d=t[7],h=t[8],c=t[9],l=t[10],p=t[11],u=t[12],y=t[13],f=t[14],m=t[15],g=l*m-f*p,b=c*m-y*p,x=c*f-y*l,w=h*m-u*p,v=h*f-l*u,R=h*y-u*c;return e*+(r*g-a*b+d*x)+i*-(o*g-a*w+d*v)+n*+(o*b-r*w+d*R)+s*-(o*x-r*v+a*R)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return u.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(t){let e=new u;return this.addToRef(t,e),e}addToRef(t,e){for(let i=0;i<16;i++)e._m[i]=this._m[i]+t._m[i];return e._markAsUpdated(),this}addToSelf(t){for(let e=0;e<16;e++)this._m[e]+=t._m[e];return this._markAsUpdated(),this}invertToRef(t){if(!0===this._isIdentity)return u.IdentityToRef(t),this;const e=this._m,i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],d=e[6],h=e[7],c=e[8],l=e[9],p=e[10],y=e[11],f=e[12],m=e[13],g=e[14],b=e[15],x=p*b-g*y,w=l*b-m*y,v=l*g-m*p,R=c*b-f*y,T=c*g-p*f,_=c*m-f*l,A=+(a*x-d*w+h*v),E=-(r*x-d*R+h*T),O=+(r*w-a*R+h*_),z=-(r*v-a*T+d*_),C=i*A+n*E+s*O+o*z;if(0===C)return t.copyFrom(this),this;const S=1/C,I=d*b-g*h,P=a*b-m*h,N=a*g-m*d,F=r*b-f*h,M=r*g-f*d,j=r*m-f*a,L=d*y-p*h,H=a*y-l*h,B=a*p-l*d,U=r*y-c*h,D=r*p-c*d,k=r*l-c*a,q=-(n*x-s*w+o*v),W=+(i*x-s*R+o*T),V=-(i*w-n*R+o*_),G=+(i*v-n*T+s*_),Y=+(n*I-s*P+o*N),X=-(i*I-s*F+o*M),$=+(i*P-n*F+o*j),Z=-(i*N-n*M+s*j),Q=-(n*L-s*H+o*B),K=+(i*L-s*U+o*D),J=-(i*H-n*U+o*k),tt=+(i*B-n*D+s*k);return u.FromValuesToRef(A*S,q*S,Y*S,Q*S,E*S,W*S,X*S,K*S,O*S,V*S,$*S,J*S,z*S,G*S,Z*S,tt*S,t),this}addAtIndex(t,e){return this._m[t]+=e,this._markAsUpdated(),this}multiplyAtIndex(t,e){return this._m[t]*=e,this._markAsUpdated(),this}setTranslationFromFloats(t,e,i){return this._m[12]=t,this._m[13]=e,this._m[14]=i,this._markAsUpdated(),this}setTranslation(t){return this.setTranslationFromFloats(t.x,t.y,t.z)}getTranslation(){return new f(this._m[12],this._m[13],this._m[14])}getTranslationToRef(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this}removeRotationAndScaling(){const t=this.m;return u.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),this}multiply(t){let e=new u;return this.multiplyToRef(t,e),e}copyFrom(t){t.copyToArray(this._m);const e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this}copyToArray(t,e=0){for(let i=0;i<16;i++)t[e+i]=this._m[i];return this}multiplyToRef(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)}multiplyToArray(t,e,i){const n=this._m,s=t.m;let o=n[0],r=n[1],a=n[2],d=n[3],h=n[4],c=n[5],l=n[6],p=n[7],u=n[8],y=n[9],f=n[10],m=n[11],g=n[12],b=n[13],x=n[14],w=n[15],v=s[0],R=s[1],T=s[2],_=s[3],A=s[4],E=s[5],O=s[6],z=s[7],C=s[8],S=s[9],I=s[10],P=s[11],N=s[12],F=s[13],M=s[14],j=s[15];return e[i]=o*v+r*A+a*C+d*N,e[i+1]=o*R+r*E+a*S+d*F,e[i+2]=o*T+r*O+a*I+d*M,e[i+3]=o*_+r*z+a*P+d*j,e[i+4]=h*v+c*A+l*C+p*N,e[i+5]=h*R+c*E+l*S+p*F,e[i+6]=h*T+c*O+l*I+p*M,e[i+7]=h*_+c*z+l*P+p*j,e[i+8]=u*v+y*A+f*C+m*N,e[i+9]=u*R+y*E+f*S+m*F,e[i+10]=u*T+y*O+f*I+m*M,e[i+11]=u*_+y*z+f*P+m*j,e[i+12]=g*v+b*A+x*C+w*N,e[i+13]=g*R+b*E+x*S+w*F,e[i+14]=g*T+b*O+x*I+w*M,e[i+15]=g*_+b*z+x*P+w*j,this}equals(t){const e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;const i=this.m,n=e.m;return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]}clone(){const t=new u;return t.copyFrom(this),t}getClassName(){return"Matrix"}getHashCode(){let t=this._m[0]||0;for(let e=1;e<16;e++)t=397*t^(this._m[e]||0);return t}decompose(t,e,i){if(this._isIdentity)return i&&i.setAll(0),t&&t.setAll(1),e&&e.copyFromFloats(0,0,0,1),!0;const n=this._m;i&&i.copyFromFloats(n[12],n[13],n[14]);const s=t||m.Vector3[0];if(s.x=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),s.y=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),s.z=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),this.determinant()<=0&&(s.y*=-1),0===s.x||0===s.y||0===s.z)return e&&e.copyFromFloats(0,0,0,1),!1;if(e){const t=1/s.x,i=1/s.y,o=1/s.z;u.FromValuesToRef(n[0]*t,n[1]*t,n[2]*t,0,n[4]*i,n[5]*i,n[6]*i,0,n[8]*o,n[9]*o,n[10]*o,0,0,0,0,1,m.Matrix[0]),y.FromRotationMatrixToRef(m.Matrix[0],e)}return!0}getRow(t){if(t<0||t>3)return null;let e=4*t;return new p(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])}setRow(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)}transpose(){return u.Transpose(this)}transposeToRef(t){return u.TransposeToRef(this,t),this}setRowFromFloats(t,e,i,n,s){if(t<0||t>3)return this;let o=4*t;return this._m[o+0]=e,this._m[o+1]=i,this._m[o+2]=n,this._m[o+3]=s,this._markAsUpdated(),this}scale(t){let e=new u;return this.scaleToRef(t,e),e}scaleToRef(t,e){for(let i=0;i<16;i++)e._m[i]=this._m[i]*t;return e._markAsUpdated(),this}scaleAndAddToRef(t,e){for(let i=0;i<16;i++)e._m[i]+=this._m[i]*t;return e._markAsUpdated(),this}toNormalMatrix(t){const e=m.Matrix[0];this.invertToRef(e),e.transposeToRef(t);let i=t._m;u.FromValuesToRef(i[0],i[1],i[2],0,i[4],i[5],i[6],0,i[8],i[9],i[10],0,0,0,0,1,t)}getRotationMatrix(){let t=new u;return this.getRotationMatrixToRef(t),t}getRotationMatrixToRef(t){const e=m.Vector3[0];if(!this.decompose(e))return u.IdentityToRef(t),this;const i=this._m,n=1/e.x,s=1/e.y,o=1/e.z;return u.FromValuesToRef(i[0]*n,i[1]*n,i[2]*n,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*o,i[9]*o,i[10]*o,0,0,0,0,1,t),this}toggleModelMatrixHandInPlace(){const t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){let t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(t,e=!1,i=!1,n=!0){this.updateFlag=u._updateFlagSeed++,this._isIdentity=t,this._isIdentity3x2=t||i,this._isIdentityDirty=!this._isIdentity&&e,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n}}u._updateFlagSeed=0,u._identityReadOnly=u.Identity();class y{constructor(t=0,e=0,i=0,n=1){this.x=t,this.y=e,this.z=i,this.w=n}static FromRotationMatrix(t){let e=new y;return y.FromRotationMatrixToRef(t,e),e}static FromRotationMatrixToRef(t,e){let i,n=t.m,s=n[0],o=n[4],r=n[8],a=n[1],d=n[5],h=n[9],c=n[2],l=n[6],p=n[10],u=s+d+p;u>0?(i=.5/Math.sqrt(u+1),e.w=.25/i,e.x=(l-h)*i,e.y=(r-c)*i,e.z=(a-o)*i):s>d&&s>p?(i=2*Math.sqrt(1+s-d-p),e.w=(l-h)/i,e.x=.25*i,e.y=(o+a)/i,e.z=(r+c)/i):d>p?(i=2*Math.sqrt(1+d-s-p),e.w=(r-c)/i,e.x=(o+a)/i,e.y=.25*i,e.z=(h+l)/i):(i=2*Math.sqrt(1+p-s-d),e.w=(a-o)/i,e.x=(r+c)/i,e.y=(h+l)/i,e.z=.25*i)}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static AreClose(t,e){return y.Dot(t,e)>=0}static Zero(){return new y(0,0,0,0)}static Inverse(t){return new y(-t.x,-t.y,-t.z,t.w)}static IsIdentity(t){return t&&0===t.x&&0===t.y&&0===t.z&&1===t.w}static RotationAxis(t,e){const i=e*d;return y.RotationAxisToRef(t,i,new y)}static RotationAxisToRef(t,e,i){const n=e*d;let s=Math.sin(n/2);return t.normalize(),i.w=Math.cos(n/2),i.x=t.x*s,i.y=t.y*s,i.z=t.z*s,i}static FromArray(t,e=0){return new y(t[e],t[e+1],t[e+2],t[e+3])}static FromEulerAnglesRef(t,e,i,n){return y.RotationYawPitchRollToRef(e*d,t*d,i*d,n)}static RotationYawPitchRoll(t,e,i){let n=new y;return y.RotationYawPitchRollToRef(t,e,i,n),n}static RotationYawPitchRollToRef(t,e,i,n){let s=.5*i,o=.5*e,r=.5*t,a=Math.cos(o),d=Math.cos(r),h=Math.cos(s),c=Math.sin(o),l=Math.sin(r),p=Math.sin(s);n.x=c*d*h+a*l*p,n.y=a*l*h-c*d*p,n.z=a*d*p+c*l*h,n.w=a*d*h-c*l*p}static RotationAlphaBetaGamma(t,e,i){let n=new y;return y.RotationAlphaBetaGammaToRef(t,e,i,n),n}static RotationAlphaBetaGammaToRef(t,e,i,n){let s=.5*(i+t),o=.5*(i-t),r=.5*e;n.x=Math.cos(o)*Math.sin(r),n.y=Math.sin(o)*Math.sin(r),n.z=Math.sin(s)*Math.cos(r),n.w=Math.cos(s)*Math.cos(r)}static RotationQuaternionFromAxis(t,e,i){let n=new y(0,0,0,0);return y.RotationQuaternionFromAxisToRef(t,e,i,n),n}static RotationQuaternionFromAxisToRef(t,e,i,n){let s=m.Matrix[0];u.FromXYZAxesToRef(t.normalize(),e.normalize(),i.normalize(),s),y.FromRotationMatrixToRef(s,n)}static Slerp(t,e,i){let n=y.Identity;return y.SlerpToRef(t,e,i,n),n}static SlerpToRef(t,e,i,n){let s,o,r=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w,a=!1;if(r<0&&(a=!0,r=-r),r>.999999)o=1-i,s=a?-i:i;else{let t=Math.acos(r),e=1/Math.sin(t);o=Math.sin((1-i)*t)*e,s=a?-Math.sin(i*t)*e:Math.sin(i*t)*e}n.x=o*t.x+s*e.x,n.y=o*t.y+s*e.y,n.z=o*t.z+s*e.z,n.w=o*t.w+s*e.w}static Hermite(t,e,i,n,s){let o=s*s,r=s*o,a=2*r-3*o+1,d=-2*r+3*o,h=r-2*o+s,c=r-o,l=t.x*a+i.x*d+e.x*h+n.x*c,p=t.y*a+i.y*d+e.y*h+n.y*c,u=t.z*a+i.z*d+e.z*h+n.z*c,f=t.w*a+i.w*d+e.w*h+n.w*c;return new y(l,p,u,f)}static get Identity(){return new y(0,0,0,1)}static Angle(t,e){const i=y.Dot(t,e);return 2*Math.acos(Math.min(Math.abs(i),1))*h}static Euler(t,e,i){return y.RotationYawPitchRoll(e*d,t*d,i*d)}static LookRotation(t,e=m.staticUp){const i=f.Normalize(t),n=f.Normalize(f.Cross(e,i)),s=f.Cross(i,n);let o=n.x,r=n.y,a=n.z,d=s.x,h=s.y,c=s.z,l=i.x,p=i.y,u=i.z;const g=o+h+u;let b=new y;if(g>0){let t=Math.sqrt(g+1);return b.w=.5*t,t=.5/t,b.x=(c-p)*t,b.y=(l-a)*t,b.z=(r-d)*t,b}if(o>=h&&o>=u){let t=Math.sqrt(1+o-h-u),e=.5/t;return b.x=.5*t,b.y=(r+d)*e,b.z=(a+l)*e,b.w=(c-p)*e,b}if(h>u){let t=Math.sqrt(1+h-o-u),e=.5/t;return b.x=(d+r)*e,b.y=.5*t,b.z=(p+c)*e,b.w=(l-a)*e,b}let x=Math.sqrt(1+u-o-h),w=.5/x;return b.x=(l+a)*w,b.y=(p+c)*w,b.z=.5*x,b.w=(r-d)*w,b}static RotateTowards(t,e,i){const n=y.Angle(t,e);if(0===n)return e;const s=Math.min(1,i/n);return y.Slerp(t,e,s)}static FromToRotation(t,e){const i=new y;let n=t.normalize(),s=e.normalize(),o=f.Dot(n,s);if(o>-1+a){let t=Math.sqrt(2*(1+o)),e=1/t,r=f.Cross(n,s).scaleInPlace(e);i.set(r.x,r.y,r.z,.5*t)}else{if(o>1-a)return new y(0,0,0,1);{let t=f.Cross(f.Right(),n);t.lengthSquared()<a&&(t=f.Cross(f.Forward(),n)),i.set(t.x,t.y,t.z,0)}}return i.normalize()}get normalized(){return this.normalize()}setFromToRotation(t,e,i=m.staticUp){m.tmpMatrix=u.Zero(),u.LookAtLHToRef(t,e,i,m.tmpMatrix),m.tmpMatrix.invert(),y.FromRotationMatrixToRef(m.tmpMatrix,this)}set eulerAngles(t){this.setEuler(t.x,t.y,t.z)}get eulerAngles(){const t=new f,e=new u;this.toRotationMatrix(e);const i=u.GetAsMatrix3x3(e);return t.y=h*Math.asin(Math.max(-1,Math.min(1,i[6]))),Math.abs(i[6])<.99999?(t.x=h*Math.atan2(-i[7],i[8]),t.z=h*Math.atan2(-i[3],i[0])):(t.x=h*Math.atan2(i[5],i[4]),t.z=0),t}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)}asArray(){return[this.x,this.y,this.z,this.w]}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}clone(){return new y(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}setEuler(t,e,i){return y.RotationYawPitchRollToRef(e*d,t*d,i*d,this),this}add(t){return new y(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return new y(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}scale(t){return new y(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}multiply(t){let e=new y(0,0,0,1);return this.multiplyToRef(t,e),e}multiplyToRef(t,e){let i=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,n=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,s=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,o=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return e.copyFromFloats(i,n,s,o),this}multiplyInPlace(t){return this.multiplyToRef(t,this),this}conjugateToRef(t){return t.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new y(-this.x,-this.y,-this.z,this.w)}normalize(){let t=1/this.length;return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}angleAxis(t,e){if(0===e.lengthSquared())return y.Identity;const i=y.Identity;let n=t*d;n*=.5;let s=e.normalize();return s=e.scaleInPlace(Math.sin(n)),i.x=s.x,i.y=s.y,i.z=s.z,i.w=Math.cos(n),i.normalize()}toRotationMatrix(t){return u.FromQuaternionToRef(this,t),this}fromRotationMatrix(t){return y.FromRotationMatrixToRef(t,this),this}}class f{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}get isNonUniform(){let t=Math.abs(this.x),e=Math.abs(this.y);if(t!==e)return!0;let i=Math.abs(this.z);return t!==i||e!==i}static Add(t,e){return new f(t.x,t.y,t.z).addInPlace(e)}static GetClipFactor(t,e,i,n){let s=f.Dot(t,i)-n;return s/(s-(f.Dot(e,i)-n))}static GetAngleBetweenVectors(t,e,i){const n=t.normalizeToRef(m.Vector3[1]),s=e.normalizeToRef(m.Vector3[2]),o=f.Dot(n,s),r=m.Vector3[3];return f.CrossToRef(n,s,r),f.Dot(r,i)>0?Math.acos(o):-Math.acos(o)}static FromArray(t,e=0){return new f(t[e],t[e+1],t[e+2])}static FromFloatArray(t,e){return f.FromArray(t,e)}static FromArrayToRef(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2]}static FromFloatArrayToRef(t,e,i){return f.FromArrayToRef(t,e,i)}static FromFloatsToRef(t,e,i,n){n.copyFromFloats(t,e,i)}static Zero(){return new f(0,0,0)}static One(){return new f(1,1,1)}static Up(){return new f(0,1,0)}static Down(){return new f(0,-1,0)}static Forward(){return new f(0,0,1)}static Backward(){return new f(0,0,-1)}static Right(){return new f(1,0,0)}static Left(){return new f(-1,0,0)}static TransformCoordinates(t,e){let i=f.Zero();return f.TransformCoordinatesToRef(t,e,i),i}static TransformCoordinatesToRef(t,e,i){return f.TransformCoordinatesFromFloatsToRef(t.x,t.y,t.z,e,i)}static TransformCoordinatesFromFloatsToRef(t,e,i,n,s){const o=n.m;let r=t*o[0]+e*o[4]+i*o[8]+o[12],a=t*o[1]+e*o[5]+i*o[9]+o[13],d=t*o[2]+e*o[6]+i*o[10]+o[14],h=1/(t*o[3]+e*o[7]+i*o[11]+o[15]);s.x=r*h,s.y=a*h,s.z=d*h}static TransformNormal(t,e){let i=f.Zero();return f.TransformNormalToRef(t,e,i),i}static TransformNormalToRef(t,e,i){this.TransformNormalFromFloatsToRef(t.x,t.y,t.z,e,i)}static TransformNormalFromFloatsToRef(t,e,i,n,s){const o=n.m;s.x=t*o[0]+e*o[4]+i*o[8],s.y=t*o[1]+e*o[5]+i*o[9],s.z=t*o[2]+e*o[6]+i*o[10]}static CatmullRom(t,e,i,n,s){let o=s*s,r=s*o,a=.5*(2*e.x+(-t.x+i.x)*s+(2*t.x-5*e.x+4*i.x-n.x)*o+(-t.x+3*e.x-3*i.x+n.x)*r),d=.5*(2*e.y+(-t.y+i.y)*s+(2*t.y-5*e.y+4*i.y-n.y)*o+(-t.y+3*e.y-3*i.y+n.y)*r),h=.5*(2*e.z+(-t.z+i.z)*s+(2*t.z-5*e.z+4*i.z-n.z)*o+(-t.z+3*e.z-3*i.z+n.z)*r);return new f(a,d,h)}static Clamp(t,e,i){const n=new f;return f.ClampToRef(t,e,i,n),n}static ClampToRef(t,e,i,n){let s=t.x;s=(s=s>i.x?i.x:s)<e.x?e.x:s;let o=t.y;o=(o=o>i.y?i.y:o)<e.y?e.y:o;let r=t.z;r=(r=r>i.z?i.z:r)<e.z?e.z:r,n.copyFromFloats(s,o,r)}static Hermite(t,e,i,n,s){let o=s*s,r=s*o,a=2*r-3*o+1,d=-2*r+3*o,h=r-2*o+s,c=r-o,l=t.x*a+i.x*d+e.x*h+n.x*c,p=t.y*a+i.y*d+e.y*h+n.y*c,u=t.z*a+i.z*d+e.z*h+n.z*c;return new f(l,p,u)}static Lerp(t,e,i){let n=new f(0,0,0);return f.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.x=t.x+(e.x-t.x)*i,n.y=t.y+(e.y-t.y)*i,n.z=t.z+(e.z-t.z)*i}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static Cross(t,e){let i=f.Zero();return f.CrossToRef(t,e,i),i}static CrossToRef(t,e,i){const n=t.y*e.z-t.z*e.y,s=t.z*e.x-t.x*e.z,o=t.x*e.y-t.y*e.x;i.copyFromFloats(n,s,o)}static Normalize(t){let e=f.Zero();return f.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){t.normalizeToRef(e)}static Minimize(t,e){let i=new f(t.x,t.y,t.z);return i.minimizeInPlace(e),i}static Maximize(t,e){let i=new f(t.x,t.y,t.z);return i.maximizeInPlace(e),i}static Distance(t,e){return Math.sqrt(f.DistanceSquared(t,e))}static DistanceSquared(t,e){let i=t.x-e.x,n=t.y-e.y,s=t.z-e.z;return i*i+n*n+s*s}static Center(t,e){let i=f.Add(t,e);return i.scaleInPlace(.5),i}static RotationFromAxis(t,e,i){let n=f.Zero();return f.RotationFromAxisToRef(t,e,i,n),n}static RotationFromAxisToRef(t,e,i,n){let s=m.Quaternion[0];y.RotationQuaternionFromAxisToRef(t,e,i,s),n.copyFrom(s.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let t=this.x||0;return t=397*(t=397*t^(this.y||0))^(this.z||0)}asArray(){let t=[];return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,this}toQuaternion(){return y.Identity.setEuler(this.y,this.x,this.z)}addInPlace(t){return this.addInPlaceFromFloats(t.x,t.y,t.z)}addInPlaceFromFloats(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this}add(t){return new f(this.x+t.x,this.y+t.y,this.z+t.z)}addToRef(t,e){return e.copyFromFloats(this.x+t.x,this.y+t.y,this.z+t.z)}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subtract(t){return new f(this.x-t.x,this.y-t.y,this.z-t.z)}subtractToRef(t,e){return this.subtractFromFloatsToRef(t.x,t.y,t.z,e)}subtractFromFloats(t,e,i){return new f(this.x-t,this.y-e,this.z-i)}subtractFromFloatsToRef(t,e,i,n){return n.copyFromFloats(this.x-t,this.y-e,this.z-i)}applyMatrix4(t){this.applyMatrix4ToRef(t,this)}applyMatrix4ToRef(t,e){const{x:i,y:n,z:s}=this,{m:o}=t,r=1/(o[3]*i+o[7]*n+o[11]*s+o[15]);return e.x=(o[0]*i+o[4]*n+o[8]*s+o[12])*r,e.y=(o[1]*i+o[5]*n+o[9]*s+o[13])*r,e.z=(o[2]*i+o[6]*n+o[10]*s+o[14])*r,e}rotate(t){return this.rotateToRef(t,this)}rotateToRef(t,e){const{x:i,y:n,z:s}=this,{x:o,y:r,z:a,w:d}=t,h=d*i+r*s-a*n,c=d*n+a*i-o*s,l=d*s+o*n-r*i,p=-o*i-r*n-a*s;return e.x=h*d+p*-o+c*-a-l*-r,e.y=c*d+p*-r+l*-o-h*-a,e.z=l*d+p*-a+h*-r-c*-o,e}negate(){return new f(-this.x,-this.y,-this.z)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this}scale(t){return new f(this.x*t,this.y*t,this.z*t)}scaleToRef(t,e){return e.copyFromFloats(this.x*t,this.y*t,this.z*t)}scaleAndAddToRef(t,e){return e.addInPlaceFromFloats(this.x*t,this.y*t,this.z*t)}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z}equalsWithEpsilon(t,e=a){return t&&l.WithinEpsilon(this.x,t.x,e)&&l.WithinEpsilon(this.y,t.y,e)&&l.WithinEpsilon(this.z,t.z,e)}equalsToFloats(t,e,i){return this.x===t&&this.y===e&&this.z===i}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiply(t){return this.multiplyByFloats(t.x,t.y,t.z)}multiplyToRef(t,e){return e.copyFromFloats(this.x*t.x,this.y*t.y,this.z*t.z)}multiplyByFloats(t,e,i){return new f(this.x*t,this.y*e,this.z*i)}divide(t){return new f(this.x/t.x,this.y/t.y,this.z/t.z)}divideToRef(t,e){return e.copyFromFloats(this.x/t.x,this.y/t.y,this.z/t.z)}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.x,t.y,t.z)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.x,t.y,t.z)}minimizeInPlaceFromFloats(t,e,i){return t<this.x&&(this.x=t),e<this.y&&(this.y=e),i<this.z&&(this.z=i),this}maximizeInPlaceFromFloats(t,e,i){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),i>this.z&&(this.z=i),this}floor(){return new f(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new f(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){const t=new f(0,0,0);return this.normalizeToRef(t),t}normalizeToRef(t){let e=this.length();return 0===e||1===e?t.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/e,t)}clone(){return new f(this.x,this.y,this.z)}copyFrom(t){return this.copyFromFloats(t.x,t.y,t.z)}copyFromFloats(t,e,i){return this.x=t,this.y=e,this.z=i,this}set(t,e,i){return this.copyFromFloats(t,e,i)}setAll(t){return this.x=this.y=this.z=t,this}}const m={Vector3:Object(c.a)(6,f.Zero),Matrix:Object(c.a)(2,u.Identity),Quaternion:Object(c.a)(3,y.Zero),staticUp:f.Up(),tmpMatrix:u.Zero()};class g{}g.X=new f(1,0,0),g.Y=new f(0,1,0),g.Z=new f(0,0,1);class b{constructor(t=0,e=0,i=0,n=1){this.r=t,this.g=e,this.b=i,this.a=n}static FromHexString(t){if("#"!==t.substring(0,1)||9!==t.length)return new b(0,0,0,0);let e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16),s=parseInt(t.substring(7,9),16);return b.FromInts(e,i,n,s)}static Lerp(t,e,i){let n=new b(0,0,0,0);return b.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.r=t.r+(e.r-t.r)*i,n.g=t.g+(e.g-t.g)*i,n.b=t.b+(e.b-t.b)*i,n.a=t.a+(e.a-t.a)*i}static Red(){return new b(1,0,0,1)}static Green(){return new b(0,1,0,1)}static Blue(){return new b(0,0,1,1)}static Black(){return new b(0,0,0,1)}static White(){return new b(1,1,1,1)}static Purple(){return new b(.5,0,.5,1)}static Magenta(){return new b(1,0,1,1)}static Yellow(){return new b(1,1,0,1)}static Gray(){return new b(.5,.5,.5,1)}static Teal(){return new b(0,1,1,1)}static Clear(){return new b(0,0,0,0)}static FromColor3(t,e=1){return new b(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new b(t[e],t[e+1],t[e+2],t[e+3])}static FromInts(t,e,i,n){return new b(t/255,e/255,i/255,n/255)}static CheckColors4(t,e){if(t.length===3*e){let e=[];for(let i=0;i<t.length;i+=3){let n=i/3*4;e[n]=t[i],e[n+1]=t[i+1],e[n+2]=t[i+2],e[n+3]=1}return e}return t}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}asArray(){let t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}add(t){return new b(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new b(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this}scale(t){return new b(this.r*t,this.g*t,this.b*t,this.a*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this}clampToRef(t=0,e=1,i){return i.r=l.Clamp(this.r,t,e),i.g=l.Clamp(this.g,t,e),i.b=l.Clamp(this.b,t,e),i.a=l.Clamp(this.a,t,e),this}multiply(t){return new b(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=this.r||0;return t=397*(t=397*(t=397*t^(this.g||0))^(this.b||0))^(this.a||0)}clone(){return new b(this.r,this.g,this.b,this.a)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}toHexString(){let t=255*this.r|0,e=255*this.g|0,i=255*this.b|0,n=255*this.a|0;return"#"+l.ToHex(t)+l.ToHex(e)+l.ToHex(i)+l.ToHex(n)}toLinearSpace(){let t=new b;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,r),t.g=Math.pow(this.g,r),t.b=Math.pow(this.b,r),t.a=this.a,this}toGammaSpace(){let t=new b;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,o),t.g=Math.pow(this.g,o),t.b=Math.pow(this.b,o),t.a=this.a,this}}class x{constructor(t=0,e=0,i=0){this.r=t,this.g=e,this.b=i}static FromHexString(t){if("#"!==t.substring(0,1)||7!==t.length)return new x(0,0,0);let e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16);return x.FromInts(e,i,n)}static FromArray(t,e=0){return new x(t[e],t[e+1],t[e+2])}static FromInts(t,e,i){return new x(t/255,e/255,i/255)}static Lerp(t,e,i){let n=new x(0,0,0);return x.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.r=t.r+(e.r-t.r)*i,n.g=t.g+(e.g-t.g)*i,n.b=t.b+(e.b-t.b)*i}static Red(){return new x(1,0,0)}static Green(){return new x(0,1,0)}static Blue(){return new x(0,0,1)}static Black(){return new x(0,0,0)}static White(){return new x(1,1,1)}static Purple(){return new x(.5,0,.5)}static Magenta(){return new x(1,0,1)}static Yellow(){return new x(1,1,0)}static Gray(){return new x(.5,.5,.5)}static Teal(){return new x(0,1,1)}static Random(){return new x(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=this.r||0;return t=397*(t=397*t^(this.g||0))^(this.b||0)}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}toColor4(t=1){return new b(this.r,this.g,this.b,t)}asArray(){let t=new Array;return this.toArray(t,0),t}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(t){return new x(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,i){return this.r===t&&this.g===e&&this.b===i}scale(t){return new x(this.r*t,this.g*t,this.b*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this}clampToRef(t=0,e=1,i){return i.r=l.Clamp(this.r,t,e),i.g=l.Clamp(this.g,t,e),i.b=l.Clamp(this.b,t,e),this}add(t){return new x(this.r+t.r,this.g+t.g,this.b+t.b)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this}subtract(t){return new x(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this}clone(){return new x(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,i){return this.r=t,this.g=e,this.b=i,this}set(t,e,i){return this.copyFromFloats(t,e,i)}toHexString(){let t=255*this.r|0,e=255*this.g|0,i=255*this.b|0;return"#"+l.ToHex(t)+l.ToHex(e)+l.ToHex(i)}toLinearSpace(){let t=new x;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,r),t.g=Math.pow(this.g,r),t.b=Math.pow(this.b,r),this}toGammaSpace(){let t=new x;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,o),t.g=Math.pow(this.g,o),t.b=Math.pow(this.b,o),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}i.d(e,"c",(function(){return m})),i.d(e,"a",(function(){return x})),i.d(e,"b",(function(){return b})),i.d(e,"d",(function(){return u})),i.d(e,"e",(function(){return y})),i.d(e,"f",(function(){return f})),i.d(e,"c",(function(){return m})),i.d(e,"a",(function(){return x})),i.d(e,"b",(function(){return b})),i.d(e,"d",(function(){return u})),i.d(e,"e",(function(){return y})),i.d(e,"f",(function(){return f}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return v})),i.d(e,"b",(function(){return z}));var n,s=i(0),o=i(1),r=i(12),a=i(3),d=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},h=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t[t.TRANSFORM=1]="TRANSFORM",t[t.UUID_CALLBACK=8]="UUID_CALLBACK",t[t.BOX_SHAPE=16]="BOX_SHAPE",t[t.SPHERE_SHAPE=17]="SPHERE_SHAPE",t[t.PLANE_SHAPE=18]="PLANE_SHAPE",t[t.CONE_SHAPE=19]="CONE_SHAPE",t[t.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",t[t.TEXT_SHAPE=21]="TEXT_SHAPE",t[t.NFT_SHAPE=22]="NFT_SHAPE",t[t.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",t[t.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",t[t.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",t[t.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",t[t.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",t[t.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",t[t.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",t[t.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",t[t.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",t[t.BILLBOARD=32]="BILLBOARD",t[t.ANIMATION=33]="ANIMATION",t[t.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",t[t.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",t[t.GLTF_SHAPE=54]="GLTF_SHAPE",t[t.OBJ_SHAPE=55]="OBJ_SHAPE",t[t.AVATAR_SHAPE=56]="AVATAR_SHAPE",t[t.BASIC_MATERIAL=64]="BASIC_MATERIAL",t[t.PBR_MATERIAL=65]="PBR_MATERIAL",t[t.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",t[t.SOUND=67]="SOUND",t[t.TEXTURE=68]="TEXTURE",t[t.AUDIO_CLIP=200]="AUDIO_CLIP",t[t.AUDIO_SOURCE=201]="AUDIO_SOURCE",t[t.GIZMOS=203]="GIZMOS"}(n||(n={}));let c=class extends s.f{constructor(t={}){super(),this.position=t.position||o.f.Zero(),this.rotation=t.rotation||o.e.Identity,this.scale=t.scale||new o.f(1,1,1)}get eulerAngles(){return this.rotation.eulerAngles}lookAt(t,e=o.c.staticUp){const i=new o.d;return o.d.LookAtLHToRef(this.position,t,e,i),i.invert(),o.e.FromRotationMatrixToRef(i,this.rotation),this}rotate(t,e){return this.rotation.multiplyInPlace(this.rotation.angleAxis(e,t)),this}translate(t){return this.position.addInPlace(t),this}};d([s.f.field,h("design:type",o.f)],c.prototype,"position",void 0),d([s.f.field,h("design:type",o.e)],c.prototype,"rotation",void 0),d([s.f.field,h("design:type",o.f)],c.prototype,"scale",void 0),c=d([Object(s.a)("engine.transform",n.TRANSFORM),h("design:paramtypes",[Object])],c);let l=class extends s.f{constructor(t=!0,e=!0,i=!0){super(),this.x=!0,this.y=!0,this.z=!0,this.x=t,this.y=e,this.z=i}};d([s.f.field,h("design:type",Boolean)],l.prototype,"x",void 0),d([s.f.field,h("design:type",Boolean)],l.prototype,"y",void 0),d([s.f.field,h("design:type",Boolean)],l.prototype,"z",void 0),l=d([Object(s.a)("engine.billboard",n.BILLBOARD),h("design:paramtypes",[Boolean,Boolean,Boolean])],l);class p extends s.f{constructor(){super(...arguments),this.withCollisions=!0,this.visible=!0}}d([s.f.field,h("design:type",Boolean)],p.prototype,"withCollisions",void 0),d([s.f.field,h("design:type",Boolean)],p.prototype,"visible",void 0);let u=class extends p{};u=d([Object(s.b)("engine.shape",n.BOX_SHAPE)],u);let y=class extends p{};y=d([Object(s.b)("engine.shape",n.SPHERE_SHAPE)],y);let f=class extends p{};d([s.f.field,h("design:type",Number)],f.prototype,"segments",void 0),d([s.f.field,h("design:type",Number)],f.prototype,"arc",void 0),f=d([Object(s.b)("engine.shape",n.CIRCLE_SHAPE)],f);let m=class extends p{constructor(){super(...arguments),this.width=1,this.height=1}};d([s.f.field,h("design:type",Number)],m.prototype,"width",void 0),d([s.f.field,h("design:type",Number)],m.prototype,"height",void 0),d([s.f.field,h("design:type",Array)],m.prototype,"uvs",void 0),m=d([Object(s.b)("engine.shape",n.PLANE_SHAPE)],m);let g=class extends p{constructor(){super(...arguments),this.radiusTop=0,this.radiusBottom=1,this.segmentsHeight=1,this.segmentsRadial=36,this.openEnded=!1,this.radius=null,this.arc=360}};d([s.f.field,h("design:type",Number)],g.prototype,"radiusTop",void 0),d([s.f.field,h("design:type",Number)],g.prototype,"radiusBottom",void 0),d([s.f.field,h("design:type",Number)],g.prototype,"segmentsHeight",void 0),d([s.f.field,h("design:type",Number)],g.prototype,"segmentsRadial",void 0),d([s.f.field,h("design:type",Boolean)],g.prototype,"openEnded",void 0),d([s.f.field,h("design:type",Object)],g.prototype,"radius",void 0),d([s.f.field,h("design:type",Number)],g.prototype,"arc",void 0),g=d([Object(s.b)("engine.shape",n.CONE_SHAPE)],g);let b=class extends p{constructor(){super(...arguments),this.radiusTop=0,this.radiusBottom=1,this.segmentsHeight=1,this.segmentsRadial=36,this.openEnded=!1,this.radius=null,this.arc=360}};d([s.f.field,h("design:type",Number)],b.prototype,"radiusTop",void 0),d([s.f.field,h("design:type",Number)],b.prototype,"radiusBottom",void 0),d([s.f.field,h("design:type",Number)],b.prototype,"segmentsHeight",void 0),d([s.f.field,h("design:type",Number)],b.prototype,"segmentsRadial",void 0),d([s.f.field,h("design:type",Boolean)],b.prototype,"openEnded",void 0),d([s.f.field,h("design:type",Object)],b.prototype,"radius",void 0),d([s.f.field,h("design:type",Number)],b.prototype,"arc",void 0),b=d([Object(s.b)("engine.shape",n.CYLINDER_SHAPE)],b);let x=class extends p{constructor(t){super(),this.src=t}};d([p.readonly,h("design:type",String)],x.prototype,"src",void 0),x=d([Object(s.b)("engine.shape",n.GLTF_SHAPE),h("design:paramtypes",[String])],x);let w=class extends p{constructor(t,e=new o.a(.6404918,.611472,.8584906)){super(),this.src=t,this.color=e}};d([p.readonly,h("design:type",String)],w.prototype,"src",void 0),d([s.f.field,h("design:type",o.a)],w.prototype,"color",void 0),w=d([Object(s.b)("engine.shape",n.NFT_SHAPE),h("design:paramtypes",[String,o.a])],w);let v=class extends s.f{constructor(t,e){if(super(),this.src=t,e)for(let t in e){this[t]=e[t]}}};d([s.f.readonly,h("design:type",String)],v.prototype,"src",void 0),d([s.f.readonly,h("design:type",Number)],v.prototype,"samplingMode",void 0),d([s.f.readonly,h("design:type",Number)],v.prototype,"wrap",void 0),d([s.f.readonly,h("design:type",Boolean)],v.prototype,"hasAlpha",void 0),v=d([Object(s.b)("engine.texture",n.TEXTURE),h("design:paramtypes",[String,Object])],v);let R=class extends p{constructor(){super(...arguments),this.states=[]}addClip(t){return this.states.push(t),t.onChange(()=>{this.dirty=!0}),this}getClip(t){for(let e=0;e<this.states.length;e++){const i=this.states[e];if(i.clip===t)return i}const e=new r.a(t);return this.addClip(e),e}};d([s.f.readonly,h("design:type",Array)],R.prototype,"states",void 0),R=d([Object(s.a)("engine.animator",n.ANIMATION)],R);let T=class extends p{constructor(t){super(),this.src=t}};d([s.f.readonly,h("design:type",String)],T.prototype,"src",void 0),T=d([Object(s.b)("engine.shape",n.OBJ_SHAPE),h("design:paramtypes",[String])],T);let _=class extends p{constructor(t){super(),this.outlineWidth=0,this.outlineColor=new o.a(1,1,1),this.color=new o.a(1,1,1),this.fontSize=10,this.fontWeight="normal",this.opacity=1,this.value="",this.lineSpacing="0px",this.lineCount=0,this.resizeToFit=!1,this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=new o.a(1,1,1),this.zIndex=0,this.hTextAlign="center",this.vTextAlign="center",this.width=1,this.height=1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.isPickable=!1,this.billboard=!1,t&&(this.value=t)}};var A;d([s.f.field,h("design:type",Number)],_.prototype,"outlineWidth",void 0),d([s.f.field,h("design:type",o.a)],_.prototype,"outlineColor",void 0),d([s.f.field,h("design:type",o.a)],_.prototype,"color",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"fontSize",void 0),d([s.f.field,h("design:type",String)],_.prototype,"fontWeight",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"opacity",void 0),d([s.f.field,h("design:type",String)],_.prototype,"value",void 0),d([s.f.field,h("design:type",String)],_.prototype,"lineSpacing",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"lineCount",void 0),d([s.f.field,h("design:type",Boolean)],_.prototype,"resizeToFit",void 0),d([s.f.field,h("design:type",Boolean)],_.prototype,"textWrapping",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"shadowBlur",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"shadowOffsetX",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"shadowOffsetY",void 0),d([s.f.field,h("design:type",o.a)],_.prototype,"shadowColor",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"zIndex",void 0),d([s.f.field,h("design:type",String)],_.prototype,"hTextAlign",void 0),d([s.f.field,h("design:type",String)],_.prototype,"vTextAlign",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"width",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"height",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"paddingTop",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"paddingRight",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"paddingBottom",void 0),d([s.f.field,h("design:type",Number)],_.prototype,"paddingLeft",void 0),d([s.f.field,h("design:type",Boolean)],_.prototype,"isPickable",void 0),d([s.f.field,h("design:type",Boolean)],_.prototype,"billboard",void 0),_=d([Object(s.a)("engine.text",n.TEXT_SHAPE),h("design:paramtypes",[String])],_),function(t){t[t.OPAQUE=0]="OPAQUE",t[t.ALPHA_TEST=1]="ALPHA_TEST",t[t.ALPHA_BLEND=2]="ALPHA_BLEND",t[t.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",t[t.AUTO=4]="AUTO"}(A||(A={}));let E=class extends s.f{constructor(){super(...arguments),this.alphaTest=.5,this.transparencyMode=A.AUTO}};d([s.f.field,h("design:type",Number)],E.prototype,"alphaTest",void 0),d([s.f.field,h("design:type",Object)],E.prototype,"albedoColor",void 0),d([s.f.field,h("design:type",o.a)],E.prototype,"emissiveColor",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"metallic",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"roughness",void 0),d([s.f.field,h("design:type",o.a)],E.prototype,"ambientColor",void 0),d([s.f.field,h("design:type",o.a)],E.prototype,"reflectionColor",void 0),d([s.f.field,h("design:type",o.a)],E.prototype,"reflectivityColor",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"directIntensity",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"microSurface",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"emissiveIntensity",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"environmentIntensity",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"specularIntensity",void 0),d([s.f.component,h("design:type",v)],E.prototype,"albedoTexture",void 0),d([s.f.component,h("design:type",v)],E.prototype,"alphaTexture",void 0),d([s.f.component,h("design:type",v)],E.prototype,"emissiveTexture",void 0),d([s.f.component,h("design:type",v)],E.prototype,"bumpTexture",void 0),d([s.f.component,h("design:type",v)],E.prototype,"refractionTexture",void 0),d([s.f.field,h("design:type",Boolean)],E.prototype,"disableLighting",void 0),d([s.f.field,h("design:type",Number)],E.prototype,"transparencyMode",void 0),E=d([Object(s.b)("engine.material",n.PBR_MATERIAL)],E);let O=class extends s.f{constructor(){super(...arguments),this.alphaTest=.5}};d([s.f.component,h("design:type",v)],O.prototype,"texture",void 0),d([s.f.field,h("design:type",Number)],O.prototype,"alphaTest",void 0),O=d([Object(s.b)("engine.material",n.BASIC_MATERIAL)],O);class z extends s.f{constructor(t){if(super(),this.uuid=Object(a.d)("UUID"),!(t&&"apply"in t&&"call"in t))throw new Error("Callback is not a function");this.callback=t}static uuidEvent(t,e){if(delete t[e]){const i=e+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(t,i)),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[i]},set:function(t){const n=this[i];if(t){if(!(t instanceof z))throw new Error("value is not an OnUUIDEvent");this.data[e]=t.uuid}else this.data[e]=null;if(this[i]=t,t!==n){this.dirty=!0;for(let i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})}}toJSON(){return{uuid:this.uuid,type:this.type}}}d([s.f.field,h("design:type",Function)],z.prototype,"callback",void 0);let C=class extends z{constructor(){super(...arguments),this.type="onPointerLock"}};d([s.f.readonly,h("design:type",String)],C.prototype,"type",void 0),C=d([Object(s.a)("engine.onPointerLock",n.UUID_CALLBACK)],C);let S=class extends z{constructor(){super(...arguments),this.type="onAnimationEnd"}};d([s.f.readonly,h("design:type",String)],S.prototype,"type",void 0),S=d([Object(s.a)("engine.onAnimationEnd",n.UUID_CALLBACK)],S)},function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return o})),i.d(e,"d",(function(){return r})),i.d(e,"e",(function(){return a})),i.d(e,"a",(function(){return d}));let n=0;function s(...t){"undefined"!=typeof dcl?dcl.log(...t):console.log("DEBUG:",...t)}function o(t,e){"undefined"!=typeof dcl?dcl.error(t,e):console.error("ERROR:",t,e)}function r(t){if(n++,0===t.length)throw new Error("newId(type: string): type cannot be empty");return t+n.toString(36)}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){let e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function d(t,e){const i=[];for(let n=0;n<t;++n)i.push(e());return i}},function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return d}));var n=i(5),s=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},o=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let r=class{constructor(t,e,i){this.entity=t,this.componentName=e,this.component=i}};r=s([Object(n.a)(),o("design:paramtypes",[Object,String,Object])],r);let a=class{constructor(t,e,i){this.entity=t,this.componentName=e,this.classId=i}};a=s([Object(n.a)(),o("design:paramtypes",[Object,String,Object])],a);let d=class{constructor(t,e){this.entity=t,this.parent=e}};d=s([Object(n.a)(),o("design:paramtypes",[Object,Object])],d)},function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return d}));var n=i(3);const s="__event_name__",o=[];function r(t){if(!(s in t)||"string"!=typeof t[s])throw new Error("The EventConstructor is not registered");return t[s]}class a{constructor(){this.listeners={}}addListener(t,e,i){if(!t||"function"!=typeof t)throw new Error("Invalid EventConstructor");const n=r(t);let s=this.listeners[n];s||(s=this.listeners[n]=[]);for(let t=0;t<s.length;t++){if(s[t].listener===e)throw new Error("The provided listener is already registered")}return s.push({listener:e,fn:i}),this}removeListener(t,e){if(!e||"function"!=typeof e)throw new Error("Invalid EventConstructor");const i=r(e);let n=this.listeners[i];if(!n)return!1;for(let e=0;e<n.length;e++){if(n[e].listener===t)return n.splice(e,1),!0}return!1}fireEvent(t){const e=r(t.constructor);let i=this.listeners[e];if(i)for(let e=0;e<i.length;e++)try{const n=i[e];n.fn.call(n.listener,t)}catch(t){Object(n.b)(t)}return this}}function d(){const t=Object(n.d)("EV");if(-1!==o.indexOf(t))throw new Error(`The event name ${t} is already taken`);return o.push(t),e=>(e[s]=t,e)}},function(t,e,i){"use strict";i.d(e,"b",(function(){return d})),i.d(e,"a",(function(){return h})),i.d(e,"c",(function(){return c}));var n=i(8),s=i(2),o=i(4),r=i(13),a=i(9);const d=new class{activate(t){t.eventManager.addListener(n.b,this,t=>{"HitFirst"===t.payload.queryType?a.a.instance.handleRaycastHitFirstResponse(t):"HitAll"===t.payload.queryType&&a.a.instance.handleRaycastHitAllResponse(t)}),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")}deactivate(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")}};const h=new class{activate(t){t.eventManager.addListener(n.a,this,t=>{r.a.instance.handlePointerEvent(t.payload)}),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("pointerEvent"))}deactivate(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("pointerEvent"))}};const c=new class{constructor(){this.handlerMap={}}activate(t){t.eventManager.addListener(n.c,this,this.handleEvent),t.eventManager.addListener(o.a,this,this.componentAdded),t.eventManager.addListener(o.b,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")}deactivate(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")}onAddEntity(t){for(let e in t.components){const i=t.components[e];i instanceof s.b&&(this.handlerMap[i.uuid]=i)}}onRemoveEntity(t){for(let e in t.components){const i=t.components[e];i instanceof s.b&&delete this.handlerMap[i.uuid]}}componentAdded(t){if(t.entity.isAddedToEngine()){const e=t.entity.components[t.componentName];e instanceof s.b&&(this.handlerMap[e.uuid]=e)}}componentRemoved(t){t.entity.isAddedToEngine()&&t.component instanceof s.b&&delete this.handlerMap[t.component.uuid]}handleEvent(t){if(t.uuid in this.handlerMap){const e=this.handlerMap[t.uuid];e&&e.callback&&"call"in e.callback&&e.callback(t.payload)}}}},function(t,e,i){"use strict";var n=i(4),s=i(0),o=i(5);class r{constructor(...t){if(this.entities=[],this.active=!1,this._requiresNames=[],!t)throw new Error("ComponentGroup: Could not load the requires list");if(!(t instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return t.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(let e=0;e<t.length;e++){const i=t[e];let n=null;if(!i)throw new Error(`ComponentGroup: the required component at location ${e} is invalid`);try{n=Object(s.i)(i)}catch(t){throw new Error(`ComponentGroup: the required component at location ${e} is not registered as a @Component. Remember to provide the class of the component, not the name`)}if(this._requiresNames.some(t=>t===n))throw new Error(`ComponentGroup: the required component list has a repeated name ${n}`);this._requiresNames.push(n)}}hasEntity(t){return!!t.isAddedToEngine()&&-1!==this.entities.indexOf(t)}addEntity(t){if(!t.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(t)&&this.entities.push(t)}removeEntity(t){const e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)}componentRemoved(t,e){-1!==this._requiresNames.indexOf(e)&&this.removeEntity(t)}meetsRequirements(t){for(let e=0;e<this._requiresNames.length;e++){if(!(this._requiresNames[e]in t.components))return!1}return!0}}var a=i(3);Promise.resolve().then.bind(Promise.resolve());i(11);var d=i(8);const h="0";class c{constructor(t){this.dcl=t,this.cachedComponents={}}activate(t){this.engine=t,t.eventManager.addListener(n.a,this,this.componentAdded),t.eventManager.addListener(n.b,this,this.componentRemoved),t.eventManager.addListener(s.c,this,this.disposableComponentCreated),t.eventManager.addListener(s.d,this,this.disposableComponentRemoved),t.eventManager.addListener(s.e,this,this.disposableComponentUpdated),t.eventManager.addListener(n.c,this,this.parentChanged);const e=t.rootEntity.uuid;this.dcl.addEntity(e),this.dcl.onUpdate(e=>{t.update(e),this.presentEntities()}),this.dcl.onEvent(e=>{const i=e.data;switch(e.type){case"uuidEvent":t.eventManager.fireEvent(new d.c(i.uuid,i.payload));break;case"raycastResponse":"HitFirst"===i.queryType?t.eventManager.fireEvent(new d.b(i)):"HitAll"===i.queryType&&t.eventManager.fireEvent(new d.b(i));break;case"pointerEvent":t.eventManager.fireEvent(new d.a(i.payload))}})}onAddEntity(t){if(t&&t.isAddedToEngine()){const e=t.uuid,i=t.getParent();this.dcl.addEntity(e),i&&this.dcl.setParent(e,i.uuid),this.cachedComponents[e]={};for(let i in t.components){const n=t.components[i],o=Object(s.g)(n);if(null!==o)if(Object(s.j)(n))this.dcl.attachEntityComponent(t.uuid,i,Object(s.h)(n));else{const t=JSON.stringify(n);this.dcl.updateEntityComponent(e,i,o,t),this.cachedComponents[e][i]=t}}}}onRemoveEntity(t){if(t.isAddedToEngine()){const e=t.uuid;this.dcl.removeEntity(e),delete this.cachedComponents[e]}}presentEntities(){for(let t in this.engine.entities){const e=this.engine.entities[t],i=e.uuid;for(let t in e.components){const n=e.components[t],o=Object(s.g)(n);if(null!==o&&!Object(s.j)(n)){const s=JSON.stringify(n);this.cachedComponents[i][t]!==s&&(this.dcl.updateEntityComponent(e.uuid,t,o,s),this.cachedComponents[i][t]=s)}}}for(let t in this.engine.disposableComponents){const e=this.engine.disposableComponents[t];e instanceof s.f&&e.dirty&&(this.dcl.componentUpdated(t,JSON.stringify(e)),e.dirty=!1)}}componentAdded(t){if(t.entity.isAddedToEngine()){const e=t.entity.components[t.componentName];if(Object(s.j)(e))this.dcl.attachEntityComponent(t.entity.uuid,t.componentName,Object(s.h)(e));else if(null!==t.classId){const i=JSON.stringify(e);this.dcl.updateEntityComponent(t.entity.uuid,t.componentName,t.classId,i),this.cachedComponents[t.entity.uuid][t.componentName]=i}}}componentRemoved(t){t.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(t.entity.uuid,t.componentName),delete this.cachedComponents[t.entity.uuid][t.componentName])}disposableComponentCreated(t){this.dcl.componentCreated(t.componentId,t.componentName,t.classId)}disposableComponentRemoved(t){this.dcl.componentDisposed(t.componentId)}disposableComponentUpdated(t){this.dcl.componentUpdated(t.componentId,JSON.stringify(t.component))}parentChanged(t){this.dcl.setParent(t.entity.uuid,t.parent?t.parent.uuid:h)}}var l=i(6),p=(i(14),i(2)),u=(i(10),i(1)),y=(i(12),i(13),function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r}),f=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let m=class extends s.f{constructor(t){super(),this.loop=!1,this.volume=1,this.url=t}};y([s.f.readonly,f("design:type",String)],m.prototype,"url",void 0),y([s.f.field,f("design:type",Boolean)],m.prototype,"loop",void 0),y([s.f.field,f("design:type",String)],m.prototype,"loadingCompleteEventId",void 0),y([s.f.field,f("design:type",Number)],m.prototype,"volume",void 0),m=y([Object(s.b)("engine.AudioClip",p.a.AUDIO_CLIP),f("design:paramtypes",[String])],m);let g=class extends s.f{constructor(t){if(super(),this.audioClip=t,this.loop=!1,this.volume=1,this.playing=!1,this.pitch=1,!(t instanceof m))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");this.audioClipId=Object(s.h)(t)}playOnce(){return this.playing=!0,this.dirty=!0,this.data.nonce=Math.random(),this}};y([s.f.readonly,f("design:type",String)],g.prototype,"audioClipId",void 0),y([s.f.field,f("design:type",Boolean)],g.prototype,"loop",void 0),y([s.f.field,f("design:type",Number)],g.prototype,"volume",void 0),y([s.f.field,f("design:type",Boolean)],g.prototype,"playing",void 0),y([s.f.field,f("design:type",Number)],g.prototype,"pitch",void 0),g=y([Object(s.a)("engine.AudioSource",p.a.AUDIO_SOURCE),f("design:paramtypes",[m])],g);var b,x=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},w=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t.MOVE="MOVE",t.ROTATE="ROTATE",t.SCALE="SCALE",t.NONE="NONE"}(b||(b={}));let v=class extends p.b{constructor(){super(...arguments),this.type="gizmoEvent"}};x([s.f.readonly,w("design:type",String)],v.prototype,"type",void 0),v=x([Object(s.a)("engine.gizmoEvent",p.a.UUID_CALLBACK)],v);let R=class extends s.f{constructor(){super(...arguments),this.position=!0,this.rotation=!0,this.scale=!0,this.cycle=!0,this.localReference=!1}};x([s.f.field,w("design:type",Boolean)],R.prototype,"position",void 0),x([s.f.field,w("design:type",Boolean)],R.prototype,"rotation",void 0),x([s.f.field,w("design:type",Boolean)],R.prototype,"scale",void 0),x([s.f.field,w("design:type",Boolean)],R.prototype,"cycle",void 0),x([s.f.field,w("design:type",String)],R.prototype,"selectedGizmo",void 0),x([s.f.field,w("design:type",Boolean)],R.prototype,"localReference",void 0),R=x([Object(s.a)("engine.gizmos",p.a.GIZMOS)],R);var T=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},_=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class A extends s.f{constructor(t){super(),this.name=null,this.visible=!0,this.opacity=1,this.hAlign="center",this.vAlign="center",this.width="100px",this.height="50px",this.positionX="0px",this.positionY="0px",this.isPointerBlocker=!0,t&&(this._parent=t,this.data.parentComponent=Object(s.h)(t))}get parent(){return this._parent}get parentComponent(){return this.data.parentComponent}}T([s.f.field,_("design:type",Object)],A.prototype,"name",void 0),T([s.f.field,_("design:type",Boolean)],A.prototype,"visible",void 0),T([s.f.field,_("design:type",Number)],A.prototype,"opacity",void 0),T([s.f.field,_("design:type",String)],A.prototype,"hAlign",void 0),T([s.f.field,_("design:type",String)],A.prototype,"vAlign",void 0),T([s.f.uiValue,_("design:type",Object)],A.prototype,"width",void 0),T([s.f.uiValue,_("design:type",Object)],A.prototype,"height",void 0),T([s.f.uiValue,_("design:type",Object)],A.prototype,"positionX",void 0),T([s.f.uiValue,_("design:type",Object)],A.prototype,"positionY",void 0),T([s.f.field,_("design:type",Boolean)],A.prototype,"isPointerBlocker",void 0);let E=class extends A{constructor(){super(null)}};E=T([Object(s.b)("engine.shape",p.a.UI_FULLSCREEN_SHAPE),_("design:paramtypes",[])],E);let O=class extends A{constructor(){super(null)}};O=T([Object(s.b)("engine.shape",p.a.UI_WORLD_SPACE_SHAPE),_("design:paramtypes",[])],O);let z=class extends A{constructor(){super(null)}};z=T([Object(s.b)("engine.shape",p.a.UI_SCREEN_SPACE_SHAPE),_("design:paramtypes",[])],z);let C=class extends A{constructor(){super(...arguments),this.adaptWidth=!1,this.adaptHeight=!1,this.thickness=0,this.color=u.b.Clear(),this.alignmentUsesSize=!0}};var S;T([s.f.field,_("design:type",Boolean)],C.prototype,"adaptWidth",void 0),T([s.f.field,_("design:type",Boolean)],C.prototype,"adaptHeight",void 0),T([s.f.field,_("design:type",Number)],C.prototype,"thickness",void 0),T([s.f.field,_("design:type",u.b)],C.prototype,"color",void 0),T([s.f.field,_("design:type",Boolean)],C.prototype,"alignmentUsesSize",void 0),C=T([Object(s.b)("engine.shape",p.a.UI_CONTAINER_RECT)],C),function(t){t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL"}(S||(S={}));let I=class extends A{constructor(){super(...arguments),this.adaptWidth=!0,this.adaptHeight=!0,this.color=u.b.Clear(),this.stackOrientation=S.VERTICAL,this.spacing=0}};T([s.f.field,_("design:type",Boolean)],I.prototype,"adaptWidth",void 0),T([s.f.field,_("design:type",Boolean)],I.prototype,"adaptHeight",void 0),T([s.f.field,_("design:type",u.b)],I.prototype,"color",void 0),T([s.f.field,_("design:type",Number)],I.prototype,"stackOrientation",void 0),T([s.f.field,_("design:type",Number)],I.prototype,"spacing",void 0),I=T([Object(s.b)("engine.shape",p.a.UI_CONTAINER_STACK)],I);let P=class extends A{constructor(){super(...arguments),this.fontSize=10,this.fontWeight="normal",this.thickness=0,this.cornerRadius=0,this.color=u.b.White(),this.background=u.b.White(),this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=u.b.Black(),this.text="button"}};T([s.f.field,_("design:type",Number)],P.prototype,"fontSize",void 0),T([s.f.field,_("design:type",String)],P.prototype,"fontWeight",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"thickness",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"cornerRadius",void 0),T([s.f.field,_("design:type",u.b)],P.prototype,"color",void 0),T([s.f.field,_("design:type",u.b)],P.prototype,"background",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"paddingTop",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"paddingRight",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"paddingBottom",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"paddingLeft",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"shadowBlur",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"shadowOffsetX",void 0),T([s.f.field,_("design:type",Number)],P.prototype,"shadowOffsetY",void 0),T([s.f.field,_("design:type",u.b)],P.prototype,"shadowColor",void 0),T([s.f.field,_("design:type",String)],P.prototype,"text",void 0),P=T([Object(s.b)("engine.shape",p.a.UI_BUTTON_SHAPE)],P);let N=class extends A{constructor(){super(...arguments),this.outlineWidth=0,this.outlineColor=u.b.White(),this.color=u.b.White(),this.fontSize=10,this.fontAutoSize=!1,this.fontWeight="normal",this.value="",this.lineSpacing=0,this.lineCount=0,this.adaptWidth=!1,this.adaptHeight=!1,this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=u.b.Black(),this.hTextAlign="left",this.vTextAlign="bottom",this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0}};T([s.f.field,_("design:type",Number)],N.prototype,"outlineWidth",void 0),T([s.f.field,_("design:type",u.b)],N.prototype,"outlineColor",void 0),T([s.f.field,_("design:type",u.b)],N.prototype,"color",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"fontSize",void 0),T([s.f.field,_("design:type",Boolean)],N.prototype,"fontAutoSize",void 0),T([s.f.field,_("design:type",String)],N.prototype,"fontWeight",void 0),T([s.f.field,_("design:type",String)],N.prototype,"value",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"lineSpacing",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"lineCount",void 0),T([s.f.field,_("design:type",Boolean)],N.prototype,"adaptWidth",void 0),T([s.f.field,_("design:type",Boolean)],N.prototype,"adaptHeight",void 0),T([s.f.field,_("design:type",Boolean)],N.prototype,"textWrapping",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"shadowBlur",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"shadowOffsetX",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"shadowOffsetY",void 0),T([s.f.field,_("design:type",u.b)],N.prototype,"shadowColor",void 0),T([s.f.field,_("design:type",String)],N.prototype,"hTextAlign",void 0),T([s.f.field,_("design:type",String)],N.prototype,"vTextAlign",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"paddingTop",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"paddingRight",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"paddingBottom",void 0),T([s.f.field,_("design:type",Number)],N.prototype,"paddingLeft",void 0),N=T([Object(s.b)("engine.shape",p.a.UI_TEXT_SHAPE)],N);let F=class extends A{constructor(){super(...arguments),this.outlineWidth=0,this.outlineColor=u.b.Black(),this.color=u.b.Clear(),this.thickness=1,this.fontSize=10,this.fontWeight="normal",this.value="",this.placeholderColor=u.b.White(),this.placeholder="",this.margin=10,this.maxWidth=100,this.hTextAlign="left",this.vTextAlign="bottom",this.autoStretchWidth=!0,this.background=u.b.Black(),this.focusedBackground=u.b.Black(),this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=u.b.White(),this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.onTextSubmit=null,this.onChanged=null,this.onFocus=null,this.onBlur=null}};T([s.f.field,_("design:type",Number)],F.prototype,"outlineWidth",void 0),T([s.f.field,_("design:type",u.b)],F.prototype,"outlineColor",void 0),T([s.f.field,_("design:type",u.b)],F.prototype,"color",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"thickness",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"fontSize",void 0),T([s.f.field,_("design:type",String)],F.prototype,"fontWeight",void 0),T([s.f.field,_("design:type",String)],F.prototype,"value",void 0),T([s.f.field,_("design:type",u.b)],F.prototype,"placeholderColor",void 0),T([s.f.field,_("design:type",String)],F.prototype,"placeholder",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"margin",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"maxWidth",void 0),T([s.f.field,_("design:type",String)],F.prototype,"hTextAlign",void 0),T([s.f.field,_("design:type",String)],F.prototype,"vTextAlign",void 0),T([s.f.field,_("design:type",Boolean)],F.prototype,"autoStretchWidth",void 0),T([s.f.field,_("design:type",u.b)],F.prototype,"background",void 0),T([s.f.field,_("design:type",u.b)],F.prototype,"focusedBackground",void 0),T([s.f.field,_("design:type",Boolean)],F.prototype,"textWrapping",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"shadowBlur",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"shadowOffsetX",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"shadowOffsetY",void 0),T([s.f.field,_("design:type",u.b)],F.prototype,"shadowColor",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"paddingTop",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"paddingRight",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"paddingBottom",void 0),T([s.f.field,_("design:type",Number)],F.prototype,"paddingLeft",void 0),T([p.b.uuidEvent,_("design:type",Object)],F.prototype,"onTextSubmit",void 0),T([p.b.uuidEvent,_("design:type",Object)],F.prototype,"onChanged",void 0),T([p.b.uuidEvent,_("design:type",Object)],F.prototype,"onFocus",void 0),T([p.b.uuidEvent,_("design:type",Object)],F.prototype,"onBlur",void 0),F=T([Object(s.b)("engine.shape",p.a.UI_INPUT_TEXT_SHAPE)],F);let M=class extends A{constructor(t,e){super(t),this.sourceLeft=0,this.sourceTop=0,this.sourceWidth=1,this.sourceHeight=1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.sizeInPixels=!0,this.onClick=null,this.source=e}};T([s.f.field,_("design:type",Number)],M.prototype,"sourceLeft",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"sourceTop",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"sourceWidth",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"sourceHeight",void 0),T([s.f.component,_("design:type",p.c)],M.prototype,"source",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"paddingTop",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"paddingRight",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"paddingBottom",void 0),T([s.f.field,_("design:type",Number)],M.prototype,"paddingLeft",void 0),T([s.f.field,_("design:type",Boolean)],M.prototype,"sizeInPixels",void 0),T([p.b.uuidEvent,_("design:type",Object)],M.prototype,"onClick",void 0),M=T([Object(s.b)("engine.shape",p.a.UI_IMAGE_SHAPE),_("design:paramtypes",[A,p.c])],M);let j=class extends A{constructor(){super(...arguments),this.valueX=0,this.valueY=0,this.borderColor=u.b.White(),this.backgroundColor=u.b.Clear(),this.isHorizontal=!1,this.isVertical=!1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.onChanged=null}};T([s.f.field,_("design:type",Number)],j.prototype,"valueX",void 0),T([s.f.field,_("design:type",Number)],j.prototype,"valueY",void 0),T([s.f.field,_("design:type",u.b)],j.prototype,"borderColor",void 0),T([s.f.field,_("design:type",u.b)],j.prototype,"backgroundColor",void 0),T([s.f.field,_("design:type",Boolean)],j.prototype,"isHorizontal",void 0),T([s.f.field,_("design:type",Boolean)],j.prototype,"isVertical",void 0),T([s.f.field,_("design:type",Number)],j.prototype,"paddingTop",void 0),T([s.f.field,_("design:type",Number)],j.prototype,"paddingRight",void 0),T([s.f.field,_("design:type",Number)],j.prototype,"paddingBottom",void 0),T([s.f.field,_("design:type",Number)],j.prototype,"paddingLeft",void 0),T([p.b.uuidEvent,_("design:type",Object)],j.prototype,"onChanged",void 0),j=T([Object(s.b)("engine.shape",p.a.UI_SLIDER_SHAPE)],j);var L,H=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},B=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let U=L=class extends s.f{constructor(){super(...arguments),this.useDummyModel=!1}static Dummy(){const t=new L;return t.useDummyModel=!0,t}};H([s.f.field,B("design:type",String)],U.prototype,"id",void 0),H([s.f.field,B("design:type",String)],U.prototype,"name",void 0),H([s.f.field,B("design:type",String)],U.prototype,"bodyShape",void 0),H([s.f.field,B("design:type",Array)],U.prototype,"wearables",void 0),H([s.f.field,B("design:type",Object)],U.prototype,"skinColor",void 0),H([s.f.field,B("design:type",Object)],U.prototype,"hairColor",void 0),H([s.f.field,B("design:type",Object)],U.prototype,"eyeColor",void 0),H([s.f.field,B("design:type",Boolean)],U.prototype,"useDummyModel",void 0),U=L=H([Object(s.a)("engine.avatarShape",p.a.AVATAR_SHAPE)],U);var D=i(15);i(9);i.d(e,"n",(function(){return a.c})),i.d(e,"e",(function(){return p.c})),i.d(e,"a",(function(){return u.a})),i.d(e,"b",(function(){return u.b})),i.d(e,"f",(function(){return z})),i.d(e,"g",(function(){return C})),i.d(e,"l",(function(){return S})),i.d(e,"h",(function(){return I})),i.d(e,"m",(function(){return N})),i.d(e,"j",(function(){return F})),i.d(e,"i",(function(){return M})),i.d(e,"k",(function(){return j})),i.d(e,"d",(function(){return D.c})),i.d(e,"c",(function(){return D.a}));const k=new class{constructor(t){this.name=t,this.children={},this.eventManager=null,this.alive=!1,this.uuid=Object(a.d)("E"),this.components={},this.engine=null,this._parent=null}addComponentOrReplace(t){if("function"==typeof t)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof t)throw new Error(`You passed a ${typeof t}, an instance of component is expected`);const e=Object(s.i)(t);if(this.components[e]){if(this.components[e]===t)return t;this.removeComponent(this.components[e],!1)}return this.addComponent(t)}hasComponent(t){const e=typeof t;if("string"!==e&&"object"!==e&&"function"!==e)throw new Error("Entity#has(component): component is not a class, name or instance");if(null==t)return!1;const i="string"===e?t:Object(s.i)(t),n=this.components[i];return!!n&&("object"===e?n===t:"function"!==e||n instanceof t)}getComponent(t){const e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#get(component): component is not a class or name");const i="string"===e?t:Object(s.i)(t),n=this.components[i];if(!n)throw new Error(`Can not get component "${i}" from entity "${this.identifier}"`);if("function"===e){if(n instanceof t)return n;throw new Error(`Can not get component "${i}" from entity "${this.identifier}" (by instance)`)}return n}getComponentOrNull(t){const e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#getOrNull(component): component is not a class or name");const i="string"===e?t:Object(s.i)(t),n=this.components[i];return n?"function"===e?n instanceof t?n:null:n:null}getComponentOrCreate(t){if("function"!=typeof t)throw new Error("Entity#getOrCreate(component): component is not a class");let e=this.getComponentOrNull(t);return e||(e=new t,Object(s.i)(e),this.addComponentOrReplace(e)),e}addComponent(t){if("object"!=typeof t)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");const e=Object(s.i)(t),i=Object(s.g)(t);if(this.components[e])throw new Error(`A component of type "${e}" is already present in entity "${this.identifier}"`);this.components[e]=t,this.eventManager&&this.eventManager.fireEvent(new n.a(this,e,i));const o=t;return"function"==typeof o.addedToEntity&&o.addedToEntity(this),t}removeComponent(t,e=!0){const i=typeof t;if("string"!==i&&"function"!==i&&"object"!==i)throw new Error("Entity#remove(component): component is not a class, class or name");const o="string"===i?t:Object(s.i)(t),r=this.components[o];if(r){if("function"===i)return r instanceof t?(delete this.components[o],void(r&&(e&&this.eventManager&&this.eventManager.fireEvent(new n.b(this,o,r)),"function"==typeof r.removedFromEntity&&r.removedFromEntity(this)))):void Object(a.c)(`Entity Warning: Trying to remove wrong (by constructor) component "${o}" from entity "${this.identifier}"`);delete this.components[o],r&&(e&&this.eventManager&&this.eventManager.fireEvent(new n.b(this,o,r)),"function"==typeof r.removedFromEntity&&r.removedFromEntity(this))}else Object(a.c)(`Entity Warning: Trying to remove inexisting component "${o}" from entity "${this.identifier}"`)}isAddedToEngine(){return!(!this.engine||!(this.uuid in this.engine.entities||this.engine.rootEntity===this))}setParent(t){let e=!t&&this.engine?this.engine.rootEntity:t,i=this.getParent();if(e===this)throw new Error(`Failed to set parent for entity "${this.identifier}": An entity can't set itself as a its own parent`);if(e===i)return this;const s=this.getCircularAncestor(e);if(s)throw new Error(`Failed to set parent for entity "${this.identifier}": Circular parent references are not allowed (See entity "${s}")`);return i&&delete i.children[this.uuid],null!==e&&"0"!==e.uuid&&(!e.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),e.isAddedToEngine()&&!this.isAddedToEngine()&&e.engine.addEntity(this)),this._parent=e||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new n.c(this,e)),this}getParent(){return this._parent}get identifier(){return this.name||this.uuid}getCircularAncestor(t){const e=this.engine?this.engine.rootEntity:null;let i=t;for(;i&&i!==e;){const t=i.getParent();if(t===this)return i.uuid;i=t}return null}registerAsChild(){const t=this.getParent();this.uuid&&t&&(t.children[this.uuid]=this)}}("scene");k.uuid="0";const q=new class{constructor(t){this.eventManager=new o.b,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(n.a,this,this.componentAddedHandler),this.eventManager.addListener(n.b,this,this.componentRemovedHandler),this.rootEntity=t}get entities(){return this._entities}get disposableComponents(){return this._disposableComponents}addEntity(t){const e=t.getParent();if(t.isAddedToEngine())return t;t.eventManager=this.eventManager,t.engine=this,this._entities[t.uuid]=t,this.checkRequirementsAndAdd(t),e?e.isAddedToEngine()||e===this.rootEntity||Object(a.c)("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+e.uuid):t.setParent(this.rootEntity),t.alive=!0;for(let e in t.children){const i=t.children[e];i&&(i.isAddedToEngine()||this.addEntity(i))}return t}removeEntity(t){const e=t.uuid;if(t.isAddedToEngine()){for(let i in t.components){const n=this._componentGroups[i];if(n)for(let e in n)n[e].removeEntity(t);delete this.entityLists[i][e]}for(let e=0;e<this.simpleSystems.length;e++){const i=this.simpleSystems[e];i.onRemoveEntity&&i.onRemoveEntity(t)}for(let e in t.children){const i=t.children[e];i&&this.removeEntity(i)}return t.alive=!1,t.eventManager=null,delete this._entities[e],!0}Object(a.c)("Engine: Trying to remove non existent entity from engine."),t.isAddedToEngine()?Object(a.c)("Engine: Entity id: "+e):Object(a.c)(`Engine: Entity "${t.uuid}" has not been added to any engine yet.`),Object(a.c)("Engine: Entity's components:");for(let e in t.components)Object(a.c)(e);return!1}addSystem(t,e=0){if(-1!==this.addedSystems.indexOf(t))return Object(a.c)("Engine: Trying to add a system that is already added. Aborting"),t;if(this.systems.length>0)for(let i=0;i<this.systems.length;i++){const n=this.systems[i],s=i===this.systems.length-1;if(n.priority>e){this.addedSystems.push(t),this.systems.splice(i,0,{system:t,priority:e});break}if(s){this.addedSystems.push(t),this.systems.splice(i+1,0,{system:t,priority:e});break}}else this.addedSystems.push(t),this.systems.splice(1,0,{system:t,priority:e});return this.registerSystem(t),t}removeSystem(t){const e=this.addedSystems.indexOf(t);if(-1!==e){t.active=!1,t.deactivate&&t.deactivate(),this.addedSystems.splice(e,1);for(let e=0;e<this.systems.length;e++){this.systems[e].system===t&&this.systems.splice(e,1)}return!0}return!1}update(t){for(let e in this.systems){const i=this.systems[e].system;if(i.active&&i.update)try{i.update(t)}catch(t){Object(a.b)(t)}}return this}getEntitiesWithComponent(t){const e="string"==typeof t?t:Object(s.i)(t);return e in this.entityLists?this.entityLists[e]:this.entityLists[e]={}}registerComponent(t){const e=Object(s.h)(t),i=Object(s.i)(t),n=Object(s.g)(t);this._disposableComponents[e]=t,null!==n&&(this.eventManager.fireEvent(new s.c(e,i,n)),this.eventManager.fireEvent(new s.e(e,t)))}disposeComponent(t){const e=Object(s.h)(t);return delete this._disposableComponents[e]&&(this.eventManager.fireEvent(new s.d(e)),t.onDispose&&t.onDispose(),!0)}updateComponent(t){this.eventManager.fireEvent(new s.e(Object(s.h)(t),t))}getComponentGroup(...t){const e=new r(...t);e.active=!0;const i=e.requiresNames;for(let t=0;t<i.length;t++){const n=i[t];let s=this._componentGroups[n];s||(this._componentGroups[n]=s=[]),-1===s.indexOf(e)&&s.push(e)}for(let t in this._entities)this.checkRequirements(this._entities[t],e);return e}removeComponentGroup(t){if(t.active){t.active=!1;const e=t.requiresNames;for(let i=0;i<e.length;i++){const n=e[i];let s=this._componentGroups[n];if(s){const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}return!0}return!1}registerSystem(t){t.active=!0,t.activate&&t.activate(this),this.simpleSystems.push(t)}checkRequirementsAndAdd(t){if(t.isAddedToEngine()){for(let e in t.components){e in this.entityLists||(this.entityLists[e]={}),this.entityLists[e][t.uuid]=t;const i=this._componentGroups[e];if(i)for(let e in i)this.checkRequirements(t,i[e])}for(let e=0;e<this.simpleSystems.length;e++){const i=this.simpleSystems[e];i.onAddEntity&&i.onAddEntity(t)}}}checkRequirements(t,e){e.meetsRequirements(t)?e.hasEntity(t)||e.addEntity(t):e.hasEntity(t)&&e.removeEntity(t)}componentAddedHandler(t){const{entity:e,componentName:i}=t;if(!e.isAddedToEngine())return;this.entityLists[i]?this.entityLists[i][e.uuid]=e:this.entityLists[i]={[e.uuid]:e};const n=this._componentGroups[i];if(n)for(let t in n)this.checkRequirements(e,n[t])}componentRemovedHandler(t){const{entity:e,componentName:i}=t;if(!e.isAddedToEngine())return;delete this.entityLists[i][e.uuid];const n=this._componentGroups[i];if(n)for(let t in n)this.checkRequirements(e,n[t])}}(k);s.b.engine=q,"undefined"!=typeof dcl&&q.addSystem(new c(dcl),1/0),q.addSystem(l.c),q.addSystem(l.a),q.addSystem(l.b)},function(t,e,i){"use strict";i.d(e,"c",(function(){return r})),i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return d}));var n=i(5),s=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},o=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let r=class{constructor(t,e){this.uuid=t,this.payload=e}};r=s([Object(n.a)(),o("design:paramtypes",[String,Object])],r);let a=class{constructor(t){this.payload=t}};a=s([Object(n.a)(),o("design:paramtypes",[Object])],a);let d=class{constructor(t){this.payload=t}};d=s([Object(n.a)(),o("design:paramtypes",[Object])],d)},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(1),s=i(3),o=i(10);class r{constructor(){this.queries={}}static get instance(){return r.ensureInstance(),r._instance}static ensureInstance(){r._instance||(r._instance=new r)}getRayFromCamera(t){let e=o.a.instance.rotation,i=n.d.Identity();e.toRotationMatrix(i);let s=n.f.TransformCoordinates(n.f.Forward(),i);return{origin:o.a.instance.position,direction:s,distance:t}}getRayFromPositions(t,e){const i=e.subtract(t),n=i.length();return{origin:t,direction:i.normalize(),distance:n}}hitFirst(t,e){const i=Object(s.e)();this.queries[i]=e,dcl&&dcl.query("raycast",{queryId:i,queryType:"HitFirst",ray:t})}hitAll(t,e){const i=Object(s.e)();this.queries[i]=e,dcl&&dcl.query("raycast",{queryId:i,queryType:"HitAll",ray:t})}hitFirstAvatar(t,e){Object(s.c)("not implemented yet")}hitAllAvatars(t,e){Object(s.c)("not implemented yet")}handleRaycastHitFirstResponse(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]}handleRaycastHitAllResponse(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(1);class s{constructor(){this.position=new n.f,this.rotation=new n.e,this.feetPosition=new n.f,this.worldPosition=new n.f,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.onEvent(t=>{switch(t.type){case"positionChanged":this.positionChanged(t.data);break;case"rotationChanged":this.rotationChanged(t.data)}})),Object.defineProperty(this.position,"x",{get:()=>this.lastEventPosition.x}),Object.defineProperty(this.position,"y",{get:()=>this.lastEventPosition.y}),Object.defineProperty(this.position,"z",{get:()=>this.lastEventPosition.z}),Object.defineProperty(this.worldPosition,"x",{get:()=>this.lastEventWorldPosition.x}),Object.defineProperty(this.worldPosition,"y",{get:()=>this.lastEventWorldPosition.y}),Object.defineProperty(this.worldPosition,"z",{get:()=>this.lastEventWorldPosition.z}),Object.defineProperty(this.feetPosition,"x",{get:()=>this.lastEventPosition.x}),Object.defineProperty(this.feetPosition,"y",{get:()=>this.lastEventPosition.y-this.playerHeight}),Object.defineProperty(this.feetPosition,"z",{get:()=>this.lastEventPosition.z}),Object.defineProperty(this.rotation,"x",{get:()=>this.lastEventRotation.x}),Object.defineProperty(this.rotation,"y",{get:()=>this.lastEventRotation.y}),Object.defineProperty(this.rotation,"z",{get:()=>this.lastEventRotation.z}),Object.defineProperty(this.rotation,"w",{get:()=>this.lastEventRotation.w})}static get instance(){return s._instance||(s._instance=new s),s._instance}get playerHeight(){return this._playerHeight}positionChanged(t){this.lastEventPosition=t.position,this.lastEventWorldPosition=t.cameraPosition,this._playerHeight=t.playerHeight}rotationChanged(t){this.lastEventRotation=t.quaternion}}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return s})),function(t){t[t.PERCENT=0]="PERCENT",t[t.PIXELS=1]="PIXELS"}(n||(n={}));class s{constructor(t){if(this.type=n.PIXELS,"string"==typeof t){let e=t;e.indexOf("px")>-1?this.type=n.PIXELS:e.indexOf("%")>-1&&(this.type=n.PERCENT),this.value=parseFloat(e)}else this.value=t}toString(){let t=this.value.toString();return this.type===n.PERCENT?t+="%":t+="px",t}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(0),s=i(3),o=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},r=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const a={looping:!0,speed:1,weight:1};class d extends n.f{constructor(t,e=a){super(),this.isAnimationClip=!0,this.looping=a.looping,this.weight=a.weight,this.playing=!1,this.shouldReset=!1,this.speed=a.speed,this.name=Object(s.d)("AnimClip"),this.clip=t,this.setParams(Object.assign({},e))}setParams(t){return this.looping=void 0!==t.looping?t.looping:this.looping,this.speed=t.speed||this.speed,this}toJSON(){const t=JSON.parse(JSON.stringify(super.toJSON()));return this.shouldReset&&(this.shouldReset=!1),t}play(){this.playing=!0}pause(){this.playing=!1}reset(){this.shouldReset=!0}stop(){this.reset(),this.pause()}}o([n.f.readonly,r("design:type",String)],d.prototype,"clip",void 0),o([n.f.field,r("design:type",Boolean)],d.prototype,"looping",void 0),o([n.f.field,r("design:type",Number)],d.prototype,"weight",void 0),o([n.f.field,r("design:type",Boolean)],d.prototype,"playing",void 0),o([n.f.field,r("design:type",Boolean)],d.prototype,"shouldReset",void 0),o([n.f.field,r("design:type",Number)],d.prototype,"speed",void 0),o([n.f.readonly,r("design:type",String)],d.prototype,"name",void 0)},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n,s=i(14),o=i(1),r=i(0),a=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};!function(t){t.POINTER="POINTER",t.PRIMARY="PRIMARY",t.SECONDARY="SECONDARY"}(n||(n={}));class d{constructor(t){if(this.callback=t,!(t&&"apply"in t&&"call"in t))throw new Error("Callback is not a function");p.ensureInstance()}}let h=class extends d{};h=a([Object(r.a)("pointerDown")],h);let c=class extends d{};c=a([Object(r.a)("pointerUp")],c);class l{constructor(t,e){this.fn=t,this.useRaycast=e}}class p{constructor(){this.subscriptions={[n.POINTER]:{BUTTON_DOWN:[],BUTTON_UP:[]},[n.PRIMARY]:{BUTTON_DOWN:[],BUTTON_UP:[]},[n.SECONDARY]:{BUTTON_DOWN:[],BUTTON_UP:[]}},this.internalState={[n.POINTER]:{BUTTON_DOWN:!1},[n.PRIMARY]:{BUTTON_DOWN:!1},[n.SECONDARY]:{BUTTON_DOWN:!1}}}static get instance(){return p.ensureInstance(),p._instance}static ensureInstance(){p._instance||(p._instance=new p)}isButtonPressed(t){return this.internalState[t]}subscribe(t,e,i,n){return this.subscriptions[e][t].push(new l(n,i)),()=>this.unsubscribe(t,e,n)}unsubscribe(t,e,i){const n=this.getSubscriptionId(t,e,i);return n>-1&&this.subscriptions[e][t].splice(n,1)}handlePointerEvent(t){const e=this.getPointerById(t.buttonId);let i=Object.assign(Object.assign({},t),{button:e,direction:(new o.f).copyFrom(t.direction),origin:(new o.f).copyFrom(t.origin),hit:void 0});const n=t.hit?Object.assign(Object.assign({},t.hit),{hitPoint:(new o.f).copyFrom(t.hit.hitPoint),normal:(new o.f).copyFrom(t.hit.normal),worldNormal:(new o.f).copyFrom(t.hit.worldNormal)}):void 0;if(t.type===s.a.DOWN){this.internalState[e].BUTTON_DOWN=!0;for(let t=0;t<this.subscriptions[e].BUTTON_DOWN.length;t++){let s=this.subscriptions[e].BUTTON_DOWN[t];s.useRaycast?i.hit=n:i.hit=void 0,s.fn(i)}if(n&&n.entityId&&r.b.engine){const t=r.b.engine.entities[n.entityId],e=t&&t.getComponentOrNull(h);e&&(i.hit=n,e.callback(i))}}else{this.internalState[e].BUTTON_DOWN=!1;for(let t=0;t<this.subscriptions[e].BUTTON_UP.length;t++){let s=this.subscriptions[e].BUTTON_UP[t];s.useRaycast?i.hit=n:i.hit=void 0,s.fn(i)}if(n&&n.entityId&&r.b.engine){const t=r.b.engine.entities[n.entityId],e=t&&t.getComponentOrNull(c);e&&(i.hit=n,e.callback(i))}}}getSubscriptionId(t,e,i){for(let n=0;n<this.subscriptions[e][t].length;n++)if(this.subscriptions[e][t][n].fn===i)return n;return-1}getPointerById(t){return 0===t?n.POINTER:1===t?n.PRIMARY:n.SECONDARY}}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"c",(function(){return h})),i.d(e,"b",(function(){return l})),i.d(e,"a",(function(){return u}));var n=i(0),s=i(6),o=i(2),r=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},a=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let d=class extends o.b{constructor(t){super(t),this.type="onFocus",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],d.prototype,"type",void 0),d=r([Object(n.a)("engine.onFocus",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],d);let h=class extends o.b{constructor(t){super(t),this.type="onTextSubmit",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],h.prototype,"type",void 0),h=r([Object(n.a)("engine.onTextSubmit",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],h);let c=class extends o.b{constructor(t){super(t),this.type="onBlur",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],c.prototype,"type",void 0),c=r([Object(n.a)("engine.onBlur",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],c);let l=class extends o.b{constructor(t){super(t),this.type="onClick",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],l.prototype,"type",void 0),l=r([Object(n.a)("engine.onClick",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],l);let p=class extends o.b{constructor(t){super(t),this.type="onEnter",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],p.prototype,"type",void 0),p=r([Object(n.a)("engine.onEnter",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],p);let u=class extends o.b{constructor(t){super(t),this.type="onChange",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],u.prototype,"type",void 0),u=r([Object(n.a)("engine.onChange",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],u);let y=class extends o.b{constructor(t){super(t),this.type="pointerDown",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],y.prototype,"type",void 0),y=r([Object(n.a)("engine.pointerDown",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],y);let f=class extends o.b{constructor(t){super(t),this.type="pointerUp",s.c.handlerMap[this.uuid]=this}};r([n.f.readonly,a("design:type",String)],f.prototype,"type",void 0),f=r([Object(n.a)("engine.pointerUp",o.a.UUID_CALLBACK),a("design:paramtypes",[Function])],f)},,,,,function(t,e,i){"use strict";i.r(e);var n=i(7);const s=new n.f,o=new n.g(s);o.name="testRectContainer",o.color=n.b.Green(),o.width="50%",o.height="50%";const r=new n.j(o);r.name="textInput",r.width="80%",r.height="25px",r.vAlign="bottom",r.hAlign="left",r.fontSize=10,r.placeholder="Write message here",r.placeholderColor=n.b.Gray(),r.positionX="10%",r.positionY="10px",r.onTextSubmit=new n.d(t=>{o.color=n.b.Red(),Object(n.n)("submitted text! "+t.text)}),r.onChanged=new n.c(t=>{Object(n.n)("text changed: "+t.value)})}])}));