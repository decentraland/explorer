!function(e,r){for(var t in r)e[t]=r[t]}(this,function(e){var r={};function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(r){return e[r]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=6)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decompressFrames=r.decompressFrame=r.parseGIF=void 0;var n,i=(n=t(3))&&n.__esModule?n:{default:n},o=t(1),a=t(2),s=t(4),d=t(5);r.parseGIF=function(e){var r=new Uint8Array(e);return(0,o.parse)((0,a.buildStream)(r),i.default)};var c=function(e,r,t){if(e.image){var n=e.image,i=n.descriptor.width*n.descriptor.height,o=(0,d.lzw)(n.data.minCodeSize,n.data.blocks,i);n.descriptor.lct.interlaced&&(o=(0,s.deinterlace)(o,n.descriptor.width));var a={pixels:o,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?a.colorTable=n.lct:a.colorTable=r,e.gce&&(a.delay=10*(e.gce.delay||10),a.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(a.transparentIndex=e.gce.transparentColorIndex)),t&&(a.patch=function(e){for(var r=e.pixels.length,t=new Uint8ClampedArray(4*r),n=0;n<r;n++){var i=4*n,o=e.pixels[n],a=e.colorTable[o];t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=o!==e.transparentIndex?255:0}return t}(a)),a}console.warn("gif frame does not have associated image.")};r.decompressFrame=c;r.decompressFrames=function(e,r){return e.frames.filter((function(e){return e.image})).map((function(t){return c(t,e.gct,r)}))}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.loop=r.conditional=r.parse=void 0;r.parse=function e(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(Array.isArray(t))t.forEach((function(t){return e(r,t,n,i)}));else if("function"==typeof t)t(r,n,i,e);else{var o=Object.keys(t)[0];Array.isArray(t[o])?(i[o]={},e(r,t[o],n,i[o])):i[o]=t[o](r,n,i,e)}return n};r.conditional=function(e,r){return function(t,n,i,o){r(t,n,i)&&o(t,e,n,i)}};r.loop=function(e,r){return function(t,n,i,o){for(var a=[];r(t,n,i);){var s={};o(t,e,n,s),a.push(s)}return a}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readBits=r.readArray=r.readUnsigned=r.readString=r.peekBytes=r.readBytes=r.peekByte=r.readByte=r.buildStream=void 0;r.buildStream=function(e){return{data:e,pos:0}};var n=function(){return function(e){return e.data[e.pos++]}};r.readByte=n;r.peekByte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(r){return r.data[r.pos+e]}};var i=function(e){return function(r){return r.data.subarray(r.pos,r.pos+=e)}};r.readBytes=i;r.peekBytes=function(e){return function(r){return r.data.subarray(r.pos,r.pos+e)}};r.readString=function(e){return function(r){return Array.from(i(e)(r)).map((function(e){return String.fromCharCode(e)})).join("")}};r.readUnsigned=function(e){return function(r){var t=i(2)(r);return e?(t[1]<<8)+t[0]:(t[0]<<8)+t[1]}};r.readArray=function(e,r){return function(t,n,o){for(var a="function"==typeof r?r(t,n,o):r,s=i(e),d=new Array(a),c=0;c<a;c++)d[c]=s(t);return d}};r.readBits=function(e){return function(r){for(var t=function(e){return e.data[e.pos++]}(r),n=new Array(8),i=0;i<8;i++)n[7-i]=!!(t&1<<i);return Object.keys(e).reduce((function(r,t){var i=e[t];return i.length?r[t]=function(e,r,t){for(var n=0,i=0;i<t;i++)n+=e[r+i]&&Math.pow(2,t-i-1);return n}(n,i.index,i.length):r[t]=n[i.index],r}),{})}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=t(1),i=t(2),o={blocks:function(e){for(var r=[],t=0,n=(0,i.readByte)()(e);0!==n;n=(0,i.readByte)()(e))r.push((0,i.readBytes)(n)(e)),t+=n;for(var o=new Uint8Array(t),a=0,s=0;s<r.length;s++)o.set(r[s],a),a+=r[s].length;return o}},a=(0,n.conditional)({gce:[{codes:(0,i.readBytes)(2)},{byteSize:(0,i.readByte)()},{extras:(0,i.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,i.readUnsigned)(!0)},{transparentColorIndex:(0,i.readByte)()},{terminator:(0,i.readByte)()}]},(function(e){var r=(0,i.peekBytes)(2)(e);return 33===r[0]&&249===r[1]})),s=(0,n.conditional)({image:[{code:(0,i.readByte)()},{descriptor:[{left:(0,i.readUnsigned)(!0)},{top:(0,i.readUnsigned)(!0)},{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{lct:(0,i.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,n.conditional)({lct:(0,i.readArray)(3,(function(e,r,t){return Math.pow(2,t.descriptor.lct.size+1)}))},(function(e,r,t){return t.descriptor.lct.exists})),{data:[{minCodeSize:(0,i.readByte)()},o]}]},(function(e){return 44===(0,i.peekByte)()(e)})),d=(0,n.conditional)({text:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{preData:function(e,r,t){return(0,i.readBytes)(t.text.blockSize)(e)}},o]},(function(e){var r=(0,i.peekBytes)(2)(e);return 33===r[0]&&1===r[1]})),c=(0,n.conditional)({application:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{id:function(e,r,t){return(0,i.readString)(t.blockSize)(e)}},o]},(function(e){var r=(0,i.peekBytes)(2)(e);return 33===r[0]&&255===r[1]})),u=(0,n.conditional)({comment:[{codes:(0,i.readBytes)(2)},o]},(function(e){var r=(0,i.peekBytes)(2)(e);return 33===r[0]&&254===r[1]})),l=[{header:[{signature:(0,i.readString)(3)},{version:(0,i.readString)(3)}]},{lsd:[{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{gct:(0,i.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,i.readByte)()},{pixelAspectRatio:(0,i.readByte)()}]},(0,n.conditional)({gct:(0,i.readArray)(3,(function(e,r){return Math.pow(2,r.lsd.gct.size+1)}))},(function(e,r){return r.lsd.gct.exists})),{frames:(0,n.loop)([a,c,u,s,d],(function(e){var r=(0,i.peekByte)()(e);return 33===r||44===r}))}];r.default=l},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deinterlace=void 0;r.deinterlace=function(e,r){for(var t=new Array(e.length),n=e.length/r,i=function(n,i){var o=e.slice(i*r,(i+1)*r);t.splice.apply(t,[n*r,r].concat(o))},o=[0,4,2,1],a=[8,8,4,2],s=0,d=0;d<4;d++)for(var c=o[d];c<n;c+=a[d])i(c,s),s++;return t}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.lzw=void 0;r.lzw=function(e,r,t){var n,i,o,a,s,d,c,u,l,f,p,g,y,h,v,m,w=t,b=new Array(t),x=new Array(4096),B=new Array(4096),O=new Array(4097);for(s=(i=1<<(f=e))+1,n=i+2,c=-1,o=(1<<(a=f+1))-1,u=0;u<i;u++)x[u]=0,B[u]=u;for(p=g=y=h=v=m=0,l=0;l<w;){if(0===h){if(g<a){p+=r[m]<<g,g+=8,m++;continue}if(u=p&o,p>>=a,g-=a,u>n||u==s)break;if(u==i){o=(1<<(a=f+1))-1,n=i+2,c=-1;continue}if(-1==c){O[h++]=B[u],c=u,y=u;continue}for(d=u,u==n&&(O[h++]=y,u=c);u>i;)O[h++]=B[u],u=x[u];y=255&B[u],O[h++]=y,n<4096&&(x[n]=c,B[n]=y,0==(++n&o)&&n<4096&&(a++,o+=n)),c=d}h--,b[v++]=O[h],l++}for(l=v;l<w;l++)b[l]=0;return b}},function(e,r,t){"use strict";t.r(r);const n=t(7);var i;n&&n.__esModule&&n.default&&new n.default((i=self,{onConnect(e){i.addEventListener("message",()=>e(),{once:!0})},onError(e){i.addEventListener("error",r=>{r.error?e(r.error):r.message&&e(Object.assign(new Error(r.message),{colno:r.colno,error:r.error,filename:r.filename,lineno:r.lineno,message:r.message}))})},onMessage(e){i.addEventListener("message",r=>{e(r.data)})},sendMessage(e){i.postMessage(e)},close(){"terminate"in i?i.terminate():"close"in i&&i.close()}}))},function(e,r,t){"use strict";t.r(r);var n,i=(n="",{error(e,...r){"object"==typeof e&&e.stack?console.error(n+e,...r,e.stack):console.error(n+e,...r)},log(e,...r){r&&r[0]&&r[0].startsWith&&r[0].startsWith("The entity is already in the engine.")||console.log(n+e,...r)},warn(e,...r){console.log(n+e,...r)},info(e,...r){console.info(n+e,...r)},trace(e,...r){console.trace(n+e,...r)}}),o=t(0);const a=new OffscreenCanvas(1,1),s=a.getContext("2d"),d=new OffscreenCanvas(1,1),c=d.getContext("2d");let u=void 0;{let e=new Array;async function l(e){i.log("pravs - WORKER - DownloadAndProcessGIF");const r=fetch(e.data.src),t=await r,n=await t.arrayBuffer(),s=await Object(o.parseGIF)(n),d=Object(o.decompressFrames)(s,!0);i.log("pravs - WORKER PROCESSED GIF:",d),u=void 0,a.width=d[0].dims.width,a.height=d[0].dims.height;const c=new Array,l=new Array;for(const e in d)c.push(d[e].delay),l.push(f(d[e]).data.buffer);self.postMessage({frames:d,arrayBufferFrames:l,width:d[0].dims.width,height:d[0].dims.height,delays:c,sceneId:e.data.sceneId,componentId:e.data.componentId},l)}function f(e){return u&&e.dims.width===u.width&&e.dims.height===u.height||(d.width=e.dims.width,d.height=e.dims.height,u=null==c?void 0:c.createImageData(e.dims.width,e.dims.height)),u&&(u.data.set(e.patch),null==c||c.putImageData(u,0,0),null==s||s.drawImage(d,e.dims.left,e.dims.top)),null==s?void 0:s.getImageData(0,0,a.width,a.height)}self.onmessage=r=>{i.log("pravs - WORKER - Entrypoint called",r),function(r){if(i.log("pravs - WORKER - Enqueue Payload",r),e.push(r),1===e.length){(async function(){for(;e.length>0;)i.log("pravs - WORKER - Consuming first payload",e),await l(e[0]),e.splice(0,1)})().catch(e=>i.log(e))}}(r)}}}]));