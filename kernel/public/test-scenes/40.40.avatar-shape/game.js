!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=22)}({0:function(t,e,i){"use strict";let n=0;function s(...t){"undefined"!=typeof dcl?dcl.log(...t):console.log("DEBUG:",...t)}function o(t,e){"undefined"!=typeof dcl?dcl.error(t,e):console.error("ERROR:",t,e)}function r(t){if(n++,0===t.length)throw new Error("newId(type: string): type cannot be empty");return t+n.toString(36)}function a(t,e){const i=[];for(let n=0;n<t;++n)i.push(e());return i}const h="__event_name__",d=[];function l(t){if(!(h in t)||"string"!=typeof t[h])throw new Error("The EventConstructor is not registered");return t[h]}class p{constructor(){this.listeners={}}addListener(t,e,i){if(!t||"function"!=typeof t)throw new Error("Invalid EventConstructor");const n=l(t);let s=this.listeners[n];s||(s=this.listeners[n]=[]);for(let t=0;t<s.length;t++){if(s[t].listener===e)throw new Error("The provided listener is already registered")}return s.push({listener:e,fn:i}),this}removeListener(t,e){if(!e||"function"!=typeof e)throw new Error("Invalid EventConstructor");const i=l(e);let n=this.listeners[i];if(!n)return!1;for(let e=0;e<n.length;e++){if(n[e].listener===t)return n.splice(e,1),!0}return!1}fireEvent(t){const e=l(t.constructor);let i=this.listeners[e];if(i)for(let e=0;e<i.length;e++)try{const n=i[e];n.fn.call(n.listener,t)}catch(t){o(t)}return this}}function c(){const t=r("EV");if(-1!==d.indexOf(t))throw new Error(`The event name ${t} is already taken`);return d.push(t),e=>(e[h]=t,e)}var u=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},y=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let f=class{constructor(t,e,i){this.entity=t,this.componentName=e,this.component=i}};f=u([c(),y("design:paramtypes",[Object,String,Object])],f);let m=class{constructor(t,e,i){this.entity=t,this.componentName=e,this.classId=i}};m=u([c(),y("design:paramtypes",[Object,String,Object])],m);let g=class{constructor(t,e){this.entity=t,this.parent=e}};var w;g=u([c(),y("design:paramtypes",[Object,Object])],g),function(t){t[t.PERCENT=0]="PERCENT",t[t.PIXELS=1]="PIXELS"}(w||(w={}));class v{constructor(t){if(this.type=w.PIXELS,"string"==typeof t){let e=t;e.indexOf("px")>-1?this.type=w.PIXELS:e.indexOf("%")>-1&&(this.type=w.PERCENT),this.value=parseFloat(e)}else this.value=t}toString(){let t=this.value.toString();return this.type===w.PERCENT?t+="%":t+="px",t}}var R=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},x=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const b="__name__symbol_",T="__classId__symbol_",_="__component__id_";let A=class{constructor(t,e,i){this.componentId=t,this.componentName=e,this.classId=i}};A=R([c(),x("design:paramtypes",[String,String,Number])],A);let z=class{constructor(t){this.componentId=t}};z=R([c(),x("design:paramtypes",[String])],z);let E=class{constructor(t,e){this.componentId=t,this.component=e}};function C(t,e){return function(i){if(i.isComponent)throw new TypeError(`You cannot extend a component. Trying to extend ${i.originalClassName} with: ${t}`);const n=i,s=function(){const i=Array.prototype.slice.call(arguments),s=new n(...i);return Object.defineProperty(s,b,{enumerable:!1,writable:!1,configurable:!1,value:t}),void 0!==e&&Object.defineProperty(s,T,{enumerable:!1,writable:!1,configurable:!1,value:e}),s};return void 0!==e&&(s[T]=e),s[b]=t,s.isComponent=!0,s.originalClassName=t,(s.prototype=i.prototype).constructor=i,s}}function S(t,e){return function(i){if(i.isComponent)throw new TypeError(`You cannot extend a component. Trying to extend ${i.originalClassName} with: ${t}`);if("number"!=typeof e||isNaN(e))throw new Error(`classId: ${e} is an invalid integer`);const n=i,s=function(){if(!S.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");const i=Array.prototype.slice.call(arguments),s=new n(...i),o=r("C");return Object.defineProperty(s,b,{enumerable:!1,writable:!1,configurable:!1,value:t}),Object.defineProperty(s,_,{enumerable:!1,writable:!1,configurable:!1,value:o}),void 0!==e&&Object.defineProperty(s,T,{enumerable:!1,writable:!1,configurable:!1,value:e}),S.engine&&S.engine.registerComponent(s),s};return void 0!==e&&(s[T]=e),s[b]=t,s.isComponent=!0,s.isDisposableComponent=!0,s.originalClassName=t,(s.prototype=i.prototype).constructor=i,s}}function P(t){if(!t)throw new TypeError(t+" is not a component.");if(t[b])return t[b];throw new TypeError(t+" is not a registered component.")}function I(t){if(!t)throw new TypeError(t+" is not a component.");if(t[T])return t[T];if(!t[b])throw new TypeError(t+" is not a registered component.");return null}function N(t){if(!t)throw new TypeError(t+" is not a component.");if(t[_])return t[_];throw new TypeError(t+" is not a registered disposable component.")}E=R([c(),x("design:paramtypes",[String,Object])],E),function(t){t.engine=null}(S||(S={}));class M{constructor(){this.dirty=!1,this.data={},this.subscriptions=[]}static component(t,e){if(delete t[e]){const i=e+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Object.assign({},Object.getOwnPropertyDescriptor(t,i),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[i]},set:function(t){const n=this[i];if(this.data[e]=t?N(t):null,this[i]=t,t!==n){this.dirty=!0;for(let i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})}}static field(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e]},set:function(t){const i=this.data[e];if(this.data[e]=t,t!==i){this.dirty=!0;for(let n=0;n<this.subscriptions.length;n++)this.subscriptions[n](e,t,i)}},enumerable:!0})}static uiValue(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e].toString()},set:function(t){const i=this.data[e],n=new v(t);if(this.data[e]=n,n!==i){this.dirty=!0;for(let t=0;t<this.subscriptions.length;t++)this.subscriptions[t](e,n,i)}},enumerable:!0})}static readonly(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){if(e in this.data==!1)throw new Error(`The field ${e} is uninitialized`);return this.data[e]},set:function(t){if(e in this.data)throw new Error(`The field ${e} is readonly`);this.data[e]=t,this.dirty=!0},enumerable:!0,configurable:!1})}onChange(t){return this.subscriptions.push(t),this}toJSON(){return this.data}}function F(t){return _ in t}class O{constructor(...t){if(this.entities=[],this.active=!1,this._requiresNames=[],!t)throw new Error("ComponentGroup: Could not load the requires list");if(!(t instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return t.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(let e=0;e<t.length;e++){const i=t[e];let n=null;if(!i)throw new Error(`ComponentGroup: the required component at location ${e} is invalid`);try{n=P(i)}catch(t){throw new Error(`ComponentGroup: the required component at location ${e} is not registered as a @Component. Remember to provide the class of the component, not the name`)}if(this._requiresNames.some(t=>t===n))throw new Error(`ComponentGroup: the required component list has a repeated name ${n}`);this._requiresNames.push(n)}}hasEntity(t){return!!t.isAddedToEngine()&&-1!==this.entities.indexOf(t)}addEntity(t){if(!t.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(t)&&this.entities.push(t)}removeEntity(t){const e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)}componentRemoved(t,e){-1!==this._requiresNames.indexOf(e)&&this.removeEntity(t)}meetsRequirements(t){for(let e=0;e<this._requiresNames.length;e++){if(!(this._requiresNames[e]in t.components))return!1}return!0}}class L{constructor(t){this.name=t,this.children={},this.eventManager=null,this.alive=!1,this.uuid=r("E"),this.components={},this.engine=null,this._parent=null}addComponentOrReplace(t){if("function"==typeof t)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof t)throw new Error(`You passed a ${typeof t}, an instance of component is expected`);const e=P(t);if(this.components[e]){if(this.components[e]===t)return t;this.removeComponent(this.components[e],!1)}return this.addComponent(t)}hasComponent(t){const e=typeof t;if("string"!==e&&"object"!==e&&"function"!==e)throw new Error("Entity#has(component): component is not a class, name or instance");if(null==t)return!1;const i="string"===e?t:P(t),n=this.components[i];return!!n&&("object"===e?n===t:"function"!==e||n instanceof t)}getComponent(t){const e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#get(component): component is not a class or name");const i="string"===e?t:P(t),n=this.components[i];if(!n)throw new Error(`Can not get component "${i}" from entity "${this.identifier}"`);if("function"===e){if(n instanceof t)return n;throw new Error(`Can not get component "${i}" from entity "${this.identifier}" (by instance)`)}return n}getComponentOrNull(t){const e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#getOrNull(component): component is not a class or name");const i="string"===e?t:P(t),n=this.components[i];return n?"function"===e?n instanceof t?n:null:n:null}getComponentOrCreate(t){if("function"!=typeof t)throw new Error("Entity#getOrCreate(component): component is not a class");let e=this.getComponentOrNull(t);return e||(P(e=new t),this.addComponentOrReplace(e)),e}addComponent(t){if("object"!=typeof t)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");const e=P(t),i=I(t);if(this.components[e])throw new Error(`A component of type "${e}" is already present in entity "${this.identifier}"`);this.components[e]=t,this.eventManager&&this.eventManager.fireEvent(new m(this,e,i));const n=t;return"function"==typeof n.addedToEntity&&n.addedToEntity(this),t}removeComponent(t,e=!0){const i=typeof t;if("string"!==i&&"function"!==i&&"object"!==i)throw new Error("Entity#remove(component): component is not a class, class or name");const n="string"===i?t:P(t),o=this.components[n];if(o){if("function"===i)return o instanceof t?(delete this.components[n],void(o&&(e&&this.eventManager&&this.eventManager.fireEvent(new f(this,n,o)),"function"==typeof o.removedFromEntity&&o.removedFromEntity(this)))):void s(`Entity Warning: Trying to remove wrong (by constructor) component "${n}" from entity "${this.identifier}"`);delete this.components[n],o&&(e&&this.eventManager&&this.eventManager.fireEvent(new f(this,n,o)),"function"==typeof o.removedFromEntity&&o.removedFromEntity(this))}else s(`Entity Warning: Trying to remove inexisting component "${n}" from entity "${this.identifier}"`)}isAddedToEngine(){return!(!this.engine||!(this.uuid in this.engine.entities||this.engine.rootEntity===this))}setParent(t){let e=!t&&this.engine?this.engine.rootEntity:t,i=this.getParent();if(e===this)throw new Error(`Failed to set parent for entity "${this.identifier}": An entity can't set itself as a its own parent`);if(e===i)return this;const n=this.getCircularAncestor(e);if(n)throw new Error(`Failed to set parent for entity "${this.identifier}": Circular parent references are not allowed (See entity "${n}")`);return i&&delete i.children[this.uuid],null!==e&&"0"!==e.uuid&&(!e.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),e.isAddedToEngine()&&!this.isAddedToEngine()&&e.engine.addEntity(this)),this._parent=e||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new g(this,e)),this}getParent(){return this._parent}get identifier(){return this.name||this.uuid}getCircularAncestor(t){const e=this.engine?this.engine.rootEntity:null;let i=t;for(;i&&i!==e;){const t=i.getParent();if(t===this)return i.uuid;i=t}return null}registerAsChild(){const t=this.getParent();this.uuid&&t&&(t.children[this.uuid]=this)}}Promise.resolve().then.bind(Promise.resolve());var B=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},U=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let H=class{constructor(t,e){this.uuid=t,this.payload=e}};H=B([c(),U("design:paramtypes",[String,Object])],H);let D=class{constructor(t){this.payload=t}};D=B([c(),U("design:paramtypes",[Object])],D);const j="0";class W{constructor(t){this.dcl=t,this.cachedComponents={}}activate(t){this.engine=t,t.eventManager.addListener(m,this,this.componentAdded),t.eventManager.addListener(f,this,this.componentRemoved),t.eventManager.addListener(A,this,this.disposableComponentCreated),t.eventManager.addListener(z,this,this.disposableComponentRemoved),t.eventManager.addListener(E,this,this.disposableComponentUpdated),t.eventManager.addListener(g,this,this.parentChanged);const e=t.rootEntity.uuid;this.dcl.addEntity(e),this.dcl.onUpdate(e=>{t.update(e),this.presentEntities()}),this.dcl.onEvent(e=>{const i=e.data;switch(e.type){case"uuidEvent":t.eventManager.fireEvent(new H(i.uuid,i.payload));break;case"pointerEvent":t.eventManager.fireEvent(new D(i.payload))}})}onAddEntity(t){if(t&&t.isAddedToEngine()){const e=t.uuid,i=t.getParent();this.dcl.addEntity(e),i&&this.dcl.setParent(e,i.uuid),this.cachedComponents[e]={};for(let i in t.components){const n=t.components[i],s=I(n);if(null!==s)if(F(n))this.dcl.attachEntityComponent(t.uuid,i,N(n));else{const t=JSON.stringify(n);this.dcl.updateEntityComponent(e,i,s,t),this.cachedComponents[e][i]=t}}}}onRemoveEntity(t){if(t.isAddedToEngine()){const e=t.uuid;this.dcl.removeEntity(e),delete this.cachedComponents[e]}}presentEntities(){for(let t in this.engine.entities){const e=this.engine.entities[t],i=e.uuid;for(let t in e.components){const n=e.components[t],s=I(n);if(null!==s&&!F(n)){const o=JSON.stringify(n);this.cachedComponents[i][t]!==o&&(this.dcl.updateEntityComponent(e.uuid,t,s,o),this.cachedComponents[i][t]=o)}}}for(let t in this.engine.disposableComponents){const e=this.engine.disposableComponents[t];e instanceof M&&e.dirty&&(this.dcl.componentUpdated(t,JSON.stringify(e)),e.dirty=!1)}}componentAdded(t){if(t.entity.isAddedToEngine()){const e=t.entity.components[t.componentName];if(F(e))this.dcl.attachEntityComponent(t.entity.uuid,t.componentName,N(e));else if(null!==t.classId){const i=JSON.stringify(e);this.dcl.updateEntityComponent(t.entity.uuid,t.componentName,t.classId,i),this.cachedComponents[t.entity.uuid][t.componentName]=i}}}componentRemoved(t){t.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(t.entity.uuid,t.componentName),delete this.cachedComponents[t.entity.uuid][t.componentName])}disposableComponentCreated(t){this.dcl.componentCreated(t.componentId,t.componentName,t.classId)}disposableComponentRemoved(t){this.dcl.componentDisposed(t.componentId)}disposableComponentUpdated(t){this.dcl.componentUpdated(t.componentId,JSON.stringify(t.component))}parentChanged(t){this.dcl.setParent(t.entity.uuid,t.parent?t.parent.uuid:j)}}var k,q;!function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(k||(k={})),function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD",t[t.BONE=2]="BONE"}(q||(q={}));const V=1/2.2,Y=2.2,G=1e-6,X=Math.PI/180,Q=360/(2*Math.PI);class Z{static WithinEpsilon(t,e,i=1.401298e-45){let n=t-e;return-i<=n&&n<=i}static ToHex(t){let e=t.toString(16);return t<=15?("0"+e).toUpperCase():e.toUpperCase()}static Sign(t){const e=+t;return 0===e||isNaN(e)?e:e>0?1:-1}static Clamp(t,e=0,i=1){return Math.min(i,Math.max(e,t))}static Log2(t){return Math.log(t)*Math.LOG2E}static Repeat(t,e){return t-Math.floor(t/e)*e}static Normalize(t,e,i){return(t-e)/(i-e)}static Denormalize(t,e,i){return t*(i-e)+e}static DeltaAngle(t,e){let i=Z.Repeat(e-t,360);return i>180&&(i-=360),i}static PingPong(t,e){let i=Z.Repeat(t,2*e);return e-Math.abs(i-e)}static SmoothStep(t,e,i){let n=Z.Clamp(i);return e*(n=-2*n*n*n+3*n*n)+t*(1-n)}static MoveTowards(t,e,i){let n=0;return n=Math.abs(e-t)<=i?e:t+Z.Sign(e-t)*i}static MoveTowardsAngle(t,e,i){let n=Z.DeltaAngle(t,e),s=0;return s=-i<n&&n<i?e:Z.MoveTowards(t,t+n,i)}static Lerp(t,e,i){return t+(e-t)*i}static LerpAngle(t,e,i){let n=Z.Repeat(e-t,360);return n>180&&(n-=360),t+n*Z.Clamp(i)}static InverseLerp(t,e,i){let n=0;return n=t!==e?Z.Clamp((i-t)/(e-t)):0}static Hermite(t,e,i,n,s){let o=s*s,r=s*o;return t*(2*r-3*o+1)+i*(-2*r+3*o)+e*(r-2*o+s)+n*(r-o)}static RandomRange(t,e){return t===e?t:Math.random()*(e-t)+t}static RangeToPercent(t,e,i){return(t-e)/(i-e)}static PercentToRange(t,e,i){return(i-e)*t+e}static NormalizeRadians(t){return t-Z.TwoPi*Math.floor((t+Math.PI)/Z.TwoPi)}}Z.TwoPi=2*Math.PI;class K{constructor(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}static Add(t,e){return new K(t.x,t.y,t.z,t.w).addInPlace(e)}static FromArray(t,e=0){return new K(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]}static FromFloatArrayToRef(t,e,i){K.FromArrayToRef(t,e,i)}static FromFloatsToRef(t,e,i,n,s){s.x=t,s.y=e,s.z=i,s.w=n}static Zero(){return new K(0,0,0,0)}static One(){return new K(1,1,1,1)}static Normalize(t){let e=K.Zero();return K.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){e.copyFrom(t),e.normalize()}static Minimize(t,e){let i=new K(t.x,t.y,t.z,t.w);return i.minimizeInPlace(e),i}static Maximize(t,e){let i=new K(t.x,t.y,t.z,t.w);return i.maximizeInPlace(e),i}static Distance(t,e){return Math.sqrt(K.DistanceSquared(t,e))}static DistanceSquared(t,e){let i=t.x-e.x,n=t.y-e.y,s=t.z-e.z,o=t.w-e.w;return i*i+n*n+s*s+o*o}static Center(t,e){let i=K.Add(t,e);return i.scaleInPlace(.5),i}static TransformNormal(t,e){let i=K.Zero();return K.TransformNormalToRef(t,e,i),i}static TransformNormalToRef(t,e,i){const n=e.m;let s=t.x*n[0]+t.y*n[4]+t.z*n[8],o=t.x*n[1]+t.y*n[5]+t.z*n[9],r=t.x*n[2]+t.y*n[6]+t.z*n[10];i.x=s,i.y=o,i.z=r,i.w=t.w}static TransformNormalFromFloatsToRef(t,e,i,n,s,o){const r=s.m;o.x=t*r[0]+e*r[4]+i*r[8],o.y=t*r[1]+e*r[5]+i*r[9],o.z=t*r[2]+e*r[6]+i*r[10],o.w=n}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)}asArray(){let t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}add(t){return new K(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subtract(t){return new K(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this}subtractFromFloats(t,e,i,n){return new K(this.x-t,this.y-e,this.z-i,this.w-n)}subtractFromFloatsToRef(t,e,i,n,s){return s.x=this.x-t,s.y=this.y-e,s.z=this.z-i,s.w=this.w-n,this}negate(){return new K(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scale(t){return new K(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}equalsWithEpsilon(t,e=G){return t&&Z.WithinEpsilon(this.x,t.x,e)&&Z.WithinEpsilon(this.y,t.y,e)&&Z.WithinEpsilon(this.z,t.z,e)&&Z.WithinEpsilon(this.w,t.w,e)}equalsToFloats(t,e,i,n){return this.x===t&&this.y===e&&this.z===i&&this.w===n}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiply(t){return new K(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this}multiplyByFloats(t,e,i,n){return new K(this.x*t,this.y*e,this.z*i,this.w*n)}divide(t){return new K(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}maximizeInPlace(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}floor(){return new K(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new K(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){let t=this.length();return 0===t?this:this.scaleInPlace(1/t)}toVector3(){return new tt(this.x,this.y,this.z)}clone(){return new K(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}setAll(t){return this.x=this.y=this.z=this.w=t,this}}class J{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return J._identityReadOnly}static FromArray(t,e=0){let i=new J;return J.FromArrayToRef(t,e,i),i}static FromArrayToRef(t,e,i){for(let n=0;n<16;n++)i._m[n]=t[n+e];i._markAsUpdated()}static FromFloatArrayToRefScaled(t,e,i,n){for(let s=0;s<16;s++)n._m[s]=t[s+e]*i;n._markAsUpdated()}static FromValuesToRef(t,e,i,n,s,o,r,a,h,d,l,p,c,u,y,f,m){const g=m._m;g[0]=t,g[1]=e,g[2]=i,g[3]=n,g[4]=s,g[5]=o,g[6]=r,g[7]=a,g[8]=h,g[9]=d,g[10]=l,g[11]=p,g[12]=c,g[13]=u,g[14]=y,g[15]=f,m._markAsUpdated()}static FromValues(t,e,i,n,s,o,r,a,h,d,l,p,c,u,y,f){let m=new J;const g=m._m;return g[0]=t,g[1]=e,g[2]=i,g[3]=n,g[4]=s,g[5]=o,g[6]=r,g[7]=a,g[8]=h,g[9]=d,g[10]=l,g[11]=p,g[12]=c,g[13]=u,g[14]=y,g[15]=f,m._markAsUpdated(),m}static Compose(t,e,i){let n=new J;return J.ComposeToRef(t,e,i,n),n}static ComposeToRef(t,e,i,n){J.ScalingToRef(t.x,t.y,t.z,et.Matrix[1]),e.toRotationMatrix(et.Matrix[0]),et.Matrix[1].multiplyToRef(et.Matrix[0],n),n.setTranslation(i)}static Identity(){const t=J.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t}static IdentityToRef(t){J.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0)}static Zero(){const t=J.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t}static RotationX(t){let e=new J;return J.RotationXToRef(t,e),e}static Invert(t){let e=new J;return t.invertToRef(e),e}static RotationXToRef(t,e){let i=Math.sin(t),n=Math.cos(t);J.FromValuesToRef(1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationY(t){let e=new J;return J.RotationYToRef(t,e),e}static RotationYToRef(t,e){let i=Math.sin(t),n=Math.cos(t);J.FromValuesToRef(n,0,-i,0,0,1,0,0,i,0,n,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationZ(t){let e=new J;return J.RotationZToRef(t,e),e}static RotationZToRef(t,e){let i=Math.sin(t),n=Math.cos(t);J.FromValuesToRef(n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(1===n&&0===i)}static RotationAxis(t,e){let i=new J;return J.RotationAxisToRef(t,e,i),i}static RotationAxisToRef(t,e,i){let n=Math.sin(-e),s=Math.cos(-e),o=1-s;t.normalize();const r=i._m;r[0]=t.x*t.x*o+s,r[1]=t.x*t.y*o-t.z*n,r[2]=t.x*t.z*o+t.y*n,r[3]=0,r[4]=t.y*t.x*o+t.z*n,r[5]=t.y*t.y*o+s,r[6]=t.y*t.z*o-t.x*n,r[7]=0,r[8]=t.z*t.x*o-t.y*n,r[9]=t.z*t.y*o+t.x*n,r[10]=t.z*t.z*o+s,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,i._markAsUpdated()}static RotationYawPitchRoll(t,e,i){let n=new J;return J.RotationYawPitchRollToRef(t,e,i,n),n}static RotationYawPitchRollToRef(t,e,i,n){$.RotationYawPitchRollToRef(t,e,i,et.Quaternion[0]),et.Quaternion[0].toRotationMatrix(n)}static Scaling(t,e,i){let n=new J;return J.ScalingToRef(t,e,i,n),n}static ScalingToRef(t,e,i,n){J.FromValuesToRef(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1,n),n._updateIdentityStatus(1===t&&1===e&&1===i)}static Translation(t,e,i){let n=new J;return J.TranslationToRef(t,e,i,n),n}static TranslationToRef(t,e,i,n){J.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1,n),n._updateIdentityStatus(0===t&&0===e&&0===i)}static Lerp(t,e,i){let n=new J;return J.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){for(let s=0;s<16;s++)n._m[s]=t._m[s]*(1-i)+e._m[s]*i;n._markAsUpdated()}static DecomposeLerp(t,e,i){let n=new J;return J.DecomposeLerpToRef(t,e,i,n),n}static DecomposeLerpToRef(t,e,i,n){let s=et.Vector3[0],o=et.Quaternion[0],r=et.Vector3[1];t.decompose(s,o,r);let a=et.Vector3[2],h=et.Quaternion[1],d=et.Vector3[3];e.decompose(a,h,d);let l=et.Vector3[4];tt.LerpToRef(s,a,i,l);let p=et.Quaternion[2];$.SlerpToRef(o,h,i,p);let c=et.Vector3[5];tt.LerpToRef(r,d,i,c),J.ComposeToRef(l,p,c,n)}static LookAtLH(t,e,i){let n=new J;return J.LookAtLHToRef(t,e,i,n),n}static LookAtLHToRef(t,e,i,n){const s=et.Vector3[0],o=et.Vector3[1],r=et.Vector3[2];e.subtractToRef(t,r),r.normalize(),tt.CrossToRef(i,r,s);const a=s.lengthSquared();0===a?s.x=1:s.normalizeFromLength(Math.sqrt(a)),tt.CrossToRef(r,s,o),o.normalize();let h=-tt.Dot(s,t),d=-tt.Dot(o,t),l=-tt.Dot(r,t);J.FromValuesToRef(s.x,o.x,r.x,0,s.y,o.y,r.y,0,s.z,o.z,r.z,0,h,d,l,1,n)}static LookAtRH(t,e,i){let n=new J;return J.LookAtRHToRef(t,e,i,n),n}static LookAtRHToRef(t,e,i,n){const s=et.Vector3[0],o=et.Vector3[1],r=et.Vector3[2];t.subtractToRef(e,r),r.normalize(),tt.CrossToRef(i,r,s);const a=s.lengthSquared();0===a?s.x=1:s.normalizeFromLength(Math.sqrt(a)),tt.CrossToRef(r,s,o),o.normalize();let h=-tt.Dot(s,t),d=-tt.Dot(o,t),l=-tt.Dot(r,t);J.FromValuesToRef(s.x,o.x,r.x,0,s.y,o.y,r.y,0,s.z,o.z,r.z,0,h,d,l,1,n)}static OrthoLH(t,e,i,n){let s=new J;return J.OrthoLHToRef(t,e,i,n,s),s}static OrthoLHToRef(t,e,i,n,s){let o=2/t,r=2/e,a=2/(n-i),h=-(n+i)/(n-i);J.FromValuesToRef(o,0,0,0,0,r,0,0,0,0,a,0,0,0,h,1,s),s._updateIdentityStatus(1===o&&1===r&&1===a&&0===h)}static OrthoOffCenterLH(t,e,i,n,s,o){let r=new J;return J.OrthoOffCenterLHToRef(t,e,i,n,s,o,r),r}static OrthoOffCenterLHToRef(t,e,i,n,s,o,r){let a=2/(e-t),h=2/(n-i),d=2/(o-s),l=-(o+s)/(o-s),p=(t+e)/(t-e),c=(n+i)/(i-n);J.FromValuesToRef(a,0,0,0,0,h,0,0,0,0,d,0,p,c,l,1,r),r._markAsUpdated()}static OrthoOffCenterRH(t,e,i,n,s,o){let r=new J;return J.OrthoOffCenterRHToRef(t,e,i,n,s,o,r),r}static OrthoOffCenterRHToRef(t,e,i,n,s,o,r){J.OrthoOffCenterLHToRef(t,e,i,n,s,o,r),r._m[10]*=-1}static PerspectiveLH(t,e,i,n){let s=new J,o=2*i/t,r=2*i/e,a=(n+i)/(n-i),h=-2*n*i/(n-i);return J.FromValuesToRef(o,0,0,0,0,r,0,0,0,0,a,1,0,0,h,0,s),s._updateIdentityStatus(!1),s}static PerspectiveFovLH(t,e,i,n){let s=new J;return J.PerspectiveFovLHToRef(t,e,i,n,s),s}static PerspectiveFovLHToRef(t,e,i,n,s,o=!0){let r=i,a=n,h=1/Math.tan(.5*t),d=o?h/e:h,l=o?h:h*e,p=(a+r)/(a-r),c=-2*a*r/(a-r);J.FromValuesToRef(d,0,0,0,0,l,0,0,0,0,p,1,0,0,c,0,s),s._updateIdentityStatus(!1)}static PerspectiveFovRH(t,e,i,n){let s=new J;return J.PerspectiveFovRHToRef(t,e,i,n,s),s}static PerspectiveFovRHToRef(t,e,i,n,s,o=!0){let r=i,a=n,h=1/Math.tan(.5*t),d=o?h/e:h,l=o?h:h*e,p=-(a+r)/(a-r),c=-2*a*r/(a-r);J.FromValuesToRef(d,0,0,0,0,l,0,0,0,0,p,-1,0,0,c,0,s),s._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(t,e,i,n,s=!1){let o=s?-1:1,r=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),h=Math.tan(t.leftDegrees*Math.PI/180),d=Math.tan(t.rightDegrees*Math.PI/180),l=2/(h+d),p=2/(r+a);const c=n._m;c[0]=l,c[1]=c[2]=c[3]=c[4]=0,c[5]=p,c[6]=c[7]=0,c[8]=(h-d)*l*.5,c[9]=-(r-a)*p*.5,c[10]=-i/(e-i),c[11]=1*o,c[12]=c[13]=c[15]=0,c[14]=-2*i*e/(i-e),n._markAsUpdated()}static GetAsMatrix2x2(t){return[t._m[0],t._m[1],t._m[4],t._m[5]]}static GetAsMatrix3x3(t){return[t._m[0],t._m[1],t._m[2],t._m[4],t._m[5],t._m[6],t._m[8],t._m[9],t._m[10]]}static Transpose(t){let e=new J;return J.TransposeToRef(t,e),e}static TransposeToRef(t,e){const i=e._m,n=t._m;i[0]=n[0],i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=n[1],i[5]=n[5],i[6]=n[9],i[7]=n[13],i[8]=n[2],i[9]=n[6],i[10]=n[10],i[11]=n[14],i[12]=n[3],i[13]=n[7],i[14]=n[11],i[15]=n[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)}static Reflection(t){let e=new J;return J.ReflectionToRef(t,e),e}static ReflectionToRef(t,e){t.normalize();let i=t.normal.x,n=t.normal.y,s=t.normal.z,o=-2*i,r=-2*n,a=-2*s;J.FromValuesToRef(o*i+1,r*i,a*i,0,o*n,r*n+1,a*n,0,o*s,r*s,a*s+1,0,o*t.d,r*t.d,a*t.d,1,e)}static FromXYZAxesToRef(t,e,i,n){J.FromValuesToRef(t.x,t.y,t.z,0,e.x,e.y,e.z,0,i.x,i.y,i.z,0,0,0,0,1,n)}static FromQuaternionToRef(t,e){let i=t.x*t.x,n=t.y*t.y,s=t.z*t.z,o=t.x*t.y,r=t.z*t.w,a=t.z*t.x,h=t.y*t.w,d=t.y*t.z,l=t.x*t.w;e._m[0]=1-2*(n+s),e._m[1]=2*(o+r),e._m[2]=2*(a-h),e._m[3]=0,e._m[4]=2*(o-r),e._m[5]=1-2*(s+i),e._m[6]=2*(d+l),e._m[7]=0,e._m[8]=2*(a+h),e._m[9]=2*(d-l),e._m[10]=1-2*(n+i),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()}_markAsUpdated(){this.updateFlag=J._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]?this._isIdentity3x2=!1:0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const t=this._m,e=t[0],i=t[1],n=t[2],s=t[3],o=t[4],r=t[5],a=t[6],h=t[7],d=t[8],l=t[9],p=t[10],c=t[11],u=t[12],y=t[13],f=t[14],m=t[15],g=p*m-f*c,w=l*m-y*c,v=l*f-y*p,R=d*m-u*c,x=d*f-p*u,b=d*y-u*l;return e*+(r*g-a*w+h*v)+i*-(o*g-a*R+h*x)+n*+(o*w-r*R+h*b)+s*-(o*v-r*x+a*b)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return J.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(t){let e=new J;return this.addToRef(t,e),e}addToRef(t,e){for(let i=0;i<16;i++)e._m[i]=this._m[i]+t._m[i];return e._markAsUpdated(),this}addToSelf(t){for(let e=0;e<16;e++)this._m[e]+=t._m[e];return this._markAsUpdated(),this}invertToRef(t){if(!0===this._isIdentity)return J.IdentityToRef(t),this;const e=this._m,i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],h=e[6],d=e[7],l=e[8],p=e[9],c=e[10],u=e[11],y=e[12],f=e[13],m=e[14],g=e[15],w=c*g-m*u,v=p*g-f*u,R=p*m-f*c,x=l*g-y*u,b=l*m-c*y,T=l*f-y*p,_=+(a*w-h*v+d*R),A=-(r*w-h*x+d*b),z=+(r*v-a*x+d*T),E=-(r*R-a*b+h*T),C=i*_+n*A+s*z+o*E;if(0===C)return t.copyFrom(this),this;const S=1/C,P=h*g-m*d,I=a*g-f*d,N=a*m-f*h,M=r*g-y*d,F=r*m-y*h,O=r*f-y*a,L=h*u-c*d,B=a*u-p*d,U=a*c-p*h,H=r*u-l*d,D=r*c-l*h,j=r*p-l*a,W=-(n*w-s*v+o*R),k=+(i*w-s*x+o*b),q=-(i*v-n*x+o*T),V=+(i*R-n*b+s*T),Y=+(n*P-s*I+o*N),G=-(i*P-s*M+o*F),X=+(i*I-n*M+o*O),Q=-(i*N-n*F+s*O),Z=-(n*L-s*B+o*U),K=+(i*L-s*H+o*D),$=-(i*B-n*H+o*j),tt=+(i*U-n*D+s*j);return J.FromValuesToRef(_*S,W*S,Y*S,Z*S,A*S,k*S,G*S,K*S,z*S,q*S,X*S,$*S,E*S,V*S,Q*S,tt*S,t),this}addAtIndex(t,e){return this._m[t]+=e,this._markAsUpdated(),this}multiplyAtIndex(t,e){return this._m[t]*=e,this._markAsUpdated(),this}setTranslationFromFloats(t,e,i){return this._m[12]=t,this._m[13]=e,this._m[14]=i,this._markAsUpdated(),this}setTranslation(t){return this.setTranslationFromFloats(t.x,t.y,t.z)}getTranslation(){return new tt(this._m[12],this._m[13],this._m[14])}getTranslationToRef(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this}removeRotationAndScaling(){const t=this.m;return J.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),this}multiply(t){let e=new J;return this.multiplyToRef(t,e),e}copyFrom(t){t.copyToArray(this._m);const e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this}copyToArray(t,e=0){for(let i=0;i<16;i++)t[e+i]=this._m[i];return this}multiplyToRef(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)}multiplyToArray(t,e,i){const n=this._m,s=t.m;let o=n[0],r=n[1],a=n[2],h=n[3],d=n[4],l=n[5],p=n[6],c=n[7],u=n[8],y=n[9],f=n[10],m=n[11],g=n[12],w=n[13],v=n[14],R=n[15],x=s[0],b=s[1],T=s[2],_=s[3],A=s[4],z=s[5],E=s[6],C=s[7],S=s[8],P=s[9],I=s[10],N=s[11],M=s[12],F=s[13],O=s[14],L=s[15];return e[i]=o*x+r*A+a*S+h*M,e[i+1]=o*b+r*z+a*P+h*F,e[i+2]=o*T+r*E+a*I+h*O,e[i+3]=o*_+r*C+a*N+h*L,e[i+4]=d*x+l*A+p*S+c*M,e[i+5]=d*b+l*z+p*P+c*F,e[i+6]=d*T+l*E+p*I+c*O,e[i+7]=d*_+l*C+p*N+c*L,e[i+8]=u*x+y*A+f*S+m*M,e[i+9]=u*b+y*z+f*P+m*F,e[i+10]=u*T+y*E+f*I+m*O,e[i+11]=u*_+y*C+f*N+m*L,e[i+12]=g*x+w*A+v*S+R*M,e[i+13]=g*b+w*z+v*P+R*F,e[i+14]=g*T+w*E+v*I+R*O,e[i+15]=g*_+w*C+v*N+R*L,this}equals(t){const e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;const i=this.m,n=e.m;return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]}clone(){const t=new J;return t.copyFrom(this),t}getClassName(){return"Matrix"}getHashCode(){let t=this._m[0]||0;for(let e=1;e<16;e++)t=397*t^(this._m[e]||0);return t}decompose(t,e,i){if(this._isIdentity)return i&&i.setAll(0),t&&t.setAll(1),e&&e.copyFromFloats(0,0,0,1),!0;const n=this._m;i&&i.copyFromFloats(n[12],n[13],n[14]);const s=t||et.Vector3[0];if(s.x=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),s.y=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),s.z=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),this.determinant()<=0&&(s.y*=-1),0===s.x||0===s.y||0===s.z)return e&&e.copyFromFloats(0,0,0,1),!1;if(e){const t=1/s.x,i=1/s.y,o=1/s.z;J.FromValuesToRef(n[0]*t,n[1]*t,n[2]*t,0,n[4]*i,n[5]*i,n[6]*i,0,n[8]*o,n[9]*o,n[10]*o,0,0,0,0,1,et.Matrix[0]),$.FromRotationMatrixToRef(et.Matrix[0],e)}return!0}getRow(t){if(t<0||t>3)return null;let e=4*t;return new K(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])}setRow(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)}transpose(){return J.Transpose(this)}transposeToRef(t){return J.TransposeToRef(this,t),this}setRowFromFloats(t,e,i,n,s){if(t<0||t>3)return this;let o=4*t;return this._m[o+0]=e,this._m[o+1]=i,this._m[o+2]=n,this._m[o+3]=s,this._markAsUpdated(),this}scale(t){let e=new J;return this.scaleToRef(t,e),e}scaleToRef(t,e){for(let i=0;i<16;i++)e._m[i]=this._m[i]*t;return e._markAsUpdated(),this}scaleAndAddToRef(t,e){for(let i=0;i<16;i++)e._m[i]+=this._m[i]*t;return e._markAsUpdated(),this}toNormalMatrix(t){const e=et.Matrix[0];this.invertToRef(e),e.transposeToRef(t);let i=t._m;J.FromValuesToRef(i[0],i[1],i[2],0,i[4],i[5],i[6],0,i[8],i[9],i[10],0,0,0,0,1,t)}getRotationMatrix(){let t=new J;return this.getRotationMatrixToRef(t),t}getRotationMatrixToRef(t){const e=et.Vector3[0];if(!this.decompose(e))return J.IdentityToRef(t),this;const i=this._m,n=1/e.x,s=1/e.y,o=1/e.z;return J.FromValuesToRef(i[0]*n,i[1]*n,i[2]*n,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*o,i[9]*o,i[10]*o,0,0,0,0,1,t),this}toggleModelMatrixHandInPlace(){const t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){let t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(t,e=!1,i=!1,n=!0){this.updateFlag=J._updateFlagSeed++,this._isIdentity=t,this._isIdentity3x2=t||i,this._isIdentityDirty=!this._isIdentity&&e,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n}}J._updateFlagSeed=0,J._identityReadOnly=J.Identity();class ${constructor(t=0,e=0,i=0,n=1){this.x=t,this.y=e,this.z=i,this.w=n}static FromRotationMatrix(t){let e=new $;return $.FromRotationMatrixToRef(t,e),e}static FromRotationMatrixToRef(t,e){let i,n=t.m,s=n[0],o=n[4],r=n[8],a=n[1],h=n[5],d=n[9],l=n[2],p=n[6],c=n[10],u=s+h+c;u>0?(i=.5/Math.sqrt(u+1),e.w=.25/i,e.x=(p-d)*i,e.y=(r-l)*i,e.z=(a-o)*i):s>h&&s>c?(i=2*Math.sqrt(1+s-h-c),e.w=(p-d)/i,e.x=.25*i,e.y=(o+a)/i,e.z=(r+l)/i):h>c?(i=2*Math.sqrt(1+h-s-c),e.w=(r-l)/i,e.x=(o+a)/i,e.y=.25*i,e.z=(d+p)/i):(i=2*Math.sqrt(1+c-s-h),e.w=(a-o)/i,e.x=(r+l)/i,e.y=(d+p)/i,e.z=.25*i)}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static AreClose(t,e){return $.Dot(t,e)>=0}static Zero(){return new $(0,0,0,0)}static Inverse(t){return new $(-t.x,-t.y,-t.z,t.w)}static IsIdentity(t){return t&&0===t.x&&0===t.y&&0===t.z&&1===t.w}static RotationAxis(t,e){const i=e*X;return $.RotationAxisToRef(t,i,new $)}static RotationAxisToRef(t,e,i){const n=e*X;let s=Math.sin(n/2);return t.normalize(),i.w=Math.cos(n/2),i.x=t.x*s,i.y=t.y*s,i.z=t.z*s,i}static FromArray(t,e=0){return new $(t[e],t[e+1],t[e+2],t[e+3])}static FromEulerAnglesRef(t,e,i,n){return $.RotationYawPitchRollToRef(e*X,t*X,i*X,n)}static RotationYawPitchRoll(t,e,i){let n=new $;return $.RotationYawPitchRollToRef(t,e,i,n),n}static RotationYawPitchRollToRef(t,e,i,n){let s=.5*i,o=.5*e,r=.5*t,a=Math.cos(o),h=Math.cos(r),d=Math.cos(s),l=Math.sin(o),p=Math.sin(r),c=Math.sin(s);n.x=l*h*d+a*p*c,n.y=a*p*d-l*h*c,n.z=a*h*c+l*p*d,n.w=a*h*d-l*p*c}static RotationAlphaBetaGamma(t,e,i){let n=new $;return $.RotationAlphaBetaGammaToRef(t,e,i,n),n}static RotationAlphaBetaGammaToRef(t,e,i,n){let s=.5*(i+t),o=.5*(i-t),r=.5*e;n.x=Math.cos(o)*Math.sin(r),n.y=Math.sin(o)*Math.sin(r),n.z=Math.sin(s)*Math.cos(r),n.w=Math.cos(s)*Math.cos(r)}static RotationQuaternionFromAxis(t,e,i){let n=new $(0,0,0,0);return $.RotationQuaternionFromAxisToRef(t,e,i,n),n}static RotationQuaternionFromAxisToRef(t,e,i,n){let s=et.Matrix[0];J.FromXYZAxesToRef(t.normalize(),e.normalize(),i.normalize(),s),$.FromRotationMatrixToRef(s,n)}static Slerp(t,e,i){let n=$.Identity;return $.SlerpToRef(t,e,i,n),n}static SlerpToRef(t,e,i,n){let s,o,r=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w,a=!1;if(r<0&&(a=!0,r=-r),r>.999999)o=1-i,s=a?-i:i;else{let t=Math.acos(r),e=1/Math.sin(t);o=Math.sin((1-i)*t)*e,s=a?-Math.sin(i*t)*e:Math.sin(i*t)*e}n.x=o*t.x+s*e.x,n.y=o*t.y+s*e.y,n.z=o*t.z+s*e.z,n.w=o*t.w+s*e.w}static Hermite(t,e,i,n,s){let o=s*s,r=s*o,a=2*r-3*o+1,h=-2*r+3*o,d=r-2*o+s,l=r-o,p=t.x*a+i.x*h+e.x*d+n.x*l,c=t.y*a+i.y*h+e.y*d+n.y*l,u=t.z*a+i.z*h+e.z*d+n.z*l,y=t.w*a+i.w*h+e.w*d+n.w*l;return new $(p,c,u,y)}static get Identity(){return new $(0,0,0,1)}static Angle(t,e){const i=$.Dot(t,e);return 2*Math.acos(Math.min(Math.abs(i),1))*Q}static Euler(t,e,i){return $.RotationYawPitchRoll(e*X,t*X,i*X)}static LookRotation(t,e=et.staticUp){const i=tt.Normalize(t),n=tt.Normalize(tt.Cross(e,i)),s=tt.Cross(i,n);let o=n.x,r=n.y,a=n.z,h=s.x,d=s.y,l=s.z,p=i.x,c=i.y,u=i.z;const y=o+d+u;let f=new $;if(y>0){let t=Math.sqrt(y+1);return f.w=.5*t,t=.5/t,f.x=(l-c)*t,f.y=(p-a)*t,f.z=(r-h)*t,f}if(o>=d&&o>=u){let t=Math.sqrt(1+o-d-u),e=.5/t;return f.x=.5*t,f.y=(r+h)*e,f.z=(a+p)*e,f.w=(l-c)*e,f}if(d>u){let t=Math.sqrt(1+d-o-u),e=.5/t;return f.x=(h+r)*e,f.y=.5*t,f.z=(c+l)*e,f.w=(p-a)*e,f}let m=Math.sqrt(1+u-o-d),g=.5/m;return f.x=(p+a)*g,f.y=(c+l)*g,f.z=.5*m,f.w=(r-h)*g,f}static RotateTowards(t,e,i){const n=$.Angle(t,e);if(0===n)return e;const s=Math.min(1,i/n);return $.Slerp(t,e,s)}static FromToRotation(t,e){const i=new $;let n=t.normalize(),s=e.normalize(),o=tt.Dot(n,s);if(o>-1+G){let t=Math.sqrt(2*(1+o)),e=1/t,r=tt.Cross(n,s).scaleInPlace(e);i.set(r.x,r.y,r.z,.5*t)}else{if(o>1-G)return new $(0,0,0,1);{let t=tt.Cross(tt.Right(),n);t.lengthSquared()<G&&(t=tt.Cross(tt.Forward(),n)),i.set(t.x,t.y,t.z,0)}}return i.normalize()}get normalized(){return this.normalize()}setFromToRotation(t,e,i=et.staticUp){et.tmpMatrix=J.Zero(),J.LookAtLHToRef(t,e,i,et.tmpMatrix),et.tmpMatrix.invert(),$.FromRotationMatrixToRef(et.tmpMatrix,this)}set eulerAngles(t){this.setEuler(t.x,t.y,t.z)}get eulerAngles(){const t=new tt,e=new J;this.toRotationMatrix(e);const i=J.GetAsMatrix3x3(e);return t.y=Q*Math.asin(Math.max(-1,Math.min(1,i[6]))),Math.abs(i[6])<.99999?(t.x=Q*Math.atan2(-i[7],i[8]),t.z=Q*Math.atan2(-i[3],i[0])):(t.x=Q*Math.atan2(i[5],i[4]),t.z=0),t}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)}asArray(){return[this.x,this.y,this.z,this.w]}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}clone(){return new $(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}setEuler(t,e,i){return $.RotationYawPitchRollToRef(e*X,t*X,i*X,this),this}add(t){return new $(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return new $(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}scale(t){return new $(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}multiply(t){let e=new $(0,0,0,1);return this.multiplyToRef(t,e),e}multiplyToRef(t,e){let i=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,n=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,s=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,o=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return e.copyFromFloats(i,n,s,o),this}multiplyInPlace(t){return this.multiplyToRef(t,this),this}conjugateToRef(t){return t.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new $(-this.x,-this.y,-this.z,this.w)}normalize(){let t=1/this.length;return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}angleAxis(t,e){if(0===e.lengthSquared())return $.Identity;const i=$.Identity;let n=t*X;n*=.5;let s=e.normalize();return s=e.scaleInPlace(Math.sin(n)),i.x=s.x,i.y=s.y,i.z=s.z,i.w=Math.cos(n),i.normalize()}toRotationMatrix(t){return J.FromQuaternionToRef(this,t),this}fromRotationMatrix(t){return $.FromRotationMatrixToRef(t,this),this}}class tt{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}get isNonUniform(){let t=Math.abs(this.x),e=Math.abs(this.y);if(t!==e)return!0;let i=Math.abs(this.z);return t!==i||e!==i}static Add(t,e){return new tt(t.x,t.y,t.z).addInPlace(e)}static GetClipFactor(t,e,i,n){let s=tt.Dot(t,i)-n;return s/(s-(tt.Dot(e,i)-n))}static GetAngleBetweenVectors(t,e,i){const n=t.normalizeToRef(et.Vector3[1]),s=e.normalizeToRef(et.Vector3[2]),o=tt.Dot(n,s),r=et.Vector3[3];return tt.CrossToRef(n,s,r),tt.Dot(r,i)>0?Math.acos(o):-Math.acos(o)}static FromArray(t,e=0){return new tt(t[e],t[e+1],t[e+2])}static FromFloatArray(t,e){return tt.FromArray(t,e)}static FromArrayToRef(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2]}static FromFloatArrayToRef(t,e,i){return tt.FromArrayToRef(t,e,i)}static FromFloatsToRef(t,e,i,n){n.copyFromFloats(t,e,i)}static Zero(){return new tt(0,0,0)}static One(){return new tt(1,1,1)}static Up(){return new tt(0,1,0)}static Down(){return new tt(0,-1,0)}static Forward(){return new tt(0,0,1)}static Backward(){return new tt(0,0,-1)}static Right(){return new tt(1,0,0)}static Left(){return new tt(-1,0,0)}static TransformCoordinates(t,e){let i=tt.Zero();return tt.TransformCoordinatesToRef(t,e,i),i}static TransformCoordinatesToRef(t,e,i){return tt.TransformCoordinatesFromFloatsToRef(t.x,t.y,t.z,e,i)}static TransformCoordinatesFromFloatsToRef(t,e,i,n,s){const o=n.m;let r=t*o[0]+e*o[4]+i*o[8]+o[12],a=t*o[1]+e*o[5]+i*o[9]+o[13],h=t*o[2]+e*o[6]+i*o[10]+o[14],d=1/(t*o[3]+e*o[7]+i*o[11]+o[15]);s.x=r*d,s.y=a*d,s.z=h*d}static TransformNormal(t,e){let i=tt.Zero();return tt.TransformNormalToRef(t,e,i),i}static TransformNormalToRef(t,e,i){this.TransformNormalFromFloatsToRef(t.x,t.y,t.z,e,i)}static TransformNormalFromFloatsToRef(t,e,i,n,s){const o=n.m;s.x=t*o[0]+e*o[4]+i*o[8],s.y=t*o[1]+e*o[5]+i*o[9],s.z=t*o[2]+e*o[6]+i*o[10]}static CatmullRom(t,e,i,n,s){let o=s*s,r=s*o,a=.5*(2*e.x+(-t.x+i.x)*s+(2*t.x-5*e.x+4*i.x-n.x)*o+(-t.x+3*e.x-3*i.x+n.x)*r),h=.5*(2*e.y+(-t.y+i.y)*s+(2*t.y-5*e.y+4*i.y-n.y)*o+(-t.y+3*e.y-3*i.y+n.y)*r),d=.5*(2*e.z+(-t.z+i.z)*s+(2*t.z-5*e.z+4*i.z-n.z)*o+(-t.z+3*e.z-3*i.z+n.z)*r);return new tt(a,h,d)}static Clamp(t,e,i){const n=new tt;return tt.ClampToRef(t,e,i,n),n}static ClampToRef(t,e,i,n){let s=t.x;s=(s=s>i.x?i.x:s)<e.x?e.x:s;let o=t.y;o=(o=o>i.y?i.y:o)<e.y?e.y:o;let r=t.z;r=(r=r>i.z?i.z:r)<e.z?e.z:r,n.copyFromFloats(s,o,r)}static Hermite(t,e,i,n,s){let o=s*s,r=s*o,a=2*r-3*o+1,h=-2*r+3*o,d=r-2*o+s,l=r-o,p=t.x*a+i.x*h+e.x*d+n.x*l,c=t.y*a+i.y*h+e.y*d+n.y*l,u=t.z*a+i.z*h+e.z*d+n.z*l;return new tt(p,c,u)}static Lerp(t,e,i){let n=new tt(0,0,0);return tt.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.x=t.x+(e.x-t.x)*i,n.y=t.y+(e.y-t.y)*i,n.z=t.z+(e.z-t.z)*i}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static Cross(t,e){let i=tt.Zero();return tt.CrossToRef(t,e,i),i}static CrossToRef(t,e,i){const n=t.y*e.z-t.z*e.y,s=t.z*e.x-t.x*e.z,o=t.x*e.y-t.y*e.x;i.copyFromFloats(n,s,o)}static Normalize(t){let e=tt.Zero();return tt.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){t.normalizeToRef(e)}static Minimize(t,e){let i=new tt(t.x,t.y,t.z);return i.minimizeInPlace(e),i}static Maximize(t,e){let i=new tt(t.x,t.y,t.z);return i.maximizeInPlace(e),i}static Distance(t,e){return Math.sqrt(tt.DistanceSquared(t,e))}static DistanceSquared(t,e){let i=t.x-e.x,n=t.y-e.y,s=t.z-e.z;return i*i+n*n+s*s}static Center(t,e){let i=tt.Add(t,e);return i.scaleInPlace(.5),i}static RotationFromAxis(t,e,i){let n=tt.Zero();return tt.RotationFromAxisToRef(t,e,i,n),n}static RotationFromAxisToRef(t,e,i,n){let s=et.Quaternion[0];$.RotationQuaternionFromAxisToRef(t,e,i,s),n.copyFrom(s.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let t=this.x||0;return t=397*(t=397*t^(this.y||0))^(this.z||0)}asArray(){let t=[];return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,this}toQuaternion(){return $.Identity.setEuler(this.y,this.x,this.z)}addInPlace(t){return this.addInPlaceFromFloats(t.x,t.y,t.z)}addInPlaceFromFloats(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this}add(t){return new tt(this.x+t.x,this.y+t.y,this.z+t.z)}addToRef(t,e){return e.copyFromFloats(this.x+t.x,this.y+t.y,this.z+t.z)}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subtract(t){return new tt(this.x-t.x,this.y-t.y,this.z-t.z)}subtractToRef(t,e){return this.subtractFromFloatsToRef(t.x,t.y,t.z,e)}subtractFromFloats(t,e,i){return new tt(this.x-t,this.y-e,this.z-i)}subtractFromFloatsToRef(t,e,i,n){return n.copyFromFloats(this.x-t,this.y-e,this.z-i)}applyMatrix4(t){this.applyMatrix4ToRef(t,this)}applyMatrix4ToRef(t,e){const{x:i,y:n,z:s}=this,{m:o}=t,r=1/(o[3]*i+o[7]*n+o[11]*s+o[15]);return e.x=(o[0]*i+o[4]*n+o[8]*s+o[12])*r,e.y=(o[1]*i+o[5]*n+o[9]*s+o[13])*r,e.z=(o[2]*i+o[6]*n+o[10]*s+o[14])*r,e}rotate(t){return this.rotateToRef(t,this)}rotateToRef(t,e){const{x:i,y:n,z:s}=this,{x:o,y:r,z:a,w:h}=t,d=h*i+r*s-a*n,l=h*n+a*i-o*s,p=h*s+o*n-r*i,c=-o*i-r*n-a*s;return e.x=d*h+c*-o+l*-a-p*-r,e.y=l*h+c*-r+p*-o-d*-a,e.z=p*h+c*-a+d*-r-l*-o,e}negate(){return new tt(-this.x,-this.y,-this.z)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this}scale(t){return new tt(this.x*t,this.y*t,this.z*t)}scaleToRef(t,e){return e.copyFromFloats(this.x*t,this.y*t,this.z*t)}scaleAndAddToRef(t,e){return e.addInPlaceFromFloats(this.x*t,this.y*t,this.z*t)}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z}equalsWithEpsilon(t,e=G){return t&&Z.WithinEpsilon(this.x,t.x,e)&&Z.WithinEpsilon(this.y,t.y,e)&&Z.WithinEpsilon(this.z,t.z,e)}equalsToFloats(t,e,i){return this.x===t&&this.y===e&&this.z===i}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiply(t){return this.multiplyByFloats(t.x,t.y,t.z)}multiplyToRef(t,e){return e.copyFromFloats(this.x*t.x,this.y*t.y,this.z*t.z)}multiplyByFloats(t,e,i){return new tt(this.x*t,this.y*e,this.z*i)}divide(t){return new tt(this.x/t.x,this.y/t.y,this.z/t.z)}divideToRef(t,e){return e.copyFromFloats(this.x/t.x,this.y/t.y,this.z/t.z)}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.x,t.y,t.z)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.x,t.y,t.z)}minimizeInPlaceFromFloats(t,e,i){return t<this.x&&(this.x=t),e<this.y&&(this.y=e),i<this.z&&(this.z=i),this}maximizeInPlaceFromFloats(t,e,i){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),i>this.z&&(this.z=i),this}floor(){return new tt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new tt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){const t=new tt(0,0,0);return this.normalizeToRef(t),t}normalizeToRef(t){let e=this.length();return 0===e||1===e?t.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/e,t)}clone(){return new tt(this.x,this.y,this.z)}copyFrom(t){return this.copyFromFloats(t.x,t.y,t.z)}copyFromFloats(t,e,i){return this.x=t,this.y=e,this.z=i,this}set(t,e,i){return this.copyFromFloats(t,e,i)}setAll(t){return this.x=this.y=this.z=t,this}}const et={Vector3:a(6,tt.Zero),Matrix:a(2,J.Identity),Quaternion:a(3,$.Zero),staticUp:tt.Up(),tmpMatrix:J.Zero()};class it{}it.X=new tt(1,0,0),it.Y=new tt(0,1,0),it.Z=new tt(0,0,1);class nt{constructor(t=0,e=0,i=0,n=1){this.r=t,this.g=e,this.b=i,this.a=n}static FromHexString(t){if("#"!==t.substring(0,1)||9!==t.length)return new nt(0,0,0,0);let e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16),s=parseInt(t.substring(7,9),16);return nt.FromInts(e,i,n,s)}static Lerp(t,e,i){let n=new nt(0,0,0,0);return nt.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.r=t.r+(e.r-t.r)*i,n.g=t.g+(e.g-t.g)*i,n.b=t.b+(e.b-t.b)*i,n.a=t.a+(e.a-t.a)*i}static Red(){return new nt(1,0,0,1)}static Green(){return new nt(0,1,0,1)}static Blue(){return new nt(0,0,1,1)}static Black(){return new nt(0,0,0,1)}static White(){return new nt(1,1,1,1)}static Purple(){return new nt(.5,0,.5,1)}static Magenta(){return new nt(1,0,1,1)}static Yellow(){return new nt(1,1,0,1)}static Gray(){return new nt(.5,.5,.5,1)}static Teal(){return new nt(0,1,1,1)}static Clear(){return new nt(0,0,0,0)}static FromColor3(t,e=1){return new nt(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new nt(t[e],t[e+1],t[e+2],t[e+3])}static FromInts(t,e,i,n){return new nt(t/255,e/255,i/255,n/255)}static CheckColors4(t,e){if(t.length===3*e){let e=[];for(let i=0;i<t.length;i+=3){let n=i/3*4;e[n]=t[i],e[n+1]=t[i+1],e[n+2]=t[i+2],e[n+3]=1}return e}return t}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}asArray(){let t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}add(t){return new nt(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new nt(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this}scale(t){return new nt(this.r*t,this.g*t,this.b*t,this.a*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this}clampToRef(t=0,e=1,i){return i.r=Z.Clamp(this.r,t,e),i.g=Z.Clamp(this.g,t,e),i.b=Z.Clamp(this.b,t,e),i.a=Z.Clamp(this.a,t,e),this}multiply(t){return new nt(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=this.r||0;return t=397*(t=397*(t=397*t^(this.g||0))^(this.b||0))^(this.a||0)}clone(){return new nt(this.r,this.g,this.b,this.a)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this}set(t,e,i,n){return this.copyFromFloats(t,e,i,n)}toHexString(){let t=255*this.r|0,e=255*this.g|0,i=255*this.b|0,n=255*this.a|0;return"#"+Z.ToHex(t)+Z.ToHex(e)+Z.ToHex(i)+Z.ToHex(n)}toLinearSpace(){let t=new nt;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,Y),t.g=Math.pow(this.g,Y),t.b=Math.pow(this.b,Y),t.a=this.a,this}toGammaSpace(){let t=new nt;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,V),t.g=Math.pow(this.g,V),t.b=Math.pow(this.b,V),t.a=this.a,this}}class st{constructor(t=0,e=0,i=0){this.r=t,this.g=e,this.b=i}static FromHexString(t){if("#"!==t.substring(0,1)||7!==t.length)return new st(0,0,0);let e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16);return st.FromInts(e,i,n)}static FromArray(t,e=0){return new st(t[e],t[e+1],t[e+2])}static FromInts(t,e,i){return new st(t/255,e/255,i/255)}static Lerp(t,e,i){let n=new st(0,0,0);return st.LerpToRef(t,e,i,n),n}static LerpToRef(t,e,i,n){n.r=t.r+(e.r-t.r)*i,n.g=t.g+(e.g-t.g)*i,n.b=t.b+(e.b-t.b)*i}static Red(){return new st(1,0,0)}static Green(){return new st(0,1,0)}static Blue(){return new st(0,0,1)}static Black(){return new st(0,0,0)}static White(){return new st(1,1,1)}static Purple(){return new st(.5,0,.5)}static Magenta(){return new st(1,0,1)}static Yellow(){return new st(1,1,0)}static Gray(){return new st(.5,.5,.5)}static Teal(){return new st(0,1,1)}static Random(){return new st(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=this.r||0;return t=397*(t=397*t^(this.g||0))^(this.b||0)}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}toColor4(t=1){return new nt(this.r,this.g,this.b,t)}asArray(){let t=new Array;return this.toArray(t,0),t}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(t){return new st(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,i){return this.r===t&&this.g===e&&this.b===i}scale(t){return new st(this.r*t,this.g*t,this.b*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this}clampToRef(t=0,e=1,i){return i.r=Z.Clamp(this.r,t,e),i.g=Z.Clamp(this.g,t,e),i.b=Z.Clamp(this.b,t,e),this}add(t){return new st(this.r+t.r,this.g+t.g,this.b+t.b)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this}subtract(t){return new st(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this}clone(){return new st(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,i){return this.r=t,this.g=e,this.b=i,this}set(t,e,i){return this.copyFromFloats(t,e,i)}toHexString(){let t=255*this.r|0,e=255*this.g|0,i=255*this.b|0;return"#"+Z.ToHex(t)+Z.ToHex(e)+Z.ToHex(i)}toLinearSpace(){let t=new st;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,Y),t.g=Math.pow(this.g,Y),t.b=Math.pow(this.b,Y),this}toGammaSpace(){let t=new st;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,V),t.g=Math.pow(this.g,V),t.b=Math.pow(this.b,V),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}var ot=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},rt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const at={looping:!0,speed:1,weight:1};class ht extends M{constructor(t,e=at){super(),this.isAnimationClip=!0,this.looping=at.looping,this.weight=at.weight,this.playing=!1,this.shouldReset=!1,this.speed=at.speed,this.name=r("AnimClip"),this.clip=t,this.setParams(Object.assign({},e))}setParams(t){return this.looping=void 0!==t.looping?t.looping:this.looping,this.speed=t.speed||this.speed,this}toJSON(){const t=JSON.parse(JSON.stringify(super.toJSON()));return this.shouldReset&&(this.shouldReset=!1),t}play(){this.playing=!0}pause(){this.playing=!1}reset(){this.shouldReset=!0}stop(){this.reset(),this.pause()}}ot([M.readonly,rt("design:type",String)],ht.prototype,"clip",void 0),ot([M.field,rt("design:type",Boolean)],ht.prototype,"looping",void 0),ot([M.field,rt("design:type",Number)],ht.prototype,"weight",void 0),ot([M.field,rt("design:type",Boolean)],ht.prototype,"playing",void 0),ot([M.field,rt("design:type",Boolean)],ht.prototype,"shouldReset",void 0),ot([M.field,rt("design:type",Number)],ht.prototype,"speed",void 0),ot([M.readonly,rt("design:type",String)],ht.prototype,"name",void 0);var dt,lt=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},pt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t[t.TRANSFORM=1]="TRANSFORM",t[t.UUID_CALLBACK=8]="UUID_CALLBACK",t[t.BOX_SHAPE=16]="BOX_SHAPE",t[t.SPHERE_SHAPE=17]="SPHERE_SHAPE",t[t.PLANE_SHAPE=18]="PLANE_SHAPE",t[t.CONE_SHAPE=19]="CONE_SHAPE",t[t.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",t[t.TEXT_SHAPE=21]="TEXT_SHAPE",t[t.NFT_SHAPE=22]="NFT_SHAPE",t[t.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",t[t.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",t[t.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",t[t.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",t[t.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",t[t.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",t[t.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",t[t.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",t[t.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",t[t.BILLBOARD=32]="BILLBOARD",t[t.ANIMATION=33]="ANIMATION",t[t.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",t[t.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",t[t.GLTF_SHAPE=54]="GLTF_SHAPE",t[t.OBJ_SHAPE=55]="OBJ_SHAPE",t[t.AVATAR_SHAPE=56]="AVATAR_SHAPE",t[t.BASIC_MATERIAL=64]="BASIC_MATERIAL",t[t.PRB_MATERIAL=65]="PRB_MATERIAL",t[t.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",t[t.SOUND=67]="SOUND",t[t.TEXTURE=68]="TEXTURE",t[t.AUDIO_CLIP=200]="AUDIO_CLIP",t[t.AUDIO_SOURCE=201]="AUDIO_SOURCE",t[t.GIZMOS=203]="GIZMOS"}(dt||(dt={}));let ct=class extends M{constructor(t={}){super(),this.position=t.position||tt.Zero(),this.rotation=t.rotation||$.Identity,this.scale=t.scale||new tt(1,1,1)}get eulerAngles(){return this.rotation.eulerAngles}lookAt(t,e=et.staticUp){const i=new J;return J.LookAtLHToRef(this.position,t,e,i),i.invert(),$.FromRotationMatrixToRef(i,this.rotation),this}rotate(t,e){return this.rotation.multiplyInPlace(this.rotation.angleAxis(e,t)),this}translate(t){return this.position.addInPlace(t),this}};lt([M.field,pt("design:type",tt)],ct.prototype,"position",void 0),lt([M.field,pt("design:type",$)],ct.prototype,"rotation",void 0),lt([M.field,pt("design:type",tt)],ct.prototype,"scale",void 0),ct=lt([C("engine.transform",dt.TRANSFORM),pt("design:paramtypes",[Object])],ct);let ut=class extends M{constructor(t=!0,e=!0,i=!0){super(),this.x=!0,this.y=!0,this.z=!0,this.x=t,this.y=e,this.z=i}};lt([M.field,pt("design:type",Boolean)],ut.prototype,"x",void 0),lt([M.field,pt("design:type",Boolean)],ut.prototype,"y",void 0),lt([M.field,pt("design:type",Boolean)],ut.prototype,"z",void 0),ut=lt([C("engine.billboard",dt.BILLBOARD),pt("design:paramtypes",[Boolean,Boolean,Boolean])],ut);class yt extends M{constructor(){super(...arguments),this.withCollisions=!0,this.visible=!0}}lt([M.field,pt("design:type",Boolean)],yt.prototype,"withCollisions",void 0),lt([M.field,pt("design:type",Boolean)],yt.prototype,"visible",void 0);let ft=class extends yt{};ft=lt([S("engine.shape",dt.BOX_SHAPE)],ft);let mt=class extends yt{};mt=lt([S("engine.shape",dt.SPHERE_SHAPE)],mt);let gt=class extends yt{};lt([M.field,pt("design:type",Number)],gt.prototype,"segments",void 0),lt([M.field,pt("design:type",Number)],gt.prototype,"arc",void 0),gt=lt([S("engine.shape",dt.CIRCLE_SHAPE)],gt);let wt=class extends yt{constructor(){super(...arguments),this.width=1,this.height=1}};lt([M.field,pt("design:type",Number)],wt.prototype,"width",void 0),lt([M.field,pt("design:type",Number)],wt.prototype,"height",void 0),lt([M.field,pt("design:type",Array)],wt.prototype,"uvs",void 0),wt=lt([S("engine.shape",dt.PLANE_SHAPE)],wt);let vt=class extends yt{constructor(){super(...arguments),this.radiusTop=0,this.radiusBottom=1,this.segmentsHeight=1,this.segmentsRadial=36,this.openEnded=!1,this.radius=null,this.arc=360}};lt([M.field,pt("design:type",Number)],vt.prototype,"radiusTop",void 0),lt([M.field,pt("design:type",Number)],vt.prototype,"radiusBottom",void 0),lt([M.field,pt("design:type",Number)],vt.prototype,"segmentsHeight",void 0),lt([M.field,pt("design:type",Number)],vt.prototype,"segmentsRadial",void 0),lt([M.field,pt("design:type",Boolean)],vt.prototype,"openEnded",void 0),lt([M.field,pt("design:type",Object)],vt.prototype,"radius",void 0),lt([M.field,pt("design:type",Number)],vt.prototype,"arc",void 0),vt=lt([S("engine.shape",dt.CONE_SHAPE)],vt);let Rt=class extends yt{constructor(){super(...arguments),this.radiusTop=0,this.radiusBottom=1,this.segmentsHeight=1,this.segmentsRadial=36,this.openEnded=!1,this.radius=null,this.arc=360}};lt([M.field,pt("design:type",Number)],Rt.prototype,"radiusTop",void 0),lt([M.field,pt("design:type",Number)],Rt.prototype,"radiusBottom",void 0),lt([M.field,pt("design:type",Number)],Rt.prototype,"segmentsHeight",void 0),lt([M.field,pt("design:type",Number)],Rt.prototype,"segmentsRadial",void 0),lt([M.field,pt("design:type",Boolean)],Rt.prototype,"openEnded",void 0),lt([M.field,pt("design:type",Object)],Rt.prototype,"radius",void 0),lt([M.field,pt("design:type",Number)],Rt.prototype,"arc",void 0),Rt=lt([S("engine.shape",dt.CYLINDER_SHAPE)],Rt);let xt=class extends yt{constructor(t){super(),this.src=t}};lt([yt.readonly,pt("design:type",String)],xt.prototype,"src",void 0),xt=lt([S("engine.shape",dt.GLTF_SHAPE),pt("design:paramtypes",[String])],xt);let bt=class extends yt{constructor(t,e=new st(.6404918,.611472,.8584906)){super(),this.src=t,this.color=e}};lt([yt.readonly,pt("design:type",String)],bt.prototype,"src",void 0),lt([M.field,pt("design:type",st)],bt.prototype,"color",void 0),bt=lt([S("engine.shape",dt.NFT_SHAPE),pt("design:paramtypes",[String,st])],bt);let Tt=class extends M{constructor(t,e){if(super(),this.src=t,e)for(let t in e)this[t]=e[t]}};lt([M.readonly,pt("design:type",String)],Tt.prototype,"src",void 0),lt([M.readonly,pt("design:type",Number)],Tt.prototype,"samplingMode",void 0),lt([M.readonly,pt("design:type",Number)],Tt.prototype,"wrap",void 0),lt([M.readonly,pt("design:type",Boolean)],Tt.prototype,"hasAlpha",void 0),Tt=lt([S("engine.texture",dt.TEXTURE),pt("design:paramtypes",[String,Object])],Tt);let _t=class extends yt{constructor(){super(...arguments),this.states=[]}addClip(t){return this.states.push(t),t.onChange(()=>{this.dirty=!0}),this}getClip(t){for(let e=0;e<this.states.length;e++){const i=this.states[e];if(i.clip===t)return i}const e=new ht(t);return this.addClip(e),e}};lt([M.readonly,pt("design:type",Array)],_t.prototype,"states",void 0),_t=lt([C("engine.animator",dt.ANIMATION)],_t);let At=class extends yt{constructor(t){super(),this.src=t}};lt([M.readonly,pt("design:type",String)],At.prototype,"src",void 0),At=lt([S("engine.shape",dt.OBJ_SHAPE),pt("design:paramtypes",[String])],At);let zt=class extends yt{constructor(t){super(),this.outlineWidth=0,this.outlineColor=new st(1,1,1),this.color=new st(1,1,1),this.fontSize=10,this.fontWeight="normal",this.opacity=1,this.value="",this.lineSpacing="0px",this.lineCount=0,this.resizeToFit=!1,this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=new st(1,1,1),this.zIndex=0,this.hTextAlign="center",this.vTextAlign="center",this.width=1,this.height=1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.isPickable=!1,this.billboard=!1,t&&(this.value=t)}};lt([M.field,pt("design:type",Number)],zt.prototype,"outlineWidth",void 0),lt([M.field,pt("design:type",st)],zt.prototype,"outlineColor",void 0),lt([M.field,pt("design:type",st)],zt.prototype,"color",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"fontSize",void 0),lt([M.field,pt("design:type",String)],zt.prototype,"fontWeight",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"opacity",void 0),lt([M.field,pt("design:type",String)],zt.prototype,"value",void 0),lt([M.field,pt("design:type",String)],zt.prototype,"lineSpacing",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"lineCount",void 0),lt([M.field,pt("design:type",Boolean)],zt.prototype,"resizeToFit",void 0),lt([M.field,pt("design:type",Boolean)],zt.prototype,"textWrapping",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"shadowBlur",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"shadowOffsetX",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"shadowOffsetY",void 0),lt([M.field,pt("design:type",st)],zt.prototype,"shadowColor",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"zIndex",void 0),lt([M.field,pt("design:type",String)],zt.prototype,"hTextAlign",void 0),lt([M.field,pt("design:type",String)],zt.prototype,"vTextAlign",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"width",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"height",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"paddingTop",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"paddingRight",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"paddingBottom",void 0),lt([M.field,pt("design:type",Number)],zt.prototype,"paddingLeft",void 0),lt([M.field,pt("design:type",Boolean)],zt.prototype,"isPickable",void 0),lt([M.field,pt("design:type",Boolean)],zt.prototype,"billboard",void 0),zt=lt([C("engine.text",dt.TEXT_SHAPE),pt("design:paramtypes",[String])],zt);let Et=class extends M{constructor(){super(...arguments),this.transparencyMode=4}};lt([M.field,pt("design:type",Number)],Et.prototype,"alpha",void 0),lt([M.field,pt("design:type",st)],Et.prototype,"albedoColor",void 0),lt([M.field,pt("design:type",st)],Et.prototype,"emissiveColor",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"metallic",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"roughness",void 0),lt([M.field,pt("design:type",st)],Et.prototype,"ambientColor",void 0),lt([M.field,pt("design:type",st)],Et.prototype,"reflectionColor",void 0),lt([M.field,pt("design:type",st)],Et.prototype,"reflectivityColor",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"directIntensity",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"microSurface",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"emissiveIntensity",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"environmentIntensity",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"specularIntensity",void 0),lt([M.component,pt("design:type",Tt)],Et.prototype,"albedoTexture",void 0),lt([M.component,pt("design:type",Tt)],Et.prototype,"alphaTexture",void 0),lt([M.component,pt("design:type",Tt)],Et.prototype,"emissiveTexture",void 0),lt([M.component,pt("design:type",Tt)],Et.prototype,"bumpTexture",void 0),lt([M.component,pt("design:type",Tt)],Et.prototype,"refractionTexture",void 0),lt([M.field,pt("design:type",Boolean)],Et.prototype,"disableLighting",void 0),lt([M.field,pt("design:type",Number)],Et.prototype,"transparencyMode",void 0),lt([M.field,pt("design:type",Boolean)],Et.prototype,"hasAlpha",void 0),Et=lt([S("engine.material",dt.PRB_MATERIAL)],Et);let Ct=class extends M{constructor(){super(...arguments),this.alphaTest=.5}};lt([M.component,pt("design:type",Tt)],Ct.prototype,"texture",void 0),lt([M.field,pt("design:type",Number)],Ct.prototype,"alphaTest",void 0),Ct=lt([S("engine.material",dt.BASIC_MATERIAL)],Ct);class St extends M{constructor(t){if(super(),this.uuid=r("UUID"),!(t&&"apply"in t&&"call"in t))throw new Error("Callback is not a function");this.callback=t}static uuidEvent(t,e){if(delete t[e]){const i=e+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Object.assign({},Object.getOwnPropertyDescriptor(t,i),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[i]},set:function(t){const n=this[i];if(t){if(!(t instanceof St))throw new Error("value is not an OnUUIDEvent");this.data[e]=t.uuid}else this.data[e]=null;if(this[i]=t,t!==n){this.dirty=!0;for(let i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})}}toJSON(){return{uuid:this.uuid,type:this.type}}}lt([M.field,pt("design:type",Function)],St.prototype,"callback",void 0);let Pt=class extends St{constructor(){super(...arguments),this.type="onPointerLock"}};lt([M.readonly,pt("design:type",String)],Pt.prototype,"type",void 0),Pt=lt([C("engine.onPointerLock",dt.UUID_CALLBACK)],Pt);let It=class extends St{constructor(){super(...arguments),this.type="onAnimationEnd"}};var Nt;lt([M.readonly,pt("design:type",String)],It.prototype,"type",void 0),It=lt([C("engine.onAnimationEnd",dt.UUID_CALLBACK)],It),function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP"}(Nt||(Nt={}));var Mt,Ft=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};!function(t){t.POINTER="POINTER",t.PRIMARY="PRIMARY",t.SECONDARY="SECONDARY"}(Mt||(Mt={}));class Ot{constructor(t){if(this.callback=t,!(t&&"apply"in t&&"call"in t))throw new Error("Callback is not a function");Ht.ensureInstance()}}let Lt=class extends Ot{};Lt=Ft([C("pointerDown")],Lt);let Bt=class extends Ot{};Bt=Ft([C("pointerUp")],Bt);class Ut{constructor(t,e){this.fn=t,this.useRaycast=e}}class Ht{constructor(){this.subscriptions={[Mt.POINTER]:{BUTTON_DOWN:[],BUTTON_UP:[]},[Mt.PRIMARY]:{BUTTON_DOWN:[],BUTTON_UP:[]},[Mt.SECONDARY]:{BUTTON_DOWN:[],BUTTON_UP:[]}},this.internalState={[Mt.POINTER]:{BUTTON_DOWN:!1},[Mt.PRIMARY]:{BUTTON_DOWN:!1},[Mt.SECONDARY]:{BUTTON_DOWN:!1}}}static get instance(){return Ht.ensureInstance(),Ht._instance}static ensureInstance(){Ht._instance||(Ht._instance=new Ht)}isButtonPressed(t){return this.internalState[t]}subscribe(t,e,i,n){return this.subscriptions[e][t].push(new Ut(n,i)),()=>this.unsubscribe(t,e,n)}unsubscribe(t,e,i){const n=this.getSubscriptionId(t,e,i);return n>-1&&this.subscriptions[e][t].splice(n,1)}handlePointerEvent(t){const e=this.getPointerById(t.buttonId);let i=Object.assign({},t,{button:e,direction:(new tt).copyFrom(t.direction),origin:(new tt).copyFrom(t.origin),hit:void 0});const n=t.hit?Object.assign({},t.hit,{hitPoint:(new tt).copyFrom(t.hit.hitPoint),normal:(new tt).copyFrom(t.hit.normal),worldNormal:(new tt).copyFrom(t.hit.worldNormal)}):void 0;if(t.type===Nt.DOWN){this.internalState[e].BUTTON_DOWN=!0;for(let t=0;t<this.subscriptions[e].BUTTON_DOWN.length;t++){let s=this.subscriptions[e].BUTTON_DOWN[t];s.useRaycast?i.hit=n:i.hit=void 0,s.fn(i)}if(n&&n.entityId&&S.engine){const t=S.engine.entities[n.entityId],e=t&&t.getComponentOrNull(Lt);e&&(i.hit=n,e.callback(i))}}else{this.internalState[e].BUTTON_DOWN=!1;for(let t=0;t<this.subscriptions[e].BUTTON_UP.length;t++){let s=this.subscriptions[e].BUTTON_UP[t];s.useRaycast?i.hit=n:i.hit=void 0,s.fn(i)}if(n&&n.entityId&&S.engine){const t=S.engine.entities[n.entityId],e=t&&t.getComponentOrNull(Bt);e&&(i.hit=n,e.callback(i))}}}getSubscriptionId(t,e,i){for(let n=0;n<this.subscriptions[e][t].length;n++)if(this.subscriptions[e][t][n].fn===i)return n;return-1}getPointerById(t){return 0===t?Mt.POINTER:1===t?Mt.PRIMARY:Mt.SECONDARY}}const Dt=new class{activate(t){t.eventManager.addListener(D,this,t=>{Ht.instance.handlePointerEvent(t.payload)}),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("pointerEvent"))}deactivate(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("pointerEvent"))}};const jt=new class{constructor(){this.handlerMap={}}activate(t){t.eventManager.addListener(H,this,this.handleEvent),t.eventManager.addListener(m,this,this.componentAdded),t.eventManager.addListener(f,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")}deactivate(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")}onAddEntity(t){for(let e in t.components){const i=t.components[e];i instanceof St&&(this.handlerMap[i.uuid]=i)}}onRemoveEntity(t){for(let e in t.components){const i=t.components[e];i instanceof St&&delete this.handlerMap[i.uuid]}}componentAdded(t){if(t.entity.isAddedToEngine()){const e=t.entity.components[t.componentName];e instanceof St&&(this.handlerMap[e.uuid]=e)}}componentRemoved(t){t.entity.isAddedToEngine()&&t.component instanceof St&&delete this.handlerMap[t.component.uuid]}handleEvent(t){if(t.uuid in this.handlerMap){const e=this.handlerMap[t.uuid];e&&e.callback&&"call"in e.callback&&e.callback(t.payload)}}};class Wt{constructor(){this.position=new tt,this.rotation=new $,this.feetPosition=new tt,this.worldPosition=new tt,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.onEvent(t=>{switch(t.type){case"positionChanged":this.positionChanged(t.data);break;case"rotationChanged":this.rotationChanged(t.data)}})),Object.defineProperty(this.position,"x",{get:()=>this.lastEventPosition.x}),Object.defineProperty(this.position,"y",{get:()=>this.lastEventPosition.y}),Object.defineProperty(this.position,"z",{get:()=>this.lastEventPosition.z}),Object.defineProperty(this.worldPosition,"x",{get:()=>this.lastEventWorldPosition.x}),Object.defineProperty(this.worldPosition,"y",{get:()=>this.lastEventWorldPosition.y}),Object.defineProperty(this.worldPosition,"z",{get:()=>this.lastEventWorldPosition.z}),Object.defineProperty(this.feetPosition,"x",{get:()=>this.lastEventPosition.x}),Object.defineProperty(this.feetPosition,"y",{get:()=>this.lastEventPosition.y-this.playerHeight}),Object.defineProperty(this.feetPosition,"z",{get:()=>this.lastEventPosition.z}),Object.defineProperty(this.rotation,"x",{get:()=>this.lastEventRotation.x}),Object.defineProperty(this.rotation,"y",{get:()=>this.lastEventRotation.y}),Object.defineProperty(this.rotation,"z",{get:()=>this.lastEventRotation.z}),Object.defineProperty(this.rotation,"w",{get:()=>this.lastEventRotation.w})}static get instance(){return Wt._instance||(Wt._instance=new Wt),Wt._instance}get playerHeight(){return this._playerHeight}positionChanged(t){this.lastEventPosition=t.position,this.lastEventWorldPosition=t.cameraPosition,this._playerHeight=t.playerHeight}rotationChanged(t){this.lastEventRotation=t.quaternion}}var kt=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},qt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Vt=class extends M{constructor(t){super(),this.loop=!1,this.volume=1,this.url=t}};kt([M.readonly,qt("design:type",String)],Vt.prototype,"url",void 0),kt([M.field,qt("design:type",Boolean)],Vt.prototype,"loop",void 0),kt([M.field,qt("design:type",String)],Vt.prototype,"loadingCompleteEventId",void 0),kt([M.field,qt("design:type",Number)],Vt.prototype,"volume",void 0),Vt=kt([S("engine.AudioClip",dt.AUDIO_CLIP),qt("design:paramtypes",[String])],Vt);let Yt=class extends M{constructor(t){if(super(),this.audioClip=t,this.loop=!1,this.volume=1,this.playing=!1,this.pitch=1,!(t instanceof Vt))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");this.audioClipId=N(t)}playOnce(){return this.playing=!0,this.dirty=!0,this.data.nonce=Math.random(),this}};kt([M.readonly,qt("design:type",String)],Yt.prototype,"audioClipId",void 0),kt([M.field,qt("design:type",Boolean)],Yt.prototype,"loop",void 0),kt([M.field,qt("design:type",Number)],Yt.prototype,"volume",void 0),kt([M.field,qt("design:type",Boolean)],Yt.prototype,"playing",void 0),kt([M.field,qt("design:type",Number)],Yt.prototype,"pitch",void 0),Yt=kt([C("engine.AudioSource",dt.AUDIO_SOURCE),qt("design:paramtypes",[Vt])],Yt);var Gt,Xt=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},Qt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t.MOVE="MOVE",t.ROTATE="ROTATE",t.SCALE="SCALE",t.NONE="NONE"}(Gt||(Gt={}));let Zt=class extends St{constructor(){super(...arguments),this.type="gizmoEvent"}};Xt([M.readonly,Qt("design:type",String)],Zt.prototype,"type",void 0),Zt=Xt([C("engine.gizmoEvent",dt.UUID_CALLBACK)],Zt);let Kt=class extends M{constructor(){super(...arguments),this.position=!0,this.rotation=!0,this.scale=!0,this.cycle=!0,this.localReference=!1}};Xt([M.field,Qt("design:type",Boolean)],Kt.prototype,"position",void 0),Xt([M.field,Qt("design:type",Boolean)],Kt.prototype,"rotation",void 0),Xt([M.field,Qt("design:type",Boolean)],Kt.prototype,"scale",void 0),Xt([M.field,Qt("design:type",Boolean)],Kt.prototype,"cycle",void 0),Xt([M.field,Qt("design:type",String)],Kt.prototype,"selectedGizmo",void 0),Xt([M.field,Qt("design:type",Boolean)],Kt.prototype,"localReference",void 0),Kt=Xt([C("engine.gizmos",dt.GIZMOS)],Kt);var Jt=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},$t=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class te extends M{constructor(t){super(),this.name=null,this.visible=!0,this.opacity=1,this.hAlign="center",this.vAlign="center",this.width="100px",this.height="50px",this.positionX="0px",this.positionY="0px",this.isPointerBlocker=!0,t&&(this._parent=t,this.data.parentComponent=N(t))}get parent(){return this._parent}get parentComponent(){return this.data.parentComponent}}Jt([M.field,$t("design:type",Object)],te.prototype,"name",void 0),Jt([M.field,$t("design:type",Boolean)],te.prototype,"visible",void 0),Jt([M.field,$t("design:type",Number)],te.prototype,"opacity",void 0),Jt([M.field,$t("design:type",String)],te.prototype,"hAlign",void 0),Jt([M.field,$t("design:type",String)],te.prototype,"vAlign",void 0),Jt([M.uiValue,$t("design:type",Object)],te.prototype,"width",void 0),Jt([M.uiValue,$t("design:type",Object)],te.prototype,"height",void 0),Jt([M.uiValue,$t("design:type",Object)],te.prototype,"positionX",void 0),Jt([M.uiValue,$t("design:type",Object)],te.prototype,"positionY",void 0),Jt([M.field,$t("design:type",Boolean)],te.prototype,"isPointerBlocker",void 0);let ee=class extends te{constructor(){super(null)}};ee=Jt([S("engine.shape",dt.UI_FULLSCREEN_SHAPE),$t("design:paramtypes",[])],ee);let ie=class extends te{constructor(){super(null)}};ie=Jt([S("engine.shape",dt.UI_WORLD_SPACE_SHAPE),$t("design:paramtypes",[])],ie);let ne=class extends te{constructor(){super(null)}};ne=Jt([S("engine.shape",dt.UI_SCREEN_SPACE_SHAPE),$t("design:paramtypes",[])],ne);let se=class extends te{constructor(){super(...arguments),this.adaptWidth=!1,this.adaptHeight=!1,this.thickness=0,this.color=nt.Clear(),this.alignmentUsesSize=!0}};var oe;Jt([M.field,$t("design:type",Boolean)],se.prototype,"adaptWidth",void 0),Jt([M.field,$t("design:type",Boolean)],se.prototype,"adaptHeight",void 0),Jt([M.field,$t("design:type",Number)],se.prototype,"thickness",void 0),Jt([M.field,$t("design:type",nt)],se.prototype,"color",void 0),Jt([M.field,$t("design:type",Boolean)],se.prototype,"alignmentUsesSize",void 0),se=Jt([S("engine.shape",dt.UI_CONTAINER_RECT)],se),function(t){t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL"}(oe||(oe={}));let re=class extends te{constructor(){super(...arguments),this.adaptWidth=!0,this.adaptHeight=!0,this.color=nt.Clear(),this.stackOrientation=oe.VERTICAL,this.spacing=0}};Jt([M.field,$t("design:type",Boolean)],re.prototype,"adaptWidth",void 0),Jt([M.field,$t("design:type",Boolean)],re.prototype,"adaptHeight",void 0),Jt([M.field,$t("design:type",nt)],re.prototype,"color",void 0),Jt([M.field,$t("design:type",Number)],re.prototype,"stackOrientation",void 0),Jt([M.field,$t("design:type",Number)],re.prototype,"spacing",void 0),re=Jt([S("engine.shape",dt.UI_CONTAINER_STACK)],re);let ae=class extends te{constructor(){super(...arguments),this.fontSize=10,this.fontWeight="normal",this.thickness=0,this.cornerRadius=0,this.color=nt.White(),this.background=nt.White(),this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=nt.Black(),this.text="button"}};Jt([M.field,$t("design:type",Number)],ae.prototype,"fontSize",void 0),Jt([M.field,$t("design:type",String)],ae.prototype,"fontWeight",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"thickness",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"cornerRadius",void 0),Jt([M.field,$t("design:type",nt)],ae.prototype,"color",void 0),Jt([M.field,$t("design:type",nt)],ae.prototype,"background",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"paddingTop",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"paddingRight",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"paddingBottom",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"paddingLeft",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"shadowBlur",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"shadowOffsetX",void 0),Jt([M.field,$t("design:type",Number)],ae.prototype,"shadowOffsetY",void 0),Jt([M.field,$t("design:type",nt)],ae.prototype,"shadowColor",void 0),Jt([M.field,$t("design:type",String)],ae.prototype,"text",void 0),ae=Jt([S("engine.shape",dt.UI_BUTTON_SHAPE)],ae);let he=class extends te{constructor(){super(...arguments),this.outlineWidth=0,this.outlineColor=nt.White(),this.color=nt.White(),this.fontSize=10,this.fontAutoSize=!1,this.fontWeight="normal",this.value="",this.lineSpacing=0,this.lineCount=0,this.adaptWidth=!1,this.adaptHeight=!1,this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=nt.Black(),this.hTextAlign="left",this.vTextAlign="bottom",this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0}};Jt([M.field,$t("design:type",Number)],he.prototype,"outlineWidth",void 0),Jt([M.field,$t("design:type",nt)],he.prototype,"outlineColor",void 0),Jt([M.field,$t("design:type",nt)],he.prototype,"color",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"fontSize",void 0),Jt([M.field,$t("design:type",Boolean)],he.prototype,"fontAutoSize",void 0),Jt([M.field,$t("design:type",String)],he.prototype,"fontWeight",void 0),Jt([M.field,$t("design:type",String)],he.prototype,"value",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"lineSpacing",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"lineCount",void 0),Jt([M.field,$t("design:type",Boolean)],he.prototype,"adaptWidth",void 0),Jt([M.field,$t("design:type",Boolean)],he.prototype,"adaptHeight",void 0),Jt([M.field,$t("design:type",Boolean)],he.prototype,"textWrapping",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"shadowBlur",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"shadowOffsetX",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"shadowOffsetY",void 0),Jt([M.field,$t("design:type",nt)],he.prototype,"shadowColor",void 0),Jt([M.field,$t("design:type",String)],he.prototype,"hTextAlign",void 0),Jt([M.field,$t("design:type",String)],he.prototype,"vTextAlign",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"paddingTop",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"paddingRight",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"paddingBottom",void 0),Jt([M.field,$t("design:type",Number)],he.prototype,"paddingLeft",void 0),he=Jt([S("engine.shape",dt.UI_TEXT_SHAPE)],he);let de=class extends te{constructor(){super(...arguments),this.outlineWidth=0,this.outlineColor=nt.Black(),this.color=nt.Clear(),this.thickness=1,this.fontSize=10,this.fontWeight="normal",this.value="",this.placeholderColor=nt.White(),this.placeholder="",this.margin=10,this.maxWidth=100,this.hTextAlign="left",this.vTextAlign="bottom",this.autoStretchWidth=!0,this.background=nt.Black(),this.focusedBackground=nt.Black(),this.textWrapping=!1,this.shadowBlur=0,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowColor=nt.White(),this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.onTextSubmit=null,this.onChanged=null,this.onFocus=null,this.onBlur=null}};Jt([M.field,$t("design:type",Number)],de.prototype,"outlineWidth",void 0),Jt([M.field,$t("design:type",nt)],de.prototype,"outlineColor",void 0),Jt([M.field,$t("design:type",nt)],de.prototype,"color",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"thickness",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"fontSize",void 0),Jt([M.field,$t("design:type",String)],de.prototype,"fontWeight",void 0),Jt([M.field,$t("design:type",String)],de.prototype,"value",void 0),Jt([M.field,$t("design:type",nt)],de.prototype,"placeholderColor",void 0),Jt([M.field,$t("design:type",String)],de.prototype,"placeholder",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"margin",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"maxWidth",void 0),Jt([M.field,$t("design:type",String)],de.prototype,"hTextAlign",void 0),Jt([M.field,$t("design:type",String)],de.prototype,"vTextAlign",void 0),Jt([M.field,$t("design:type",Boolean)],de.prototype,"autoStretchWidth",void 0),Jt([M.field,$t("design:type",nt)],de.prototype,"background",void 0),Jt([M.field,$t("design:type",nt)],de.prototype,"focusedBackground",void 0),Jt([M.field,$t("design:type",Boolean)],de.prototype,"textWrapping",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"shadowBlur",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"shadowOffsetX",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"shadowOffsetY",void 0),Jt([M.field,$t("design:type",nt)],de.prototype,"shadowColor",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"paddingTop",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"paddingRight",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"paddingBottom",void 0),Jt([M.field,$t("design:type",Number)],de.prototype,"paddingLeft",void 0),Jt([St.uuidEvent,$t("design:type",Object)],de.prototype,"onTextSubmit",void 0),Jt([St.uuidEvent,$t("design:type",Object)],de.prototype,"onChanged",void 0),Jt([St.uuidEvent,$t("design:type",Object)],de.prototype,"onFocus",void 0),Jt([St.uuidEvent,$t("design:type",Object)],de.prototype,"onBlur",void 0),de=Jt([S("engine.shape",dt.UI_INPUT_TEXT_SHAPE)],de);let le=class extends te{constructor(t,e){super(t),this.sourceLeft=0,this.sourceTop=0,this.sourceWidth=1,this.sourceHeight=1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.sizeInPixels=!0,this.onClick=null,this.source=e}};Jt([M.field,$t("design:type",Number)],le.prototype,"sourceLeft",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"sourceTop",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"sourceWidth",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"sourceHeight",void 0),Jt([M.component,$t("design:type",Tt)],le.prototype,"source",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"paddingTop",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"paddingRight",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"paddingBottom",void 0),Jt([M.field,$t("design:type",Number)],le.prototype,"paddingLeft",void 0),Jt([M.field,$t("design:type",Boolean)],le.prototype,"sizeInPixels",void 0),Jt([St.uuidEvent,$t("design:type",Object)],le.prototype,"onClick",void 0),le=Jt([S("engine.shape",dt.UI_IMAGE_SHAPE),$t("design:paramtypes",[te,Tt])],le);let pe=class extends te{constructor(){super(...arguments),this.valueX=0,this.valueY=0,this.borderColor=nt.White(),this.backgroundColor=nt.Clear(),this.isHorizontal=!1,this.isVertical=!1,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.paddingLeft=0,this.onChanged=null}};Jt([M.field,$t("design:type",Number)],pe.prototype,"valueX",void 0),Jt([M.field,$t("design:type",Number)],pe.prototype,"valueY",void 0),Jt([M.field,$t("design:type",nt)],pe.prototype,"borderColor",void 0),Jt([M.field,$t("design:type",nt)],pe.prototype,"backgroundColor",void 0),Jt([M.field,$t("design:type",Boolean)],pe.prototype,"isHorizontal",void 0),Jt([M.field,$t("design:type",Boolean)],pe.prototype,"isVertical",void 0),Jt([M.field,$t("design:type",Number)],pe.prototype,"paddingTop",void 0),Jt([M.field,$t("design:type",Number)],pe.prototype,"paddingRight",void 0),Jt([M.field,$t("design:type",Number)],pe.prototype,"paddingBottom",void 0),Jt([M.field,$t("design:type",Number)],pe.prototype,"paddingLeft",void 0),Jt([St.uuidEvent,$t("design:type",Object)],pe.prototype,"onChanged",void 0),pe=Jt([S("engine.shape",dt.UI_SLIDER_SHAPE)],pe);var ce,ue=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},ye=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class fe{constructor(t,e,i=[]){this.category=t,this.contentName=e,this.contents=i}}class me{constructor(t){this.color=t}}class ge{constructor(t){this.color=t}}class we{constructor(t){this.texture=t}}class ve{constructor(t,e,i){this.texture=t,this.mask=e,this.color=i}}let Re=ce=class extends M{constructor(){super(...arguments),this.useDummyModel=!1}static Dummy(){const t=new ce;return t.useDummyModel=!0,t}};ue([M.field,ye("design:type",String)],Re.prototype,"id",void 0),ue([M.field,ye("design:type",String)],Re.prototype,"baseUrl",void 0),ue([M.field,ye("design:type",String)],Re.prototype,"name",void 0),ue([M.field,ye("design:type",fe)],Re.prototype,"bodyShape",void 0),ue([M.field,ye("design:type",Array)],Re.prototype,"wearables",void 0),ue([M.field,ye("design:type",me)],Re.prototype,"skin",void 0),ue([M.field,ye("design:type",ge)],Re.prototype,"hair",void 0),ue([M.field,ye("design:type",ve)],Re.prototype,"eyes",void 0),ue([M.field,ye("design:type",we)],Re.prototype,"eyebrows",void 0),ue([M.field,ye("design:type",we)],Re.prototype,"mouth",void 0),ue([M.field,ye("design:type",Boolean)],Re.prototype,"useDummyModel",void 0),Re=ce=ue([C("engine.avatarShape",dt.AVATAR_SHAPE)],Re);var xe=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},be=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Te=class extends St{constructor(t){super(t),this.type="onFocus",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],Te.prototype,"type",void 0),Te=xe([C("engine.onFocus",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],Te);let _e=class extends St{constructor(t){super(t),this.type="onTextSubmit",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],_e.prototype,"type",void 0),_e=xe([C("engine.onTextSubmit",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],_e);let Ae=class extends St{constructor(t){super(t),this.type="onBlur",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],Ae.prototype,"type",void 0),Ae=xe([C("engine.onBlur",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],Ae);let ze=class extends St{constructor(t){super(t),this.type="onClick",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],ze.prototype,"type",void 0),ze=xe([C("engine.onClick",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],ze);let Ee=class extends St{constructor(t){super(t),this.type="onEnter",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],Ee.prototype,"type",void 0),Ee=xe([C("engine.onEnter",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],Ee);let Ce=class extends St{constructor(t){super(t),this.type="onChange",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],Ce.prototype,"type",void 0),Ce=xe([C("engine.onChange",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],Ce);let Se=class extends St{constructor(t){super(t),this.type="pointerDown",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],Se.prototype,"type",void 0),Se=xe([C("engine.pointerDown",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],Se);let Pe=class extends St{constructor(t){super(t),this.type="pointerUp",jt.handlerMap[this.uuid]=this}};xe([M.readonly,be("design:type",String)],Pe.prototype,"type",void 0),Pe=xe([C("engine.pointerUp",dt.UUID_CALLBACK),be("design:paramtypes",[Function])],Pe);i.d(e,"M",function(){return Ne}),i.d(e,"l",function(){return C}),i.d(e,"m",function(){return L}),i.d(e,"N",function(){return s}),i.d(e,"F",function(){return ct}),i.d(e,"g",function(){return ut}),i.d(e,"h",function(){return ft}),i.d(e,"z",function(){return wt}),i.d(e,"p",function(){return xt}),i.d(e,"u",function(){return bt}),i.d(e,"E",function(){return Tt}),i.d(e,"c",function(){return _t}),i.d(e,"v",function(){return At}),i.d(e,"D",function(){return zt}),i.d(e,"t",function(){return Et}),i.d(e,"i",function(){return Wt}),i.d(e,"j",function(){return st}),i.d(e,"k",function(){return nt}),i.d(e,"A",function(){return $}),i.d(e,"B",function(){return Z}),i.d(e,"K",function(){return tt}),i.d(e,"b",function(){return ht}),i.d(e,"a",function(){return Mt}),i.d(e,"s",function(){return Ht}),i.d(e,"d",function(){return Vt}),i.d(e,"e",function(){return Yt}),i.d(e,"x",function(){return Zt}),i.d(e,"q",function(){return Kt}),i.d(e,"G",function(){return ne}),i.d(e,"H",function(){return se}),i.d(e,"J",function(){return he}),i.d(e,"I",function(){return le}),i.d(e,"L",function(){return fe}),i.d(e,"C",function(){return me}),i.d(e,"r",function(){return ge}),i.d(e,"o",function(){return we}),i.d(e,"n",function(){return ve}),i.d(e,"f",function(){return Re}),i.d(e,"w",function(){return ze}),i.d(e,"y",function(){return Se});const Ie=new L("scene");Ie.uuid="0";const Ne=new class{constructor(t){this.eventManager=new p,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(m,this,this.componentAddedHandler),this.eventManager.addListener(f,this,this.componentRemovedHandler),this.rootEntity=t}get entities(){return this._entities}get disposableComponents(){return this._disposableComponents}addEntity(t){const e=t.getParent();if(t.isAddedToEngine())return t;t.eventManager=this.eventManager,t.engine=this,this._entities[t.uuid]=t,this.checkRequirementsAndAdd(t),e?e.isAddedToEngine()||e===this.rootEntity||s("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+e.uuid):t.setParent(this.rootEntity),t.alive=!0;for(let e in t.children){const i=t.children[e];i&&(i.isAddedToEngine()||this.addEntity(i))}return t}removeEntity(t){const e=t.uuid;if(t.isAddedToEngine()){for(let i in t.components){const n=this._componentGroups[i];if(n)for(let e in n)n[e].removeEntity(t);delete this.entityLists[i][e]}for(let e=0;e<this.simpleSystems.length;e++){const i=this.simpleSystems[e];i.onRemoveEntity&&i.onRemoveEntity(t)}for(let e in t.children){const i=t.children[e];i&&this.removeEntity(i)}return t.alive=!1,t.eventManager=null,delete this._entities[e],!0}s("Engine: Trying to remove non existent entity from engine."),t.isAddedToEngine()?s("Engine: Entity id: "+e):s(`Engine: Entity "${t.uuid}" has not been added to any engine yet.`),s("Engine: Entity's components:");for(let e in t.components)s(e);return!1}addSystem(t,e=0){if(-1!==this.addedSystems.indexOf(t))return s("Engine: Trying to add a system that is already added. Aborting"),t;if(this.systems.length>0)for(let i=0;i<this.systems.length;i++){const n=this.systems[i],s=i===this.systems.length-1;if(n.priority>e){this.addedSystems.push(t),this.systems.splice(i,0,{system:t,priority:e});break}if(s){this.addedSystems.push(t),this.systems.splice(i+1,0,{system:t,priority:e});break}}else this.addedSystems.push(t),this.systems.splice(1,0,{system:t,priority:e});return this.registerSystem(t),t}removeSystem(t){const e=this.addedSystems.indexOf(t);if(-1!==e){t.active=!1,t.deactivate&&t.deactivate(),this.addedSystems.splice(e,1);for(let e=0;e<this.systems.length;e++)this.systems[e].system===t&&this.systems.splice(e,1);return!0}return!1}update(t){for(let e in this.systems){const i=this.systems[e].system;if(i.active&&i.update)try{i.update(t)}catch(t){o(t)}}return this}getEntitiesWithComponent(t){const e="string"==typeof t?t:P(t);return e in this.entityLists?this.entityLists[e]:this.entityLists[e]={}}registerComponent(t){const e=N(t),i=P(t),n=I(t);this._disposableComponents[e]=t,null!==n&&(this.eventManager.fireEvent(new A(e,i,n)),this.eventManager.fireEvent(new E(e,t)))}disposeComponent(t){const e=N(t);return delete this._disposableComponents[e]&&(this.eventManager.fireEvent(new z(e)),t.onDispose&&t.onDispose(),!0)}updateComponent(t){this.eventManager.fireEvent(new E(N(t),t))}getComponentGroup(...t){const e=new O(...t);e.active=!0;const i=e.requiresNames;for(let t=0;t<i.length;t++){const n=i[t];let s=this._componentGroups[n];s||(this._componentGroups[n]=s=[]),-1===s.indexOf(e)&&s.push(e)}for(let t in this._entities)this.checkRequirements(this._entities[t],e);return e}removeComponentGroup(t){if(t.active){t.active=!1;const e=t.requiresNames;for(let i=0;i<e.length;i++){const n=e[i];let s=this._componentGroups[n];if(s){const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}return!0}return!1}registerSystem(t){t.active=!0,t.activate&&t.activate(this),this.simpleSystems.push(t)}checkRequirementsAndAdd(t){if(t.isAddedToEngine()){for(let e in t.components){e in this.entityLists||(this.entityLists[e]={}),this.entityLists[e][t.uuid]=t;const i=this._componentGroups[e];if(i)for(let e in i)this.checkRequirements(t,i[e])}for(let e=0;e<this.simpleSystems.length;e++){const i=this.simpleSystems[e];i.onAddEntity&&i.onAddEntity(t)}}}checkRequirements(t,e){e.meetsRequirements(t)?e.hasEntity(t)||e.addEntity(t):e.hasEntity(t)&&e.removeEntity(t)}componentAddedHandler(t){const{entity:e,componentName:i}=t;if(!e.isAddedToEngine())return;this.entityLists[i]?this.entityLists[i][e.uuid]=e:this.entityLists[i]={[e.uuid]:e};const n=this._componentGroups[i];if(n)for(let t in n)this.checkRequirements(e,n[t])}componentRemovedHandler(t){const{entity:e,componentName:i}=t;if(!e.isAddedToEngine())return;delete this.entityLists[i][e.uuid];const n=this._componentGroups[i];if(n)for(let t in n)this.checkRequirements(e,n[t])}}(Ie);S.engine=Ne,"undefined"!=typeof dcl&&Ne.addSystem(new W(dcl),1/0),Ne.addSystem(jt),Ne.addSystem(Dt)},22:function(t,e,i){"use strict";i.r(e);var n=i(0);const s=new n.m;s.addComponentOrReplace(new n.F);const o=new n.f;o.useDummyModel=!1,o.name="testAvatar9",o.id=o.name,o.baseUrl="https://s3.amazonaws.com/content-service.decentraland.zone/";const r=new n.L("body_shape","BaseMale.glb",[{hash:"QmdyPfi4sRYU3eMFWxeXArnCeQ78sZw7oSGxFrntAPqHhy",file:"Avatar_MaleSkinBase.png"},{hash:"QmRhw6iFmT1r8KTbComWMKFLPxf7pFZqFwKrEY1Az2whZ8",file:"BaseMale.glb"},{hash:"QmP4823KZpn5d5iAEwXJyGTZy19HriJsJYkCJ22ERmpFMa",file:"EyeBrows_00.png"},{hash:"QmUYEYptrfbtvAr53C4X3ReAtYYuQsuN41dB5D5cfuLxkh",file:"Eyes_00.png"},{hash:"QmTZXe8CyZWCfV9KvjKx6LpYwDXAzCeRCozoZRuRUth7qP",file:"Mouth_00.png"},{hash:"QmbEoKs839SoKDSHF9tkgc3S6ge777ywU9X85W8K42WePu",file:"thumbnail.png"}]);o.bodyShape=r;const a=[new n.L("eye_wear","M_Eyewear_AviatorStyle.glb",[{hash:"QmWLrKJFzDCMGXVCef78SDkMHWB94eHP1ZeXfyci3kphTb",file:"AvatarWearables_TX.png"},{hash:"Qmbv617p43YUd9g2Xo8YzmgutGXjGt8AXU89fL3TzZvN3L",file:"M_Eyewear_AviatorStyle.glb"},{hash:"QmTnNj1hRjdPbhQPo7Gg71RPT5FXiw2zLeqwZNYhwnhdhQ",file:"thumbnail.png"}]),new n.L("facial_hair","M_FacialHair_BalbooBeard.glb",[{hash:"QmWLrKJFzDCMGXVCef78SDkMHWB94eHP1ZeXfyci3kphTb",file:"AvatarWearables_TX.png"},{hash:"QmVPP2Y6mqkb7WYw1kLffYq2nGMwx3Y1LmVJJmfafpuZys",file:"M_FacialHair_BalbooBeard.glb"},{hash:"QmTcMounmnAnWrSXY2za4f8ZxeStP3WKEm5LNvunC1xnS6",file:"thumbnail.png"}]),new n.L("feet","M_Feet_GreenFlipFlops.glb",[{hash:"QmRaHnacT5G7oLYTYGsRWZtLXzXuTNEq7gWAcvXRSxfwEU",file:"AvatarWearables_TX.png"},{hash:"QmdyPfi4sRYU3eMFWxeXArnCeQ78sZw7oSGxFrntAPqHhy",file:"Avatar_MaleSkinBase.png"},{hash:"QmVVHB1CqnUSZtQ3sbpoyVss3vnSf4bSzhbiBSaQJVaxNr",file:"M_Feet_GreenFlipFlops.glb"},{hash:"QmeT9F7gV314xtaB2K6vV8gSSj8EQw83gc3RuJZg4GKPM5",file:"thumbnail.png"}]),new n.L("hair","M_Hair_Punk_01.glb",[{hash:"QmRaHnacT5G7oLYTYGsRWZtLXzXuTNEq7gWAcvXRSxfwEU",file:"AvatarWearables_TX.png"},{hash:"QmZQPNWdBc1wtcRtknuRvPJdKkTwPFW2K76VimfF9MeX3s",file:"M_Hair_Punk_01.glb"},{hash:"QmPxPWeVkuX74XS1jDnCPwbZhf23gjQkXKHrqzu9GF24wq",file:"thumbnail.png"}]),new n.L("lower_body","M_lBody_GreyJoggers.glb",[{hash:"QmRaHnacT5G7oLYTYGsRWZtLXzXuTNEq7gWAcvXRSxfwEU",file:"AvatarWearables_TX.png"},{hash:"QmWNqkuhiCL6YHRvbwYniwqYPC6yvm62cHyky8eUaP2aRM",file:"M_lBody_GreyJoggers.glb"},{hash:"QmSWqcYdV5dvWSg6MCp4YaPB8vpTPUQjdNmVghdH86znTF",file:"thumbnail.png"}]),new n.L("upper_body","M_uBody_GreenTShirt.glb",[{hash:"QmRaHnacT5G7oLYTYGsRWZtLXzXuTNEq7gWAcvXRSxfwEU",file:"AvatarWearables_TX.png"},{hash:"QmdyPfi4sRYU3eMFWxeXArnCeQ78sZw7oSGxFrntAPqHhy",file:"Avatar_MaleSkinBase.png"},{hash:"QmfKssVuMmVWiF1Qy7xrNUdukinmfoovsCGNnuEJVczWEs",file:"M_uBody_GreenTShirt.glb"},{hash:"Qmayvq1F3tFDoC5dLdpGR6LmKkhzTANjnungxmhGYVBBKw",file:"thumbnail.png"}])];o.wearables=a;const h=new n.C(new n.k(.6683928370475769,.9275454878807068,.8263601064682007,1));o.skin=h;const d=new n.r(new n.k(.47648438811302185,.22779148817062378,.5416662096977234,1));o.hair=d;const l=new n.n("QmeTxEdW7kp52RV8vZHsrzqed268D5m41T5dVp9JjLXiEr","QmYs9ec68TjZkRpjz2Sov2GcNhP5AD8JUNGm3MrahpF9RB",n.k.Teal());o.eyes=l;const p=new n.o("QmZWwUgq6UYJLCgtPbzVdhThkPTNPHqezWiQKw7Lg3yqKV");o.eyebrows=p;const c=new n.o("QmQZ6MAyHpGaPpntHJnU3x4o2dUvz5KhvNtWbbzvbAE34T");o.mouth=c,s.addComponentOrReplace(o),n.M.addEntity(s);const u=new n.m,y=new n.F;y.position=new n.K(1,2,3),u.addComponentOrReplace(y);const f=n.f.Dummy();f.name="dummy",f.id=f.name,u.addComponentOrReplace(f),n.M.addEntity(u)}})});